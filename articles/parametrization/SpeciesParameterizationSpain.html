<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Species parameterization for Spain • medfate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Species parameterization for Spain">
<meta property="og:description" content="medfate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../articles/index.html">Articles</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/emf-creaf/medfate/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="SpeciesParameterizationSpain_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Species parameterization for Spain</h1>
                        <h4 class="author">Miquel De Cáceres</h4>
            
            <h4 class="date">2021-07-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/master/vignettes/parametrization/SpeciesParameterizationSpain.Rmd"><code>vignettes/parametrization/SpeciesParameterizationSpain.Rmd</code></a></small>
      <div class="hidden name"><code>SpeciesParameterizationSpain.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette describes the procedures used to obtain the species parameter data table <code>SpParamsMED</code> included in package <strong>medfate</strong>. The taxon entities chosen are intended to cover most of the taxa reported in Spanish National Forest Inventory surveys (<em>Inventario Forestal Nacional</em> or IFN).</p>
<div id="required-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#required-packages" class="anchor"></a>Required packages</h3>
<p>Installed version of <strong>medfate</strong> should be <strong>ver 2.3</strong> or higher.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"medfate"</span><span class="op">)</span></code></pre></div>
<p>If the version at CRAN is older, the package should be installed from GitHub. Package <strong>medfateutils</strong> is important for the parametrization process, as it includes several functions useful for parsing data sources and populating parameter tables. Package <strong>medfateutils</strong> is installed only <code>from GitHub via</code>remotes::install_github()`.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"emf-creaf/medfateutils"</span><span class="op">)</span></code></pre></div>
<p>Once we have <strong>medfate</strong> and <strong>medfateutils</strong>, we load them as well as other packages needed for this vignette:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emf-creaf/medfate">medfate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">medfateutils</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="target-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#target-parameters" class="anchor"></a>Target parameters</h3>
<p>The set of species parameters needed to run the models included in <strong>medfate</strong> are described in a dataframe called <code>SpParamsDefinition</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"SpParamsDefinition"</span><span class="op">)</span>
<span class="va">SpParamsDefinition</span><span class="op">$</span><span class="va">ParameterName</span></code></pre></div>
<pre><code>##   [1] "Name"                 "IFNcodes"             "SpIndex"             
##   [4] "Genus"                "Order"                "Family"              
##   [7] "Group"                "GrowthForm"           "LifeForm"            
##  [10] "LeafShape"            "LeafSize"             "PhenologyType"       
##  [13] "Hmed"                 "Hmax"                 "Z50"                 
##  [16] "Z95"                  "fHDmin"               "fHDmax"              
##  [19] "a_ash"                "b_ash"                "a_bsh"               
##  [22] "b_bsh"                "a_btsh"               "b_btsh"              
##  [25] "cr"                   "a_fbt"                "b_fbt"               
##  [28] "c_fbt"                "d_fbt"                "a_cr"                
##  [31] "b_1cr"                "b_2cr"                "b_3cr"               
##  [34] "c_1cr"                "c_2cr"                "a_cw"                
##  [37] "b_cw"                 "LeafDuration"         "Sgdd"                
##  [40] "Tbgdd"                "Ssen"                 "Phsen"               
##  [43] "Tbsen"                "SLA"                  "LeafDensity"         
##  [46] "WoodDensity"          "FineRootDensity"      "conduit2sapwood"     
##  [49] "r635"                 "pDead"                "Al2As"               
##  [52] "LeafWidth"            "SRL"                  "RLD"                 
##  [55] "maxFMC"               "minFMC"               "LeafPI0"             
##  [58] "LeafEPS"              "LeafAF"               "StemPI0"             
##  [61] "StemEPS"              "StemAF"               "SAV"                 
##  [64] "HeatContent"          "LigninPercent"        "ParticleDensity"     
##  [67] "gammaSWR"             "alphaSWR"             "kPAR"                
##  [70] "g"                    "Tmax_LAI"             "Tmax_LAIsq"          
##  [73] "Psi_Extract"          "Psi_Critic"           "WUE"                 
##  [76] "pRootDisc"            "Gswmin"               "Gswmax"              
##  [79] "VCleaf_kmax"          "VCleaf_c"             "VCleaf_d"            
##  [82] "Kmax_stemxylem"       "VCstem_c"             "VCstem_d"            
##  [85] "Kmax_rootxylem"       "VCroot_c"             "VCroot_d"            
##  [88] "Narea"                "Vmax298"              "Jmax298"             
##  [91] "WoodC"                "RERleaf"              "RERsapwood"          
##  [94] "RERfineroot"          "RGRleafmax"           "RGRsapwoodmax"       
##  [97] "RGRfinerootmax"       "SeedProductionHeight" "RecrTreeDBH"         
## [100] "RecrTreeHeight"       "RecrShrubHeight"      "RecrTreeDensity"     
## [103] "RecrShrubCover"       "RecrZ50"              "RecrZ95"             
## [106] "MinTempRecr"          "MinMoistureRecr"      "MinFPARRecr"</code></pre>
<p>It is obvious that such a sheer number of parameters cannot be searched for manually. Hence, it is important to draw them for data bases. Not all model parameters have their counterpart in publicly-available databases, so even using trait data bases it is unlikely that one finds appropriate parameter values for all species. Luckily, <strong>medfate</strong> has inbuilt imputation procedures to estimate missing values for many parameters before starting model simulations. However, imputed parameter estimates will often be worse than estimates coming from data bases. Hence, we should put a strong effort in finding source parameter data before relying on inbuilt imputation.</p>
</div>
<div id="source-data-paths" class="section level3">
<h3 class="hasAnchor">
<a href="#source-data-paths" class="anchor"></a>Source data paths</h3>
<p>We begin by defining file paths (in my computer) to access source data for parameter filling. Source data includes forest inventory (i.e. IFN) data as well as trait and allometry data bases:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/Datasets/IFN/"</span>
<span class="va">DB_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/Professional/Recerca/MedfateSpeciesParametrization/"</span></code></pre></div>
</div>
<div id="steps-to-build-a-species-parameter-table" class="section level3">
<h3 class="hasAnchor">
<a href="#steps-to-build-a-species-parameter-table" class="anchor"></a>Steps to build a species parameter table</h3>
<p>The following sections describe different phases required to build a species parameter table for simulations with <strong>medfate</strong>:</p>
<ol style="list-style-type: decimal">
<li>Initialize the parameter table with target taxonomic entities.</li>
<li>Draw species parameters from forest inventory (IFN in our case) data.</li>
<li>Populate tree and shrub allometric coefficients from suitable allometric databases.</li>
<li>Populate plant functional traits from available data bases</li>
<li>Populate recruitment limits using bioclimatic data, forest inventory data and previous parameter estimates.</li>
</ol>
</div>
</div>
<div id="initialize-species-parameter-table-for-ifn" class="section level2">
<h2 class="hasAnchor">
<a href="#initialize-species-parameter-table-for-ifn" class="anchor"></a>Initialize species parameter table for IFN</h2>
<p>The first step to obtain a species parameter table is to define the target entities that will be considered functionally distinct in <strong>medfate</strong> simulations. There is no <em>a priori</em> need to limit such entities to species taxonomy, nor to particular taxonomic ranks. However, in our case we will define either entities either at species or genus level.</p>
<div id="load-ifn-taxonomic-codification" class="section level3">
<h3 class="hasAnchor">
<a href="#load-ifn-taxonomic-codification" class="anchor"></a>Load IFN taxonomic codification</h3>
<p>Model simulations will normally entail a resolution of target entities than forest inventory data. Therefore, it will be usual to lump entities treated as separated in the forest inventory. In our case, we begin by loading shrub and tree species codes used in the second, third, and fourth editions of IFN, i.e. IFN2, IFN3 and IFN4:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN23_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/SpeciesCodesIFN23.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN23_species_data</span><span class="op">&lt;-</span><span class="va">IFN23_species_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>

<span class="va">IFN4_shrub_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/shrubcodesifn4.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/treecodesifn4.txt"</span><span class="op">)</span>, 
                                    sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span><span class="op">&lt;-</span><span class="va">IFN4_tree_species_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Merge the two code data sets by adding to the codes of IFN2-3 those species codes that were new in IFN4:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newShrubs</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="op">(</span><span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">newTrees</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="op">(</span><span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">IFN23_species_data</span>, 
                              <span class="va">IFN4_shrub_species_data</span><span class="op">[</span><span class="va">newShrubs</span>, <span class="op">]</span>, 
                              <span class="va">IFN4_tree_species_data</span><span class="op">[</span><span class="va">newTrees</span>,<span class="op">]</span><span class="op">)</span>
<span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="va">IFN_species_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<p>The final table of species names and codes is:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 411   2</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>##   IFNCODE               IFNNAME
## 1       1 Heberdenia bahamensis
## 2       2    Amelanchier ovalis
## 3       3        Frangula alnus
## 4       4     Rhamnus alaternus
## 5       5    Euonymus europaeus
## 6       6       Myrtus communis</code></pre>
</div>
<div id="define-ifn-codes-to-exclude" class="section level3">
<h3 class="hasAnchor">
<a href="#define-ifn-codes-to-exclude" class="anchor"></a>Define IFN codes to exclude</h3>
<p>We used the word ‘species’ for IFN entities, but in fact not all IFN entities are binomial species. In some cases, subspecies are recorded, while in others identification is at genus level or even uses non-scientific names. We thus need to manually define a set of entities (IFN codes) to be excluded because they have low taxonomic content or refer to unsuitable growth forms (vines):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">codesOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"19"</span>, <span class="co"># Otras coniferas </span>
              <span class="st">"10"</span>, <span class="co"># Sin asignar</span>
              <span class="st">"20"</span>, <span class="co"># Pinos</span>
              <span class="st">"29"</span>, <span class="co"># Otros pinos</span>
              <span class="st">"30"</span>,  <span class="co">#Mezcla de coniferas</span>
              <span class="st">"40"</span>, <span class="co">#Quercus</span>
              <span class="st">"49"</span>, <span class="co">#Otros quercus</span>
              <span class="st">"50"</span>, <span class="co">#Mezcla de &lt;e1&gt;rboles de ribera</span>
              <span class="st">"59"</span>, <span class="co">#Otros &lt;e1&gt;rboles rip&lt;ed&gt;colas</span>
              <span class="st">"70"</span>, <span class="co">#Mezcla de frondosas de gran porte</span>
              <span class="st">"80"</span>, <span class="co">#Laurisilva</span>
              <span class="st">"89"</span>, <span class="co">#Otras laurisilvas</span>
              <span class="st">"90"</span>, <span class="co">#Mezcla de peque&lt;f1&gt;as frondosas</span>
              <span class="st">"99"</span>, <span class="co">#Otras frondosas</span>
              <span class="st">"1500"</span>, <span class="co"># Cultivo en mosaico</span>
              <span class="st">"8000"</span>, <span class="co"># Matorral en mosaico</span>
              <span class="st">"9000"</span>, <span class="co">#Herbazal en mosaico</span>
              <span class="st">"3400"</span>, <span class="co">#Prado en mosaico</span>
              <span class="st">"3500"</span>, <span class="co">#Pastizal-Matorral en mosaico</span>
              <span class="st">"103"</span>, <span class="co">#Otras papilionoideas altas</span>
              <span class="st">"104"</span>, <span class="co">#Otras papilionoideas bajas</span>
              <span class="st">"3104"</span>, <span class="co">#Genista (H.t.&lt;1,5 m)</span>
              <span class="st">"141"</span>, <span class="co">#Hedera helix</span>
              <span class="st">"149"</span> <span class="co">#Smilax aspera</span>
              <span class="op">)</span></code></pre></div>
<p>Remove taxa from the IFN taxonomic definition data frame:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="va">IFN_species_data</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">codesOut</span><span class="op">)</span>, <span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 387   2</code></pre>
</div>
<div id="define-taxonomic-entities-to-merge-into-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#define-taxonomic-entities-to-merge-into-groups" class="anchor"></a>Define taxonomic entities to merge into groups</h3>
<p>Initialization will normally require defining groups of entities to be treated together in <strong>medfate</strong>. In our case, we need to define genus-level groups. These are necessary for taxa where the forest inventory records do not always have identifications at species-level resolution:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genus_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Acacia spp.:7/207/307"</span>,
                 <span class="st">"Adenocarpus spp.:2103/3163"</span>,
                 <span class="st">"Atriplex spp.:133"</span>,
                 <span class="st">"Artemisia spp.:126/159/1159"</span>,
                 <span class="st">"Asparagus spp.:138/1138/2138"</span>,
                 <span class="st">"Astragalus spp.:6104"</span>,
                 <span class="st">"Betula spp.:73/273/373"</span>,
                 <span class="st">"Bupleurum spp.:124/1124/2124"</span>,
                 <span class="st">"Calicotome spp.:2104/2105/9072"</span>,
                 <span class="st">"Chamaerops humilis:369/3690"</span>,
                 <span class="st">"Clematis spp.:132/1132/2132"</span>,
                 <span class="st">"Crataegus spp.:15/215/315/415/515"</span>,
                 <span class="st">"Coronilla spp.:152/1152/3152/5104"</span>,
                 <span class="st">"Cotoneaster spp.:118"</span>,
                 <span class="st">"Daphne spp.:110/1110/2110/3110"</span>,
                 <span class="st">"Dorycnium spp.:154/7104/1154"</span>,
                 <span class="st">"Echium sp.:161"</span>,
                 <span class="st">"Erinacea spp.:1104/1166"</span>,
                 <span class="st">"Eucalyptus spp.:60/61/62/63/64/264/364/464"</span>,
                 <span class="st">"Euphorbia spp.:162/1162/2162/3162"</span>,
                 <span class="st">"Fraxinus spp.:55/255/355/455"</span>,
                 <span class="st">"Genistella spp.:9104"</span>,
                 <span class="st">"Helianthemum spp.:142"</span>,
                 <span class="st">"Helichrysum spp.:128/2128"</span>,
                 <span class="st">"Larix spp.:35/235/335/435"</span>,
                 <span class="st">"Lavandula spp.:109/1109/2109/3109/4109"</span>,
                 <span class="st">"Lonicera spp.:144/1144/2144/3144/4144/5144/9012"</span>,
                 <span class="st">"Halimium spp.:117/1117/4117/5117/6117"</span>,
                 <span class="st">"Ilex spp.:65/82/282"</span>,
                 <span class="st">"Juglans spp.:75/275"</span>,
                 <span class="st">"Morus spp.:399/499/599"</span>,
                 <span class="st">"Ononis spp.:156/8104"</span>,
                 <span class="st">"Osyris spp.:135/1135/2135"</span>,
                 <span class="st">"Platanus spp.:79/279"</span>,
                 <span class="st">"Populus spp.:51/52/58/258"</span>,
                 <span class="st">"Phlomis spp.:171/1171/2171"</span>,
                 <span class="st">"Phoenix spp.:69/269/469"</span>,
                 <span class="st">"Prunus spp.:95/295/395/495/595/1095/1195/2950/148"</span>,
                 <span class="st">"Pyrus spp.:16/1165/2165"</span>,
                 <span class="st">"Retama spp.:4103"</span>,
                 <span class="st">"Rhamnus spp.:4/122/1122/2122/3122/4122/389/5122/6122"</span>,
                 <span class="st">"Rhododendron spp.:108"</span>,
                 <span class="st">"Ribes spp.:131/1131/2131"</span>,
                 <span class="st">"Rosa spp.:119"</span>,
                 <span class="st">"Rubus spp.:121/1121/2121/3121"</span>,
                 <span class="st">"Salix spp.:57/257/357/457/557/657/757/857/858/957"</span>,
                 <span class="st">"Sambucus spp.:97/197/297/2970"</span>,
                 <span class="st">"Santolina spp.:127/1127/2127"</span>,
                 <span class="st">"Sorbus spp.:78/278/378/478/578/678/778"</span>,
                 <span class="st">"Spartium spp.:3103/9103"</span>,
                 <span class="st">"Spiraea spp.:134/1134"</span>,
                 <span class="st">"Tamarix spp.:53/253"</span>,
                 <span class="st">"Teline spp.:165/9077/9078/9202"</span>,
                 <span class="st">"Teucrium spp.:179/1179"</span>,
                 <span class="st">"Tilia spp.:77/277/377"</span>,
                 <span class="st">"Thymelaea spp.:151"</span>,
                 <span class="st">"Thuja spp.:319"</span>,
                 <span class="st">"Thymus spp.:129/1129"</span>,
                 <span class="st">"Ulex spp.:157/1103/6103/3164"</span>,
                 <span class="st">"Ulmus spp.:56/256/356/456"</span>,
                 <span class="st">"Vaccinium spp.:137/1137"</span>,
                 <span class="st">"Viburnum spp.:115/1115/4115/3115/2115"</span>
                 <span class="op">)</span></code></pre></div>
<p>Groups were manually defined as strings where ‘:’ was used to separate the group name from the set of codes forming the group, which were separated using ‘/’. We also define groups of taxa at species level, where different synonyms are merged, different codes have been used for the same species or the species have subspecies entities which we want to merge:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assimilated_species</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Acer campestre:76/776"</span>,
                       <span class="st">"Amelanchier ovalis:2/200"</span>,
                       <span class="st">"Buxus sempervirens:91/291/2910/9071/9100"</span>,
                       <span class="st">"Cistus albidus:101/3101"</span>,
                       <span class="st">"Cornus sanguinea:9/900"</span>,
                       <span class="st">"Cytisus fontanesii:9074"</span>,
                       <span class="st">"Cytisus scoparius:4104/1167/5103/8103"</span>,
                       <span class="st">"Cytisus commutatus:9011/9201/9481"</span>,
                       <span class="st">"Cytisus oromediterraneus:5155/4167"</span>,
                       <span class="st">"Erica scoparia:283/6102"</span>,
                       <span class="st">"Erica arborea:83/102/1102"</span>,
                       <span class="st">"Euonymus europaeus:5/500"</span>,
                       <span class="st">"Frangula alnus:3/300"</span>,
                       <span class="st">"Genista horrida:177"</span>, <span class="co"># Echinospartum horridum -&gt; Genista horrida</span>
                       <span class="st">"Genista cinerea:8155/1355"</span>,
                       <span class="st">"Genista scorpius:155/3155"</span>,
                       <span class="st">"Juniperus communis:37/3700"</span>,
                       <span class="st">"Juniperus phoenicea:39/238/239/1139"</span>,
                       <span class="st">"Medicago arborea:145/9076"</span>,
                       <span class="st">"Myrtus communis:6/600"</span>,
                       <span class="st">"Myrica faya:81/281"</span>,
                       <span class="st">"Pistacia terebinthus:93/9300"</span>,
                       <span class="st">"Quercus ilex:45/245"</span>,
                       <span class="st">"Quercus faginea:44/344"</span>,
                       <span class="st">"Quercus suber:46/646/746/846/946"</span>,
                       <span class="st">"Salvia rosmarinus:114"</span><span class="op">)</span> <span class="co"># Rosmarinus officinalis -&gt; Salvia rosmarinus</span></code></pre></div>
<p>We now build a data frame with group names and codes, by merging the information of these two groups. We now separate group names and the set of codes defining the group:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">groups_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">genus_level</span>,
                                     <span class="va">assimilated_species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">separate</span><span class="op">(</span><span class="st">"Groups"</span>, into<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group_names"</span>, <span class="st">"group_codes"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">":"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">groups_df</span><span class="op">)</span></code></pre></div>
<pre><code>##        group_names   group_codes
## 1      Acacia spp.     7/207/307
## 2 Adenocarpus spp.     2103/3163
## 3    Atriplex spp.           133
## 4   Artemisia spp.  126/159/1159
## 5   Asparagus spp. 138/1138/2138
## 6  Astragalus spp.          6104</code></pre>
</div>
<div id="initialize-species-parameter-table" class="section level3">
<h3 class="hasAnchor">
<a href="#initialize-species-parameter-table" class="anchor"></a>Initialize species parameter table</h3>
<p>Once we have IFN species names and codes, as well the definition of IFN entities to merge, we can call function <code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams()</a></code> from package <strong>medfateutils</strong>. This function also takes the data frame <code>SpParamsDefinition</code> as argument, from which it takes the set of parameter names to be filled:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span>, <span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNNAME</span>,
                        <span class="va">SpParamsDefinition</span>,
                        <span class="va">groups_df</span><span class="op">$</span><span class="va">group_codes</span>, <span class="va">groups_df</span><span class="op">$</span><span class="va">group_names</span>,
                        fill_taxonomic <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Option <code>fill_taxonomic</code> tells function <code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams()</a></code> to use package <strong>taxize</strong> to find taxonomic classification of the species/genus entities.</p>
<p>The result of calling <code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams()</a></code> is a data frame with as many rows as target entities and columns corresponding to the parameters defined in <code>SpParamsDefinition</code>. Most parameters are missing, obviously, but the function already filled taxonomic data:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##                  Name  IFNcodes SpIndex  Genus      Order      Family
## 1          Abies alba        31       0  Abies    Pinales    Pinaceae
## 2       Abies pinsapo        32       1  Abies    Pinales    Pinaceae
## 3         Acacia spp. 7/207/307       2 Acacia    Fabales    Fabaceae
## 4      Acer campestre    76/776       3   Acer Sapindales Sapindaceae
## 5 Acer monspessulanum       276       4   Acer Sapindales Sapindaceae
## 6        Acer negundo       376       5   Acer Sapindales Sapindaceae
##        Group
## 1 Gymnosperm
## 2 Gymnosperm
## 3 Angiosperm
## 4 Angiosperm
## 5 Angiosperm
## 6 Angiosperm</code></pre>
</div>
</div>
<div id="parameters-drawn-from-ifn-data" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-drawn-from-ifn-data" class="anchor"></a>Parameters drawn from IFN data</h2>
<p>Some plant size parameters, such as maximum height or minimum/maximum values of the height-to-diameter ratio, can be derived from forest inventory data. In addition, it is important that medfate’s growth form (either tree or shrub) matches the treatment given in forest inventory surveys. Diameters are normally measured in ‘tree’ entities, whereas shrubs are often measured using cover indices. Thus, the growth form parameter should also be derived from forest inventory.</p>
<div id="load-ifn-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-ifn-data" class="anchor"></a>Load IFN data</h3>
<p>We first load IFN tree and shrub data corresponding to the three surveys (tree data is in two different tables in the case of IFN2):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrubDataIFN2</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/shrubDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">shrubDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">shrubDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>
<span class="va">shrubDataIFN3</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/shrubDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">shrubDataIFN4</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN4/Rdata/shrubDataIFN4_Spain.rds"</span><span class="op">)</span><span class="op">)</span>

<span class="va">piesMayoresDataIFN2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/piesMayoresDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/piesMenoresDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">ID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">Species</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">treeDataIFN3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/treeDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">treeDataIFN4</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN4/Rdata/treeDataIFN4_Spain.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We merge the data sets into two tables, one for shrubs and the other for trees, taking only columns <code>ID</code> (plot identification), <code>Species</code> (code), <code>H</code> (height) and <code>DBH</code> (for trees).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrubDataIFN</span> <span class="op">&lt;-</span><span class="fu">bind_rows</span><span class="op">(</span><span class="va">shrubDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span>,
                         <span class="va">shrubDataIFN3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span>,
                         <span class="va">shrubDataIFN4</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="va">treeDataIFN</span> <span class="op">&lt;-</span><span class="fu">bind_rows</span><span class="op">(</span><span class="va">piesMayoresDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">piesMenoresDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">treeDataIFN3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">treeDataIFN4</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
<div id="growth-form" class="section level3">
<h3 class="hasAnchor">
<a href="#growth-form" class="anchor"></a>Growth form</h3>
<p>To tell medfate which target entities are shrubs, trees (or both, since some species occur in both tree and shrub tables), we can simply take the species code vectors:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">tree_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></code></pre></div>
<p>Before populating growth form, we can check how many species appear both as trees and shrubs:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">shrub_codes</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">tree_codes</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>We can populate column <code>GrowthForm</code> of the species parameter table by calling function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateGrowthForm()</a></code> of package <strong>medfateutils</strong>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateGrowthForm</a></span><span class="op">(</span><span class="va">SpParams</span>, 
                              <span class="va">tree_codes</span>, <span class="va">shrub_codes</span>,
                              fill_fromGenus <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##  Tree: 75 shrub: 107 tree/shrub: 27 not found: 10</code></pre>
<pre><code>##  Tree input codes not in SpParams: 99,90,29,59,89,19,49</code></pre>
<pre><code>##  Shrub input codes not in SpParams: 103,104,224,222,192,100,99,10,199,229,402,302,141,149,1163,186,185,3104,0,1108,1105,3124,2163,2152,1172,1128,6161,3106,1013,1100,502,1148,1177,2129,172,1175,3117,1015,1188,1315,1010,1173,9101,3105,2149,405,1536,170,9262,9264,4156,174,9284,9282,2164,400,180,8010,8005,8007,1709,1706,1704,1707,9914,1710,1708,2509,2507,2502,2506,2505,9006</code></pre>
<pre><code>## Species 'Cistus creticus' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Cytisus commutatus' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Cytisus fontanesii' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista anglica' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista dorycnifolia' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista hystrix' assigned growth form 'Shrub'</code></pre>
<p>Some codes (particularly, those excluded above) may not be recognized according to the target entity definition of <code>SpParams</code> and are ignored. The option <code>fill_fromGenus = TRUE</code> is used to tell function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateGrowthForm()</a></code> that all species of the same entity should have the same growth form, so that even if some codes are not mentioned, for whatever reason, growth forms are also defined. Some species may have been defined in the IFN species definition but then be missing from the tree/shrub tables. We identify them and manually set to tree the growth form of these:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">missingGrowthFormSpecies</span> <span class="op">=</span> <span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">missingGrowthFormSpecies</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Dracaena drago"         "Pleiomeris canariensis" "Quercus lusitanica"    
## [4] "Sideroxylon marmulano"</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="va">missingGrowthFormSpecies</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Tree"</span></code></pre></div>
</div>
<div id="maximummedian-height" class="section level3">
<h3 class="hasAnchor">
<a href="#maximummedian-height" class="anchor"></a>Maximum/median height</h3>
<p>Maximum and median heights for each target entity can be obtained from observed height distributions. Thus, we define species identity and height (in cm) vectors from tree/shrub data:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">species_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span>, <span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">height_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">H</span>, <span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">H</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span> <span class="co"># m to cm</span></code></pre></div>
<p>and then call function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateHeightParams()</a></code> to populate parameters <code>Hmax</code> and <code>Hmed</code>, corresponding to maximum and median heights.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateHeightParams</a></span><span class="op">(</span><span class="va">SpParams</span>,
                                 <span class="va">species_codes</span>, <span class="va">height_values</span><span class="op">)</span></code></pre></div>
<pre><code>## 162390 species/height missing values removed from input.</code></pre>
<pre><code>## 17511 zero height values removed from input.</code></pre>
<pre><code>## 10 missing Hmed/Hmax values (out of 219) after populating with input data.</code></pre>
<p>By default, maximum height is defined as the 99% quantile of the height distribution, whereas median height corresponds to the 50% quantile.</p>
<p>Parameters <code>Hmax</code> and <code>Hmed</code> are strict, meaning that medfate does not have inbuilt imputation procedures for them, so we must complete their columns in the parameter table. We can inspect the missing values for each growth form:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   107   75         27
##   TRUE      6    4          0</code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   107   75         27
##   TRUE      6    4          0</code></pre>
<p>and then use the species with known values for each growth from to impute species averages:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="diameterheight-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#diameterheight-ratio" class="anchor"></a>Diameter/height ratio</h3>
<p>Minimum and maximum diameter/height ratios are used in medfate to translate diameter growth into height growth. We first assemble three data vectors needed to populate these parameters (heights and diameters in cm):</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tree_species_codes</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span>
<span class="va">tree_height_values</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">H</span><span class="op">*</span><span class="fl">100</span> <span class="co"># m to cm</span>
<span class="va">tree_diameter_values</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">DBH</span></code></pre></div>
<p>and then call function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateTreeDiameterHeightParams()</a></code> from package <strong>medfateutils</strong>:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateTreeDiameterHeightParams</a></span><span class="op">(</span><span class="va">SpParams</span>,
                                             <span class="va">tree_species_codes</span>, 
                                             <span class="va">tree_height_values</span>,
                                             <span class="va">tree_diameter_values</span><span class="op">)</span></code></pre></div>
<pre><code>## 162374 species/height/diameter missing values removed from input.</code></pre>
<pre><code>## 17481 zero height/diameter values removed from input.</code></pre>
<pre><code>## 4 missing fHDmin/fHDmax values (out of 106 tree species) after populating with input data.</code></pre>
<p>This function fills parameters <code>fHDmin</code> and <code>fHDmax</code>, corresponding to the minimum and maximum values of the height-to-diameter ratio. The 5% and 95% quantile values are used for these parameters, respectively, by default.</p>
<p>Missing values may occur after imputation:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE     0   75         27
##   TRUE    113    4          0</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE     0   75         27
##   TRUE    113    4          0</code></pre>
<p>Since <code>fHDmin</code> and <code>fHDmax</code> are strict parameters, we use shrub and tree averages to fill the remaining cases:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="allometric-coefficients" class="section level2">
<h2 class="hasAnchor">
<a href="#allometric-coefficients" class="anchor"></a>Allometric coefficients</h2>
<div id="shrub-allometric-equations" class="section level3">
<h3 class="hasAnchor">
<a href="#shrub-allometric-equations" class="anchor"></a>Shrub allometric equations</h3>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">medfuels</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_area"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_fine"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_total"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_area"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_fine"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_total"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"species_groups"</span><span class="op">)</span></code></pre></div>
<p>Correct synonymy mistakes</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"Genus"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Salvia"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"Species"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"rosmarinus"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"author"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Schleid."</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"name"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Salvia rosmarinus"</span>

<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"Genus"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Lithodora"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"Species"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"fruticosa"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"author"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"(L.) Griseb."</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"name"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Lithodora fruticosa"</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_sel</span> <span class="op">&lt;-</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">retrieveCoefficientsFromMedfuels</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">sp_params_allom</span>, <span class="va">group_params_allom</span>, <span class="va">species_groups</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">a_coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">b_coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">sp_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">)</span>
  <span class="va">gr_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">)</span>
  <span class="va">gen_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span>, <span class="va">species_groups</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
  <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">growth_form</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="va">nshrub</span> <span class="op">+</span><span class="fl">1</span>
      <span class="va">nm</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
      <span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">nm</span>,<span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
      <span class="kw">if</span><span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">sp_allom</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species-specific allometry available</span>
        <span class="va">sp_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sp_allom</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">gen_sp</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species is found in medfuels species table</span>
        <span class="va">form_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gen_sp</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
        <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="va">form_raunkiaer</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">gen</span> <span class="op">%in%</span> <span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If genus occurs in medfuels table</span>
        <span class="va">forms_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">==</span><span class="va">gen</span><span class="op">)</span><span class="op">]</span>
        <span class="co"># Find most-frequent  raunkiaer form</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">forms_raunkiaer</span><span class="op">)</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="va">tfr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">tfr</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>
        <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
        <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="va">nmis</span> <span class="op">+</span> <span class="fl">1</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span><span class="op">==</span><span class="st">"Tree/Shrub"</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If tree/shrub assing MPh data</span>
          <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved and will be assigned 'MP'."</span><span class="op">)</span><span class="op">)</span>
          <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"a"</span><span class="op">]</span>
          <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"b"</span><span class="op">]</span>
        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
          <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved and will be assigned 'NP'."</span><span class="op">)</span><span class="op">)</span>
          <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"NP"</span>,<span class="st">"a"</span><span class="op">]</span>
          <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"NP"</span>,<span class="st">"b"</span><span class="op">]</span>
        <span class="op">}</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">nmis</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">nmis</span>,
                            <span class="st">" missing values (out of "</span>,
                            <span class="va">nshrub</span>,
                            <span class="st">" shrub species) after populating with input data.\n"</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span>, 
                    GrothForm <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span>,
                    a <span class="op">=</span> <span class="va">a_coef</span>, b <span class="op">=</span> <span class="va">b_coef</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">area_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_area</span>, 
                                                 <span class="va">group_params_area</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_ash</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">area_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_ash</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">area_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>

<span class="va">fine_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_fine</span>, 
                                                 <span class="va">group_params_fine</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_bsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fine_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_bsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fine_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>

<span class="va">total_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_total</span>, 
                                                 <span class="va">group_params_total</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_btsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">total_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_btsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">total_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span></code></pre></div>
</div>
<div id="shrub-crown-ratio-and-pdead" class="section level3">
<h3 class="hasAnchor">
<a href="#shrub-crown-ratio-and-pdead" class="anchor"></a>Shrub crown ratio and Pdead</h3>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_pdead_cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/ShrubAllometries/Shrub_Pdead_CR.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span>, dec<span class="op">=</span><span class="st">","</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span><span class="va">Name</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Species"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">unite</span><span class="op">(</span><span class="st">"Name"</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Species"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 26 rows [1, 2, 3, 4,
## 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].</code></pre>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 7 rows [28, 29,
## 30, 31, 32, 33, 34].</code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_cr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">CR.mean</span>,
                     row.names <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span>
<span class="va">shrub_pdead</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Pdead.mean</span>,
                     row.names <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span>

<span class="va">sp_params_allom</span> <span class="op">=</span> <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
<span class="va">group_params_allom</span> <span class="op">=</span> <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">retrieveValuesFromMedfuels</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">sp_params_allom</span>, 
                                       <span class="va">group_params_allom</span>, <span class="va">species_groups</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">sp_params_allom</span> <span class="op">&lt;-</span><span class="va">sp_params_allom</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
  <span class="va">group_params_allom</span> <span class="op">&lt;-</span><span class="va">group_params_allom</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
  <span class="va">coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">sp_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">)</span>
  <span class="va">gr_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">)</span>
  <span class="va">gen_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span>, <span class="va">species_groups</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
  <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">growth_form</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="va">nshrub</span> <span class="op">+</span><span class="fl">1</span>
      <span class="va">nm</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
      <span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">nm</span>,<span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
      <span class="kw">if</span><span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">sp_allom</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species-specific allometry available</span>
        <span class="va">sp_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sp_allom</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span> 
        <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">gen_sp</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species is found in medfuels species table</span>
        <span class="va">form_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gen_sp</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">form_raunkiaer</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="va">form_raunkiaer</span><span class="op">)</span> 
          <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="op">}</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">gen</span> <span class="op">%in%</span> <span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If genus occurs in medfuels table</span>
        <span class="va">forms_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">==</span><span class="va">gen</span><span class="op">)</span><span class="op">]</span>
        <span class="co"># Find most-frequent  raunkiaer form</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">forms_raunkiaer</span><span class="op">)</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="va">tfr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">tfr</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>
        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
          <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="op">}</span> 
      <span class="op">}</span> 
      
      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>  <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="va">growth_form</span><span class="op">==</span><span class="st">"Tree/Shrub"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="st">"MP"</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span> <span class="co"># If tree/shrub assing MPh data</span>
        <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"value"</span><span class="op">]</span>
      <span class="op">}</span> 
      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved."</span><span class="op">)</span><span class="op">)</span>
        <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="va">nmis</span> <span class="op">+</span> <span class="fl">1</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">nmis</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">nmis</span>,
                            <span class="st">" missing values (out of "</span>,
                            <span class="va">nshrub</span>,
                            <span class="st">" shrub species) after populating with input data.\n"</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span>, 
                    GrothForm <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span>,
                    coef <span class="op">=</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">cr_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveValuesFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Artemisia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Asparagus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Astragalus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Berberis vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Betula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Bupleurum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Calluna vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaecytisus proliferus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaespartium tridentatum' could not be retrieved.</code></pre>
<pre><code>## Data for 'Cistus crispus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Dorycnium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica australis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica ciliaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica tetralix' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica vagans' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erinacea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Eucalyptus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euphorbia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista hispanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista horrida' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista triflora' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Halimium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helianthemum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helichrysum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Hypericum canariensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ilex spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus oxycedrus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus phoenicea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved.</code></pre>
<pre><code>## Data for 'Laurus nobilis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lavandula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lithodora spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Myrtus communis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Nerium oleander' could not be retrieved.</code></pre>
<pre><code>## Data for 'Olea europaea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ononis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Paliurus spina-christi' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phlomis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia terebinthus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Prunus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pyrus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus ilex' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus robur' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rhamnus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rumex lunaria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ruscus aculeatus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Salix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Sambucus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Santolina spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Spartium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Teucrium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymelaea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vaccinium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vella spinosa' could not be retrieved.</code></pre>
<pre><code>## Data for 'Viburnum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved.</code></pre>
<pre><code>## 70 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdead_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveValuesFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">shrub_pdead</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">shrub_pdead</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Artemisia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Asparagus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Astragalus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Berberis vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Betula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Bupleurum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Calluna vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaecytisus proliferus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaespartium tridentatum' could not be retrieved.</code></pre>
<pre><code>## Data for 'Cistus crispus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Dorycnium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica australis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica ciliaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica tetralix' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica vagans' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erinacea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Eucalyptus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euphorbia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista hispanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista horrida' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista triflora' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Halimium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helianthemum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helichrysum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Hypericum canariensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ilex spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus oxycedrus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus phoenicea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved.</code></pre>
<pre><code>## Data for 'Laurus nobilis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lavandula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lithodora spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Myrtus communis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Nerium oleander' could not be retrieved.</code></pre>
<pre><code>## Data for 'Olea europaea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ononis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Paliurus spina-christi' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phlomis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia lentiscus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia terebinthus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Prunus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pyrus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus ilex' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus robur' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rhamnus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rumex lunaria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ruscus aculeatus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Salix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Sambucus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Santolina spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Spartium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Teucrium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymelaea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vaccinium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vella spinosa' could not be retrieved.</code></pre>
<pre><code>## Data for 'Viburnum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved.</code></pre>
<pre><code>## 71 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">SpParams</span><span class="op">$</span><span class="va">cr</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">pDead</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span></code></pre></div>
</div>
<div id="tree-allometries" class="section level3">
<h3 class="hasAnchor">
<a href="#tree-allometries" class="anchor"></a>Tree allometries</h3>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fb_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_FB_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cr_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_CR_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cw_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_CW_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fb_models</span>, <span class="st">"foliarbiomass"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 24 genus: 17 family: 0 order:0 group: 0</code></pre>
<pre><code>## 65 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">cr_models</span>, <span class="st">"crownratio"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 4 genus: 11 family: 0 order:0 group: 0</code></pre>
<pre><code>## 91 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">cw_models</span>, <span class="st">"crownwidth"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 11 genus: 18 family: 0 order:0 group: 0</code></pre>
<pre><code>## 77 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
</div>
</div>
<div id="plant-functional-traits" class="section level2">
<h2 class="hasAnchor">
<a href="#plant-functional-traits" class="anchor"></a>Plant functional traits</h2>
<div id="trait-databases-except-try" class="section level3">
<h3 class="hasAnchor">
<a href="#trait-databases-except-try" class="anchor"></a>Trait databases (except TRY)</h3>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  Hydratry</span>
<span class="va">fn_hydratry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/HydraTRY/HydraTRY.xlsx"</span><span class="op">)</span>
<span class="va">hydratry</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_hydratry</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> 

<span class="co">#  Martin-StPaul et al. (2017)</span>
<span class="va">fn_martin_stpaul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/MartinStPaul_et_al_2017/DataBase.xlsx"</span><span class="op">)</span>
<span class="va">martin_stpaul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_martin_stpaul</span>, sheet<span class="op">=</span><span class="st">"ALL"</span><span class="op">)</span>
<span class="va">martin_stpaul</span><span class="op">&lt;-</span><span class="va">martin_stpaul</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span>, <span class="st">"P12"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Choat et al. (2012)</span>
<span class="va">fn_choat</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/Choat_et_al_2012/nature11688-s2.xls"</span><span class="op">)</span>
<span class="va">choat</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_choat</span><span class="op">)</span>
<span class="va">choat</span> <span class="op">&lt;-</span><span class="va">choat</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span>, <span class="st">"P88"</span><span class="op">)</span><span class="op">]</span> <span class="co"># Remove unit row</span>

<span class="co"># Bartlett et al. 2012</span>
<span class="va">fn_bartlett</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Bartlett_et_al_2012/Bartlett_2012_ELE_data.xlsx"</span><span class="op">)</span>
<span class="va">bartlett</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_bartlett</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> 

<span class="co"># Duursma et al. 2018</span>
<span class="va">fn_duursma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Duursma_et_al_2018/gmindatabase.csv"</span><span class="op">)</span>
<span class="va">duursma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="va">fn_duursma</span>, sep<span class="op">=</span><span class="st">","</span><span class="op">)</span>

<span class="co"># Hoshika et al. 2018 </span>
<span class="va">fn_hoshika</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Hoshika_et_al_2018/Hoshika_et_al_2018.xlsx"</span><span class="op">)</span>
<span class="va">hoshika</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_hoshika</span><span class="op">)</span> 
<span class="va">hoshika</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu">str_replace</span><span class="op">(</span>string <span class="op">=</span> <span class="va">hoshika</span><span class="op">$</span><span class="va">Species</span>,pattern <span class="op">=</span> <span class="st">"_"</span>, replacement <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>

<span class="co"># BROT</span>
<span class="va">fn_brot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Brot/BROT2_dat.csv"</span><span class="op">)</span>
<span class="va">brot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="va">fn_brot2</span><span class="op">)</span>

<span class="co">#Global wood density database</span>
<span class="co"># Zanne, A.E., Lopez-Gonzalez, G.*, Coomes, D.A., Ilic, J., Jansen, S., Lewis, S.L., Miller, R.B., Swenson, N.G., Wiemann, M.C., and Chave, J. 2009. Global wood density database. </span>
<span class="co"># Dryad. Identifier: http://hdl.handle.net/10255/dryad.235.</span>
<span class="va">fn_gwdd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/GlobalWoodDensityDatabase/GlobalWoodDensityDatabase.xls"</span><span class="op">)</span>
<span class="va">gwdd</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_gwdd</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># Flammability</span>
<span class="va">fn_flam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FuelAttributes/FuelAttributes.xlsx"</span><span class="op">)</span>
<span class="va">flam</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_flam</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># Fine-fuel ratio</span>
<span class="va">fn_ffr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FineFuelRatio/FineFuelRatio.xlsx"</span><span class="op">)</span>
<span class="va">ffr</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_ffr</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># Fuel moisture content</span>
<span class="va">fn_fmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FMC/FMC.xlsx"</span><span class="op">)</span>
<span class="va">fmc_field</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_fmc</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">fmc_bib</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_fmc</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># Yebra et al. (2020)</span>
<span class="va">fn_yebra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/LFMC_Yebra_et_al_2020/Globe-LFMC-v2.xlsx"</span><span class="op">)</span>
<span class="va">fmc_yebra</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_yebra</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
</div>
<div id="plantleaf-classification" class="section level3">
<h3 class="hasAnchor">
<a href="#plantleaf-classification" class="anchor"></a>Plant/leaf classification</h3>
<div id="life-form" class="section level4">
<h4 class="hasAnchor">
<a href="#life-form" class="anchor"></a>Life form</h4>
<p>Load TRY life form data</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_life_form</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_343.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Homogenize life form values into six categories:</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_life_form</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_343.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch"</span>, <span class="st">"CH"</span>, <span class="st">"Cha"</span>, <span class="st">"chamaephyte"</span>, <span class="st">"Chamaephytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Chamaephyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cryptophytes"</span>, <span class="st">"cryptophyte"</span>,
                               <span class="st">"G"</span>, <span class="st">"geophyte"</span>, <span class="st">"Geophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Cryptophyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ep"</span>, <span class="st">"epiphyte"</span>,<span class="st">"Epiphytes"</span>, <span class="st">"liana"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Epiphyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="st">"hemicryptophyte"</span>, <span class="st">"Hemicryptophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hemicryptophyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hydrophyte"</span>, <span class="st">"Hydrophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hydrophyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mega- meso- and micro- phanerophyte"</span>,
                               <span class="st">"Phanerophyte (mega-,meso-, nano-)"</span>,
                               <span class="st">"Mega-, meso- and microphanerophyte"</span>,
                               <span class="st">"megaphanerophyte"</span>, <span class="st">"Megaphanerophyte"</span>,
                               <span class="st">"Micro-phanerophytes"</span>, <span class="st">"Nanophanerophyt"</span>,
                               <span class="st">"nanophanerophyte"</span>, <span class="st">"Nanophanerophyte"</span>,
                               <span class="st">"phanerophyte"</span>, <span class="st">"Phanerophytes"</span>, <span class="st">"shrub"</span>, <span class="st">"tree"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Phanerophyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"therophyte"</span>, <span class="st">"Therophyte (annual land plant)"</span>, <span class="st">"Therophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Therophyte"</span>
<span class="va">TRY_life_form</span><span class="op">&lt;-</span><span class="va">TRY_life_form</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chamaephyte"</span>, <span class="st">"Cryptophyte"</span>,
                                                               <span class="st">"Epiphyte"</span>, <span class="st">"Hemicryptophyte"</span>, <span class="st">"Hydrophyte"</span>,
                                                               <span class="st">"Phanerophyte"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits()</a></code> to parse TRY values:</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_life_form</span>,
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LifeForm"</span> <span class="op">=</span> <span class="st">"OrigValueStr"</span><span class="op">)</span>,
                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [OrigValueStr -&gt; LifeForm] species: 86 conspecific: 116 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 17 missing trait values (7.8 %) after populating with input data.</code></pre>
<p>Check which species have missing values:</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LifeForm"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                         Name LifeForm
## 14  Ampelodesmos mauritanica     &lt;NA&gt;
## 17    Apollonias canariensis     &lt;NA&gt;
## 20   Arctostaphylos uva-ursi     &lt;NA&gt;
## 114          Genistella spp.     &lt;NA&gt;
## 115    Gleditsia triacanthos     &lt;NA&gt;
## 117            Halimium spp.     &lt;NA&gt;
## 118    Heberdenia bahamensis     &lt;NA&gt;
## 136           Lithodora spp.     &lt;NA&gt;
## 149   Paliurus spina-christi     &lt;NA&gt;
## 153             Phlomis spp.     &lt;NA&gt;
## 155         Picconia excelsa     &lt;NA&gt;
## 169   Pleiomeris canariensis     &lt;NA&gt;
## 185              Retama spp.     &lt;NA&gt;
## 206              Teline spp.     &lt;NA&gt;
## 216            Vella spinosa     &lt;NA&gt;
## 218          Visnea mocanera     &lt;NA&gt;
## 219           Zizyphus lotus     &lt;NA&gt;</code></pre>
<p>Fill missing values manually:</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Arctostaphylos uva-ursi"</span>, <span class="st">"Genistella spp."</span>, 
                                       <span class="st">"Halimium spp."</span>, <span class="st">"Lithodora spp."</span>, <span class="st">"Phlomis spp."</span>,
                                       <span class="st">"Vella spinosa"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Chamaephyte"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ampelodesmos mauritanica"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hemicryptophyte"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Apollonias canariensis"</span>, <span class="st">"Gleditsia triacanthos"</span>,
                                       <span class="st">"Heberdenia bahamensis"</span>, <span class="st">"Picconia excelsa"</span>, <span class="st">"Pleiomeris canariensis"</span>,
                                       <span class="st">"Paliurus spina-christi"</span>, <span class="st">"Retama spp."</span>, <span class="st">"Teline spp."</span>,
                                       <span class="st">"Visnea mocanera"</span>, <span class="st">"Zizyphus lotus"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Phanerophyte"</span></code></pre></div>
<p>Show the number of taxa for each life form:</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##     Chamaephyte     Cryptophyte Hemicryptophyte    Phanerophyte 
##              52               1              13             153</code></pre>
</div>
<div id="leaf-shape" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-shape" class="anchor"></a>Leaf shape</h4>
<p>Load TRY leaf shape data</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_leaf_shape</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_43.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Homogenize TRY leaf shape values into five categories:</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"broadleaved"</span>, <span class="st">"broad-leaved"</span>, <span class="st">"B"</span>, <span class="st">"broadleaf"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Broad"</span>
<span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"needleleaved"</span>, <span class="st">"needle-leaved"</span>,<span class="st">"needle"</span>,<span class="st">"needle-leaf"</span>, <span class="st">"N"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Needle"</span>
<span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scale-shaped"</span>, <span class="st">"scale"</span>, <span class="st">"scale-like"</span>, <span class="st">"scale-leaf"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span>
<span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"narrowleaved"</span>, <span class="st">"linear"</span>, <span class="st">"Cylindrical"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Linear"</span>
<span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"photosynthetic stem"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Spines"</span>
<span class="va">TRY_leaf_shape</span><span class="op">&lt;-</span><span class="va">TRY_leaf_shape</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Broad"</span>, <span class="st">"Needle"</span>, <span class="st">"Scale"</span>, <span class="st">"Linear"</span>, <span class="st">"Spines"</span><span class="op">)</span>,
                               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"OrigValueStr"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_leaf_shape</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafShape"</span><span class="op">)</span></code></pre></div>
<p>Homogenize BROT2 leaf shape values into the same five categories:</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafShape</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafShape"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, 
                              <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">2</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"Needle-like"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Needle"</span>
<span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"Scale-like"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafShape"</span><span class="op">)</span></code></pre></div>
<p>Merge data sets and call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits()</a></code> to parse leaf shape values:</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafShape_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span>,
                       <span class="va">TRY_leaf_shape</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafShape_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafShape"</span> <span class="op">=</span> <span class="st">"LeafShape"</span><span class="op">)</span>,
                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafShape -&gt; LeafShape] species: 138 conspecific: 79 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 2 missing trait values (0.9 %) after populating with input data.</code></pre>
<p>Show which species have missing values:</p>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LeafShape"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                       Name LeafShape
## 114        Genistella spp.      &lt;NA&gt;
## 207 Tetraclinis articulata      &lt;NA&gt;</code></pre>
<p>Fill missing values manually:</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genistella spp."</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Broad"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tetraclinis articulata"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span></code></pre></div>
<p>Show the number of taxa for each leaf shape:</p>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Broad Linear Needle  Scale 
##    182      1     29      7</code></pre>
</div>
<div id="leaf-size" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-size" class="anchor"></a>Leaf size</h4>
<p>Load TRY leaf area data:</p>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_leaf_area</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_3110.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Classify TRY leaf area values into three leaf size categories:</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_leaf_area</span><span class="op">$</span><span class="va">LeafSize</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_leaf_area</span><span class="op">$</span><span class="va">StdValue</span><span class="op">)</span>, 
                             breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">225</span>, <span class="fl">2025</span>,<span class="fl">100000</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">TRY_LeafSize</span><span class="op">&lt;-</span><span class="va">TRY_leaf_area</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_LeafSize</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Species"</span></code></pre></div>
<p>Split BROT2 data into leaf area values and leaf size strings:</p>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafArea"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Trait"</span>, <span class="st">"Data"</span>, <span class="st">"Units"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_LeafSize</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Units</span><span class="op">==</span><span class="st">"[5]"</span>,<span class="op">]</span>
<span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Units</span><span class="op">==</span><span class="st">"mm2"</span>,<span class="op">]</span></code></pre></div>
<p>Reclassify BROT2 leaf size data into three categories</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"very small"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"small"</span>
<span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"very large"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"large"</span>
<span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, 
                              <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">2</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">brot2_LeafSize</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafSize</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafSize"</span><span class="op">)</span></code></pre></div>
<p>Classify BRO2 leaf area values into three categories:</p>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">LeafSize</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>, 
                              breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">225</span>, <span class="fl">2025</span>,<span class="fl">100000</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafArea</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Species"</span></code></pre></div>
<p>Merge data sets and call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits()</a></code> to parse leaf size values:</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafSize_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span>,
                      <span class="va">brot2_LeafArea</span>,
                      <span class="va">TRY_LeafSize</span><span class="op">)</span>

<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafSize_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafSize"</span> <span class="op">=</span> <span class="st">"LeafSize"</span><span class="op">)</span>,
                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafSize -&gt; LeafSize] species: 79 conspecific: 112 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 28 missing trait values (12.8 %) after populating with input data.</code></pre>
<p>Show species with missing values:</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                            Name LeafSize
## 10             Adenocarpus spp.     &lt;NA&gt;
## 14     Ampelodesmos mauritanica     &lt;NA&gt;
## 17       Apollonias canariensis     &lt;NA&gt;
## 33             Cedrus atlantica     &lt;NA&gt;
## 34               Cedrus deodara     &lt;NA&gt;
## 35                Cedrus libani     &lt;NA&gt;
## 38     Chamaecyparis lawsoniana     &lt;NA&gt;
## 41   Chamaespartium tridentatum     &lt;NA&gt;
## 54          Coriaria myrtifolia     &lt;NA&gt;
## 64  Cytisophyllum sessilifolium     &lt;NA&gt;
## 74          Daboecia cantabrica     &lt;NA&gt;
## 77               Dracaena drago     &lt;NA&gt;
## 90                Erinacea spp.     &lt;NA&gt;
## 96           Flueggea tinctoria     &lt;NA&gt;
## 114             Genistella spp.     &lt;NA&gt;
## 118       Heberdenia bahamensis     &lt;NA&gt;
## 130          Kleinia neriifolia     &lt;NA&gt;
## 149      Paliurus spina-christi     &lt;NA&gt;
## 155            Picconia excelsa     &lt;NA&gt;
## 169      Pleiomeris canariensis     &lt;NA&gt;
## 172       Pseudotsuga menziesii     &lt;NA&gt;
## 187           Rhododendron spp.     &lt;NA&gt;
## 200            Sophora japonica     &lt;NA&gt;
## 202               Spartium spp.     &lt;NA&gt;
## 206                 Teline spp.     &lt;NA&gt;
## 216               Vella spinosa     &lt;NA&gt;
## 218             Visnea mocanera     &lt;NA&gt;
## 219              Zizyphus lotus     &lt;NA&gt;</code></pre>
<p>Fill missing values manually:</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Apollonias canariensis"</span>,
                                       <span class="st">"Ampelodesmos mauritanica"</span>,
                                       <span class="st">"Dracaena drago"</span>, <span class="st">"Heberdenia bahamensis"</span>,
                                       <span class="st">"Picconia excelsa"</span>, <span class="st">"Pleiomeris canariensis"</span>,
                                       <span class="st">"Visnea mocanera"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Large"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Coriaria myrtifolia"</span>, <span class="st">"Flueggea tinctoria"</span>,
                                       <span class="st">"Kleinia neriifolia"</span>, <span class="st">"Rhododendron spp."</span>,
                                       <span class="st">"Sophora japonica"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Medium"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adenocarpus spp."</span>, <span class="st">"Cedrus atlantica"</span>,
                                       <span class="st">"Cedrus deodara"</span>, <span class="st">"Cedrus libani"</span>,
                                       <span class="st">"Chamaecyparis lawsoniana"</span>,
                                       <span class="st">"Chamaespartium tridentatum"</span>,
                                       <span class="st">"Cytisophyllum sessilifolium"</span>,
                                       <span class="st">"Daboecia cantabrica"</span>,
                                       <span class="st">"Erinacea spp."</span>, <span class="st">"Genistella spp."</span>,
                                       <span class="st">"Paliurus spina-christi"</span>, <span class="st">"Pseudotsuga menziesii"</span>,
                                       <span class="st">"Spartium spp."</span>, <span class="st">"Teline spp."</span>, <span class="st">"Vella spinosa"</span>,
                                       <span class="st">"Zizyphus lotus"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Small"</span></code></pre></div>
<p>Show the number of taxa for each leaf size:</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Large Medium  Small 
##     50     68    101</code></pre>
</div>
<div id="phenology-type" class="section level4">
<h4 class="hasAnchor">
<a href="#phenology-type" class="anchor"></a>Phenology type</h4>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_phenology</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_37.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"evergreen"</span>, <span class="st">"E"</span>, <span class="st">"EV"</span>, <span class="st">"always summer green"</span>,
                               <span class="st">"Evergreen broad-leaved"</span>, <span class="st">"Evergreen scale-like"</span>,
                               <span class="st">"Evergreen needle-leaved"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span>
<span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deciduous"</span>, <span class="st">"D"</span>, <span class="st">"Deciduous broad-leaved"</span>, <span class="st">"Deciduous"</span>,
                               <span class="st">"Nonevergreen"</span>, <span class="st">"winter deciduous"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span>
<span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"semi-deciduous"</span>,
                               <span class="st">"semi-evergreen"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-semideciduous"</span>
<span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"drought semi-deciduous"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"drought-semideciduous"</span>
<span class="va">TRY_phenology</span><span class="op">&lt;-</span><span class="va">TRY_phenology</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"progressive-evergreen"</span>,
                                                               <span class="st">"oneflush-evergreen"</span>, 
                                                               <span class="st">"winter-semideciduous"</span>,
                                                               <span class="st">"winter-deciduous"</span>,
                                                               <span class="st">"drought-semideciduous"</span><span class="op">)</span><span class="op">]</span>
<span class="va">TRY_phenology</span><span class="op">&lt;-</span><span class="va">TRY_phenology</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"OrigValueStr"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_phenology</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafPhenology"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafPhenology</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafPhenology"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"drought semi-deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"drought-semideciduous"</span>
<span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"evergreen"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span>
<span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"winter deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span>
<span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"winter semi-deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-semideciduous"</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafPhenology</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafPhenology"</span><span class="op">)</span></code></pre></div>
<p>Merge data sets and call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits()</a></code> to parse leaf phenology:</p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafPhenology_data</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafPhenology</span>,
                          <span class="va">TRY_phenology</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafPhenology_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PhenologyType"</span> <span class="op">=</span> <span class="st">"LeafPhenology"</span><span class="op">)</span>,
                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafPhenology -&gt; PhenologyType] species: 123 conspecific: 93 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 3 missing trait values (1.4 %) after populating with input data.</code></pre>
<p>Show which species have missing values:</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"PhenologyType"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                       Name PhenologyType
## 114        Genistella spp.          &lt;NA&gt;
## 169 Pleiomeris canariensis          &lt;NA&gt;
## 216          Vella spinosa          &lt;NA&gt;</code></pre>
<p>Fill missing values manually:</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vella spinosa"</span>, <span class="st">"Genistella spp."</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pleiomeris canariensis"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span></code></pre></div>
<p>Show the number of taxa for each phenology type:</p>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## drought-semideciduous    oneflush-evergreen      winter-deciduous 
##                     3                   122                    94</code></pre>
</div>
</div>
<div id="plant-size" class="section level3">
<h3 class="hasAnchor">
<a href="#plant-size" class="anchor"></a>Plant size</h3>
<p>We already populated some plant size parameters from forest inventory data. Here we draw values for parameters that are not normally measured in forest inventory data (for obvious reasons), such as maximum rooting depth.</p>
<div id="maximum-rooting-depth" class="section level4">
<h4 class="hasAnchor">
<a href="#maximum-rooting-depth" class="anchor"></a>Maximum rooting depth</h4>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Z95</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_6.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Z95</span> <span class="op">&lt;-</span><span class="va">TRY_Z95</span><span class="op">[</span><span class="va">TRY_Z95</span><span class="op">$</span><span class="va">OriglName</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Max Rooting Depth (m)"</span>,
                                           <span class="st">"Rooting depth"</span>,
                                           <span class="st">"Rooting depth (m)"</span>,
                                           <span class="st">"Rooting depth_max"</span>,
                                           <span class="st">"RootDepth"</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">TRY_Z95</span> <span class="op">&lt;-</span> <span class="va">TRY_Z95</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_Z95</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Z95"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_Z95</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RootDepth"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_Z95</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_Z95</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_Z95</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Z95"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Z95_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">TRY_Z95</span>,
                 <span class="va">brot2_Z95</span><span class="op">)</span>
<span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span><span class="op">(</span><span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span>, <span class="fl">0.15</span><span class="op">)</span> <span class="co"># Minimum of 15 cm depth</span>
<span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span><span class="op">(</span><span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># Maximum of 10 m depth</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Z95_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Z95"</span> <span class="op">=</span> <span class="st">"Z95"</span><span class="op">)</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Z95"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Z95 -&gt; Z95] species: 49 conspecific: 119 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 51 missing trait values (23.3 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE    88   63         17
##   TRUE     25   16         10</code></pre>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   113   79         27</code></pre>
</div>
</div>
<div id="leaf-phenology" class="section level3">
<h3 class="hasAnchor">
<a href="#leaf-phenology" class="anchor"></a>Leaf phenology</h3>
<div id="leaf-duration" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-duration" class="anchor"></a>Leaf duration</h4>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LeafDuration</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_12.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_LeafDuration</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafDuration</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_LeafDuration</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafDuration"</span><span class="op">)</span></code></pre></div>
<p>Adapt data sources:</p>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"LL"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafDuration"</span>
<span class="va">brot2_LeafDuration</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafLifespan"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_LeafDuration</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_LeafDuration</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafDuration</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafDuration"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafDuration_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafDuration"</span><span class="op">)</span><span class="op">]</span>,
                         <span class="va">TRY_LeafDuration</span>,
                         <span class="va">brot2_LeafDuration</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafDuration_data</span>, 
                                trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafDuration"</span> <span class="op">=</span> <span class="st">"LeafDuration"</span><span class="op">)</span>,
                                scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafDuration"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">12</span><span class="op">}</span><span class="op">)</span>,
                                taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafDuration -&gt; LeafDuration] species: 64 conspecific: 102 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 53 missing trait values (24.2 %) after populating with input data.</code></pre>
</div>
</div>
<div id="anatomy" class="section level3">
<h3 class="hasAnchor">
<a href="#anatomy" class="anchor"></a>Anatomy</h3>
<div id="specific-leaf-area" class="section level4">
<h4 class="hasAnchor">
<a href="#specific-leaf-area" class="anchor"></a>Specific leaf area</h4>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_SLA</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_3117.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_SLA</span> <span class="op">&lt;-</span> <span class="va">TRY_SLA</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_SLA</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"SLA"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_SLA</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SLA"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_SLA</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_SLA</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_SLA</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"SLA"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SLA_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"SLA"</span><span class="op">)</span><span class="op">]</span>,
                 <span class="va">TRY_SLA</span>,
                 <span class="va">brot2_SLA</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">SLA_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"SLA"</span> <span class="op">=</span> <span class="st">"SLA"</span><span class="op">)</span> ,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [SLA -&gt; SLA] species: 106 conspecific: 103 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 10 missing trait values (4.6 %) after populating with input data.</code></pre>
</div>
<div id="leaf-density" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-density" class="anchor"></a>Leaf density</h4>
<div class="sourceCode" id="cb339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LeafDensity</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_48.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_LeafDensity</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafDensity"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; LeafDensity] species: 62 conspecific: 95 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 62 missing trait values (28.3 %) after populating with input data.</code></pre>
</div>
<div id="wood-density" class="section level4">
<h4 class="hasAnchor">
<a href="#wood-density" class="anchor"></a>Wood density</h4>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_WoodDensity</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_4.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_WoodDensity</span> <span class="op">&lt;-</span> <span class="va">TRY_WoodDensity</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_WoodDensity</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span>
<span class="va">gwdd_WoodDensity</span><span class="op">&lt;-</span><span class="va">gwdd</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Binomial"</span>, <span class="st">"Wood density (g/cm^3), oven dry mass/fresh volume"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">gwdd_WoodDensity</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"WD"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"WoodDensity"</span></code></pre></div>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_WoodDensity</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"StemDensity"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_WoodDensity</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_WoodDensity</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_WoodDensity</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">WoodDensity_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"WoodDensity"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">TRY_WoodDensity</span>,
                        <span class="va">brot2_WoodDensity</span>,
                        <span class="va">gwdd_WoodDensity</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">WoodDensity_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WoodDensity"</span> <span class="op">=</span> <span class="st">"WoodDensity"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [WoodDensity -&gt; WoodDensity] species: 88 conspecific: 105 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 26 missing trait values (11.9 %) after populating with input data.</code></pre>
</div>
<div id="fine-fuel-ratio" class="section level4">
<h4 class="hasAnchor">
<a href="#fine-fuel-ratio" class="anchor"></a>Fine fuel ratio</h4>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ffr</span><span class="op">)</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r635"</span> <span class="op">=</span> <span class="st">"r635"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [r635 -&gt; r635] species: 30 conspecific: 56 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 133 missing trait values (60.7 %) after populating with input data.</code></pre>
</div>
<div id="fraction-of-dead-material-p_dead" class="section level4">
<h4 class="hasAnchor">
<a href="#fraction-of-dead-material-p_dead" class="anchor"></a>Fraction of dead material (<span class="math inline">\(P_{dead}\)</span>)</h4>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">pDead</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   140    79</code></pre>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_DF</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DeadFuel"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Trait"</span>, <span class="st">"Data"</span>, <span class="st">"Units"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Units</span><span class="op">==</span><span class="st">"%"</span><span class="op">)</span>
<span class="va">brot2_DF</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_DF</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">brot2_DF</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pDead"</span> <span class="op">=</span> <span class="st">"Data"</span><span class="op">)</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pDead"</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">100</span><span class="op">}</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Taxon"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Data -&gt; pDead] species: 1 conspecific: 21 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 57 missing trait values (26 %) after populating with input data.</code></pre>
</div>
<div id="leaf-area-to-sapwood-area-ratio" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-area-to-sapwood-area-ratio" class="anchor"></a>Leaf area to sapwood area ratio</h4>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Hv</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_171.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Huber value"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Huber value"</span><span class="op">]</span><span class="op">)</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"leaf.area.per.sapwood.area"</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"leaf.area.per.sapwood.area"</span><span class="op">]</span><span class="op">*</span><span class="fl">100</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Sapwood: leaf area ratio"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Sapwood: leaf area ratio"</span><span class="op">]</span><span class="op">)</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"The ratio of leaf area attached per unit sapwood cross-section area (m2 cm-2)"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"The ratio of leaf area attached per unit sapwood cross-section area (m2 cm-2)"</span><span class="op">]</span><span class="op">)</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at base of living crown, m2/cm2"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at base of living crown, m2/cm2"</span><span class="op">]</span><span class="op">)</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at breast height, m2/cm2"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at breast height, m2/cm2"</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    81.3  1862.8  3911.5  5300.5  6867.5 84200.0</code></pre>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Hv</span> <span class="op">&lt;-</span> <span class="va">TRY_Hv</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Al2As"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hydratry_Hv</span> <span class="op">&lt;-</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"Hv"</span><span class="op">)</span><span class="op">]</span>
<span class="va">hydratry_Hv</span><span class="op">$</span><span class="va">Hv</span><span class="op">&lt;-</span> <span class="fl">10000</span><span class="op">/</span><span class="va">hydratry_Hv</span><span class="op">$</span><span class="va">Hv</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry_Hv</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Al2As"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Hv_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">TRY_Hv</span>,
               <span class="va">hydratry_Hv</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Hv_data</span>,
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Al2As"</span> <span class="op">=</span> <span class="st">"Al2As"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Al2As -&gt; Al2As] species: 27 conspecific: 76 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 116 missing trait values (53 %) after populating with input data.</code></pre>
</div>
<div id="leaf-width" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-width" class="anchor"></a>Leaf width</h4>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LW</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_145.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_LW</span>,
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafWidth"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; LeafWidth] species: 60 conspecific: 109 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 50 missing trait values (22.8 %) after populating with input data.</code></pre>
</div>
<div id="specific-root-length" class="section level4">
<h4 class="hasAnchor">
<a href="#specific-root-length" class="anchor"></a>Specific root length</h4>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_SRL</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_614.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_SRL</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SRL"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; SRL] species: 8 conspecific: 52 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 159 missing trait values (72.6 %) after populating with input data.</code></pre>
</div>
</div>
<div id="tissue-moisture" class="section level3">
<h3 class="hasAnchor">
<a href="#tissue-moisture" class="anchor"></a>Tissue moisture</h3>
<div id="minimummaximum-fuel-moisture-content" class="section level4">
<h4 class="hasAnchor">
<a href="#minimummaximum-fuel-moisture-content" class="anchor"></a>Minimum/maximum fuel moisture content</h4>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fmc_yebra</span><span class="op">$</span><span class="va">Species.collected</span><span class="op">[</span><span class="va">fmc_yebra</span><span class="op">$</span><span class="va">Species.collected</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Salvia officinalis"</span>

<span class="va">FMC_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">fmc_field</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species name"</span>, <span class="st">"MinFMC_DW"</span>, <span class="st">"MaxFMC_DW"</span><span class="op">)</span><span class="op">]</span>,
                  <span class="va">fmc_bib</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species name"</span>, <span class="st">"MinFMC_DW"</span>, <span class="st">"MaxFMC_DW"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">FMC_data</span><span class="op">$</span><span class="va">`Species name`</span><span class="op">[</span><span class="va">FMC_data</span><span class="op">$</span><span class="va">`Species name`</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Salvia officinalis"</span></code></pre></div>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fmc_yebra</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"minFMC"</span> <span class="op">=</span> <span class="st">"LFMC.value"</span><span class="op">)</span>,
                           summary_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>,probs<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,
                           summary_params <span class="op">=</span> <span class="cn">NULL</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species.collected"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LFMC.value -&gt; minFMC] species: 37 conspecific: 88 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 94 missing trait values (42.9 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fmc_yebra</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"maxFMC"</span> <span class="op">=</span> <span class="st">"LFMC.value"</span><span class="op">)</span>,
                           summary_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>,probs<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,
                           summary_params <span class="op">=</span> <span class="cn">NULL</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species.collected"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LFMC.value -&gt; maxFMC] species: 37 conspecific: 88 genus: 0 family: 0 order: 0 group: 0
## 94 missing trait values (42.9 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">FMC_data</span><span class="op">)</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"minFMC"</span> <span class="op">=</span> <span class="st">"MinFMC_DW"</span>,
                                             <span class="st">"maxFMC"</span> <span class="op">=</span> <span class="st">"MaxFMC_DW"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species name"</span>, erase_previous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [MinFMC_DW -&gt; minFMC] species: 9 conspecific: 8 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 77 missing trait values (35.2 %) after populating with input data.</code></pre>
<pre><code>## Mapping [MaxFMC_DW -&gt; maxFMC] species: 9 conspecific: 8 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 77 missing trait values (35.2 %) after populating with input data.</code></pre>
</div>
<div id="leaf-pressure-volume-curve" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-pressure-volume-curve" class="anchor"></a>Leaf pressure-volume curve</h4>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"πo.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafPI0"</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"ε.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafEPS"</span></code></pre></div>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LeafPI0</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_188.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_LeafPI0</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafPI0</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_LeafPI0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span>
<span class="va">TRY_LeafPI0</span><span class="op">$</span><span class="va">LeafPI0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">TRY_LeafPI0</span><span class="op">$</span><span class="va">LeafPI0</span> </code></pre></div>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LeafEPS</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_190.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_LeafEPS</span><span class="op">$</span><span class="va">StdValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">)</span> 
<span class="va">TRY_LeafEPS</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafEPS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafPI0_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">TRY_LeafPI0</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span><span class="op">]</span>,
                     <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafPI0_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafPI0"</span> <span class="op">=</span> <span class="st">"LeafPI0"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafPI0 -&gt; LeafPI0] species: 16 conspecific: 54 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 149 missing trait values (68 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafEPS_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span><span class="op">]</span>,
                     <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafEPS_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafEPS"</span> <span class="op">=</span> <span class="st">"LeafEPS"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafEPS -&gt; LeafEPS] species: 15 conspecific: 49 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 155 missing trait values (70.8 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">bartlett</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafAF"</span> <span class="op">=</span> <span class="st">"af"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [af -&gt; LeafAF] species: 12 conspecific: 24 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 183 missing trait values (83.6 %) after populating with input data.</code></pre>
</div>
</div>
<div id="fuel-flammability" class="section level3">
<h3 class="hasAnchor">
<a href="#fuel-flammability" class="anchor"></a>Fuel flammability</h3>
<div id="heat-content-and-surface-area-to-volume-ratio" class="section level4">
<h4 class="hasAnchor">
<a href="#heat-content-and-surface-area-to-volume-ratio" class="anchor"></a>Heat content and surface area to volume ratio</h4>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">flam</span><span class="op">)</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HeatContent"</span> <span class="op">=</span> <span class="st">"High calorific value [J/kg]"</span>,
                                             <span class="st">"SAV"</span> <span class="op">=</span> <span class="st">"SurfaceAreaVolume[m2/m3]"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species name"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [High calorific value [J/kg] -&gt; HeatContent] species: 29 conspecific: 65 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 125 missing trait values (57.1 %) after populating with input data.</code></pre>
<pre><code>## Mapping [SurfaceAreaVolume[m2/m3] -&gt; SAV] species: 21 conspecific: 53 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 145 missing trait values (66.2 %) after populating with input data.</code></pre>
</div>
<div id="lignin-content" class="section level4">
<h4 class="hasAnchor">
<a href="#lignin-content" class="anchor"></a>Lignin content</h4>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Lignin</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_87.rds"</span><span class="op">)</span><span class="op">)</span>

<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Lignin</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LigninPercent"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LigninPercent"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">10</span><span class="op">}</span><span class="op">)</span>, <span class="co">#mg/g to % </span>
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; LigninPercent] species: 2 conspecific: 47 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 170 missing trait values (77.6 %) after populating with input data.</code></pre>
</div>
</div>
<div id="transpirationphotosynthesis" class="section level3">
<h3 class="hasAnchor">
<a href="#transpirationphotosynthesis" class="anchor"></a>Transpiration/photosynthesis</h3>
<div id="water-potential-determining-stomatal-closure" class="section level4">
<h4 class="hasAnchor">
<a href="#water-potential-determining-stomatal-closure" class="anchor"></a>Water potential determining stomatal closure</h4>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"πtlp.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Ptlp"</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"PItlp"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Ptlp"</span></code></pre></div>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ptlp_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span>,
                  <span class="va">hydratry</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span>,
                  <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Ptlp_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Psi_Extract"</span> <span class="op">=</span> <span class="st">"Ptlp"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Ptlp -&gt; Psi_Extract] species: 41 conspecific: 58 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 120 missing trait values (54.8 %) after populating with input data.</code></pre>
</div>
<div id="critical-water-potential" class="section level4">
<h4 class="hasAnchor">
<a href="#critical-water-potential" class="anchor"></a>Critical water potential</h4>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">P50_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span>,
                 <span class="va">choat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span>,
                 <span class="va">hydratry</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">P50_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Psi_Critic"</span> <span class="op">=</span> <span class="st">"P50"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [P50 -&gt; Psi_Critic] species: 64 conspecific: 76 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 79 missing trait values (36.1 %) after populating with input data.</code></pre>
</div>
<div id="water-use-efficiency" class="section level4">
<h4 class="hasAnchor">
<a href="#water-use-efficiency" class="anchor"></a>Water use efficiency</h4>
<div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_WUE</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_134.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_WUE</span> <span class="op">&lt;-</span> <span class="va">TRY_WUE</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">StdValue</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_WUE</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WUE"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; WUE] species: 7 conspecific: 32 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 180 missing trait values (82.2 %) after populating with input data.</code></pre>
</div>
<div id="minimummaximum-stomatal-conductance" class="section level4">
<h4 class="hasAnchor">
<a href="#minimummaximum-stomatal-conductance" class="anchor"></a>Minimum/maximum stomatal conductance</h4>
<p>(<span class="math inline">\(G_{swmin}\)</span> and <span class="math inline">\(G_{swmax}\)</span>)</p>
<div class="sourceCode" id="cb415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">duursma</span><span class="op">$</span><span class="va">gmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">duursma</span><span class="op">$</span><span class="va">gmin</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">duursma</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Gswmin"</span> <span class="op">=</span> <span class="st">"gmin"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"species"</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Gswmin"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="co">#From mmol·s-1·m-2 to mol·s-1·m-2</span></code></pre></div>
<pre><code>## Mapping [gmin -&gt; Gswmin] species: 18 conspecific: 52 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 149 missing trait values (68 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb418"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">hoshika</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Gswmax"</span> <span class="op">=</span> <span class="st">"gmax.(mol.m-2.s-1)"</span><span class="op">)</span> ,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [gmax.(mol.m-2.s-1) -&gt; Gswmax] species: 17 conspecific: 33 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 169 missing trait values (77.2 %) after populating with input data.</code></pre>
</div>
<div id="stem-maximum-hydraulic-conductivity" class="section level4">
<h4 class="hasAnchor">
<a href="#stem-maximum-hydraulic-conductivity" class="anchor"></a>Stem maximum hydraulic conductivity</h4>
<p>(<span class="math inline">\(K_{stem, max, ref}\)</span>)</p>
<div class="sourceCode" id="cb421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">hydratry</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmax_stemxylem"</span> <span class="op">=</span> <span class="st">"Ks"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Ks -&gt; Kmax_stemxylem] species: 36 conspecific: 74 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 109 missing trait values (49.8 %) after populating with input data.</code></pre>
</div>
<div id="stem-hydraulic-vulnerability" class="section level4">
<h4 class="hasAnchor">
<a href="#stem-hydraulic-vulnerability" class="anchor"></a>Stem hydraulic vulnerability</h4>
<div class="sourceCode" id="cb424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_c</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_d</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P12</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">weib</span> <span class="op">=</span> <span class="fu"><a href="../../reference/conductancefunctions.html">hydraulics_psi2Weibull</a></span><span class="op">(</span>psi50 <span class="op">=</span> <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
                                  psi12 <span class="op">=</span> <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P12</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"c"</span><span class="op">]</span><span class="op">]</span>
    <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"d"</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">choat</span><span class="op">$</span><span class="va">P50</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">)</span>
<span class="va">choat</span><span class="op">$</span><span class="va">P88</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">)</span>
<span class="va">choat</span><span class="op">$</span><span class="va">VCstem_c</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">choat</span><span class="op">$</span><span class="va">VCstem_d</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">choat</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">weib</span> <span class="op">=</span> <span class="fu"><a href="../../reference/conductancefunctions.html">hydraulics_psi2Weibull</a></span><span class="op">(</span>psi50 <span class="op">=</span> <span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
                                  psi88 <span class="op">=</span> <span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="va">choat</span><span class="op">$</span><span class="va">VCstem_c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"c"</span><span class="op">]</span><span class="op">]</span>
    <span class="va">choat</span><span class="op">$</span><span class="va">VCstem_d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"d"</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">VC_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"VCstem_c"</span>, <span class="st">"VCstem_d"</span><span class="op">)</span><span class="op">]</span>,
                <span class="va">choat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"VCstem_c"</span>, <span class="st">"VCstem_d"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">VC_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"VCstem_c"</span> <span class="op">=</span> <span class="st">"VCstem_c"</span>,
                                                <span class="st">"VCstem_d"</span> <span class="op">=</span> <span class="st">"VCstem_d"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [VCstem_c -&gt; VCstem_c] species: 57 conspecific: 69 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 93 missing trait values (42.5 %) after populating with input data.</code></pre>
<pre><code>## Mapping [VCstem_d -&gt; VCstem_d] species: 57 conspecific: 69 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 93 missing trait values (42.5 %) after populating with input data.</code></pre>
</div>
<div id="photosynthetic-capacity" class="section level4">
<h4 class="hasAnchor">
<a href="#photosynthetic-capacity" class="anchor"></a>Photosynthetic capacity</h4>
<div class="sourceCode" id="cb430"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Narea</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_50.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_Narea</span> <span class="op">&lt;-</span> <span class="va">TRY_Narea</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_Narea</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Narea"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Narea_data</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Narea"</span><span class="op">)</span><span class="op">]</span>,
                   <span class="va">TRY_Narea</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Narea_data</span>, 
                                trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Narea"</span> <span class="op">=</span> <span class="st">"Narea"</span><span class="op">)</span>,
                                taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Narea -&gt; Narea] species: 86 conspecific: 108 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 25 missing trait values (11.4 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb434"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Vmax298</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_186.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Vmax298</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vmax298"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; Vmax298] species: 22 conspecific: 82 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 115 missing trait values (52.5 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Jmax298</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_269.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Jmax298</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Jmax298"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; Jmax298] species: 19 conspecific: 65 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 135 missing trait values (61.6 %) after populating with input data.</code></pre>
</div>
</div>
<div id="carbon-balance-and-growth" class="section level3">
<h3 class="hasAnchor">
<a href="#carbon-balance-and-growth" class="anchor"></a>Carbon balance and growth</h3>
<div id="wood-carbon-content" class="section level4">
<h4 class="hasAnchor">
<a href="#wood-carbon-content" class="anchor"></a>Wood carbon content</h4>
<div class="sourceCode" id="cb440"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_WoodC</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_407.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_WoodC</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WoodC"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WoodC"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">}</span><span class="op">)</span>, <span class="co">#mg/g to g/g </span>
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; WoodC] species: 31 conspecific: 75 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 113 missing trait values (51.6 %) after populating with input data.</code></pre>
</div>
</div>
</div>
<div id="recruitment-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#recruitment-parameters" class="anchor"></a>Recruitment parameters</h2>
<p>This document describes the parametrization of bioclimatic recruitment thresholds for the forest dynamics model <code><a href="../../reference/fordyn.html">fordyn()</a></code> included in <code>medfate</code>. Specifically, we aim to find suitable values for parameters:</p>
<ul>
<li>
<code>MinTempRecr</code>: Minimum average temperature of the coldest month necessary for recruiting.</li>
<li>
<code>MinMoistureRecr</code>: Minimum moisture index (annual precipitation over annual ETP) necessary for recruiting.</li>
<li>
<code>MinFPARRecr</code>: Minimum fraction of PAR (in %) reaching the ground necessary for recruiting.</li>
</ul>
<p>To find suitable values for these parameters that set the recruitment requirements we will first determine bioclimatic and light conditions in IFN3 plots and then we will calculate the 1% quantile from the observed distribution of each target species.</p>
<div id="bioclimatic-and-ground-par-conditions-of-ifn3-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#bioclimatic-and-ground-par-conditions-of-ifn3-plots" class="anchor"></a>Bioclimatic and ground PAR conditions of IFN3 plots</h3>
<div id="mean-temperature-of-the-coldest-month-and-moisture-index" class="section level4">
<h4 class="hasAnchor">
<a href="#mean-temperature-of-the-coldest-month-and-moisture-index" class="anchor"></a>Mean temperature of the coldest month and moisture index</h4>
<p>Load yearly climatic data (from Santander’s Group) between 1981 and 2015, for all IFN plots in Spain:</p>
<div class="sourceCode" id="cb443"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pr_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"IFNbioclimatic/Sources/pr_year.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pet_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"IFNbioclimatic/Sources/pet_year.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">tmin_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"IFNbioclimatic/Sources/tmin_year.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>These are objects of class <code>SpatialPointsDataFrame</code>:</p>
<ul>
<li>
<code>tmin_year</code> contains the mean temperature of the coldest month for each year and plot.</li>
<li>
<code>pr_year</code> contains the annual precipitation for each year and plot.</li>
<li>
<code>pet_year</code> contains the annual potential evapotranspiration for each year and plot.</li>
</ul>
<p>We calculate interannual means for tmin and the annual moisture index, for the period 1995-2005 that includes IFN3 (around 2000):</p>
<div class="sourceCode" id="cb444"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yearStrings</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"1995-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2005-01-01"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"year"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pet_year</span><span class="op">@</span><span class="va">data</span><span class="op">[</span><span class="va">pet_year</span><span class="op">@</span><span class="va">data</span><span class="op">&lt;</span><span class="fl">100</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">ppet_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">pr_year</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>,<span class="va">yearStrings</span><span class="op">]</span><span class="op">/</span><span class="va">pet_year</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>,<span class="va">yearStrings</span><span class="op">]</span>, 
                      na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">tmin_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">tmin_year</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>,<span class="va">yearStrings</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">bioclimIFN34</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ppet_mean</span>, <span class="va">tmin_mean</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bioclimIFN34</span><span class="op">)</span></code></pre></div>
<pre><code>##    ppet_mean        tmin_mean     
##  Min.   :0.1542   Min.   :-6.640  
##  1st Qu.:0.4582   1st Qu.: 2.627  
##  Median :0.6109   Median : 4.463  
##  Mean   :0.8033   Mean   :   Inf  
##  3rd Qu.:1.0027   3rd Qu.: 6.904  
##  Max.   :8.0428   Max.   :   Inf  
##  NA's   :282</code></pre>
</div>
<div id="percentage-of-par-reaching-the-ground" class="section level4">
<h4 class="hasAnchor">
<a href="#percentage-of-par-reaching-the-ground" class="anchor"></a>Percentage of PAR reaching the ground</h4>
<p>If foliar biomass allometries were available for all species in Spain, PAR calculations could include all Spanish forest plots. However, foliar biomass (and hence LAI) values can only be calculated for Catalonia. We hence, load the list of <code>forest</code> objects corresponding to IFN3 plots in Catalonia:</p>
<div class="sourceCode" id="cb446"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">forest_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/forestlist_IFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We then calculate percentage of PAR reaching the ground using <code>medfate</code> function <code><a href="../../reference/Vertical%20profiles.html">vprofile_PARExtinction()</a></code>:</p>
<div class="sourceCode" id="cb447"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">par_groundIFN3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">forest_list</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">par_groundIFN3</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">forest_list</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">forest_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">f</span> <span class="op">=</span> <span class="va">forest_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">treeData</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="op">||</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">f</span><span class="op">$</span><span class="va">shrubData</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">par_groundIFN3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../../reference/Vertical%20profiles.html">vprofile_PARExtinction</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">SpParams</span>, draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">par_groundIFN3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">100</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>Some plots may have missing <code>par_groundIFN3</code> values, which may be the result of missing parameter values in <code>SpParams</code>:</p>
<div class="sourceCode" id="cb448"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">par_groundIFN3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
## 17385 68524</code></pre>
<p>Subset plots with PAR data:</p>
<div class="sourceCode" id="cb450"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">par_groundIFN3</span> <span class="op">&lt;-</span> <span class="va">par_groundIFN3</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">par_groundIFN3</span><span class="op">)</span><span class="op">]</span></code></pre></div>
</div>
<div id="subset-of-plots-with-available-information" class="section level4">
<h4 class="hasAnchor">
<a href="#subset-of-plots-with-available-information" class="anchor"></a>Subset of plots with available information</h4>
<p>Define vectors of plot IDs for which there is information about bioclimatic and light conditions:</p>
<div class="sourceCode" id="cb451"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plotBioclim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">bioclimIFN34</span><span class="op">)</span>
<span class="va">plotPAR</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">par_groundIFN3</span><span class="op">)</span></code></pre></div>
<p>Since we took Spain for bioclimatic limits and Catalonia for PAR, there are more plots with bioclimatic information (n = 81152) than with PAR information (n = 17385).</p>
</div>
</div>
<div id="characterizing-distribution-of-bioclimatic-variables-for-ifn-species" class="section level3">
<h3 class="hasAnchor">
<a href="#characterizing-distribution-of-bioclimatic-variables-for-ifn-species" class="anchor"></a>Characterizing distribution of bioclimatic variables for IFN species</h3>
<div id="load-and-filter-ifn3-data" class="section level4">
<h4 class="hasAnchor">
<a href="#load-and-filter-ifn3-data" class="anchor"></a>Load and filter IFN3 data</h4>
<p>We begin by loading IFN3 data tables (regeneration data, tree data and shrub data):</p>
<div class="sourceCode" id="cb452"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/regDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/treeDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">shrub</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/shrubDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We filter the three datasets according to available plot bioclimatic information:</p>
<div class="sourceCode" id="cb453"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">regFiltBioclim</span> <span class="op">&lt;-</span> <span class="va">reg</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">%in%</span> <span class="va">plotBioclim</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb455"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">treeFiltBioclim</span> <span class="op">&lt;-</span> <span class="va">tree</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">%in%</span> <span class="va">plotBioclim</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>

<span class="va">shrubFiltBioclim</span> <span class="op">&lt;-</span> <span class="va">shrub</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">%in%</span> <span class="va">plotBioclim</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>We do the same for PAR information, which corresponds to IFN3 plots in Catalonia, only:</p>
<div class="sourceCode" id="cb456"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">regFiltPAR</span> <span class="op">&lt;-</span> <span class="va">reg</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">%in%</span> <span class="va">plotPAR</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>

<span class="va">treeFiltPAR</span> <span class="op">&lt;-</span> <span class="va">tree</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">%in%</span> <span class="va">plotPAR</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>

<span class="va">shrubFiltPAR</span> <span class="op">&lt;-</span> <span class="va">shrub</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">%in%</span> <span class="va">plotPAR</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
</div>
<div id="target-species" class="section level4">
<h4 class="hasAnchor">
<a href="#target-species" class="anchor"></a>Target species</h4>
<p>Determine the IFN species to be characterized, by finding unique species codes:</p>
<div class="sourceCode" id="cb457"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spUnique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">regFiltBioclim</span><span class="op">$</span><span class="va">Species</span>, 
                          <span class="va">treeFiltBioclim</span><span class="op">$</span><span class="va">Species</span>, 
                          <span class="va">shrubFiltBioclim</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>There are 338 species to be characterized.</p>
<p>Translate IFN species codes to medfate species codes (some species are considered together in <code>medfate</code>):</p>
<div class="sourceCode" id="cb458"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Species_medfate</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/translateIFNSpeciesCodes.html">translateIFNSpeciesCodes</a></span><span class="op">(</span><span class="va">spUnique</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">IFNcodes</span><span class="op">)</span></code></pre></div>
<p>Some IFN species do not have counterparts in <code>SpParams</code>, as these were discarded when defining the set of target species:</p>
<div class="sourceCode" id="cb459"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Species_medfate</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   291    47</code></pre>
</div>
<div id="quantile-tables" class="section level4">
<h4 class="hasAnchor">
<a href="#quantile-tables" class="anchor"></a>Quantile tables</h4>
<p>Define quantile probabilities (1%, 5% and 10%):</p>
<div class="sourceCode" id="cb461"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">probs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p>We now create quantile output tables, including a column <code>n</code> with the number of plots on which quantiles are based:</p>
<div class="sourceCode" id="cb462"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q_ppet</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Species <span class="op">=</span> <span class="va">spUnique</span>, 
                   Species_medfate <span class="op">=</span> <span class="va">Species_medfate</span>,
                   q1 <span class="op">=</span> <span class="cn">NA</span>,
                   q5 <span class="op">=</span> <span class="cn">NA</span>, 
                   q10 <span class="op">=</span> <span class="cn">NA</span>,
                   n <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>
<span class="va">q_tmin</span><span class="op">&lt;-</span><span class="va">q_ppet</span>
<span class="va">q_par</span> <span class="op">&lt;-</span> <span class="va">q_ppet</span></code></pre></div>
<p>We fill quantile output for minimum temperature and moisture index. This is done by finding (for each species), the set of plots where the species is present (either as adult, regeneration or shrub) and subseting the bioclimatic information corresponding to this set of plots. Quantiles are estimated from this set, as long as it contains more than 1 plot. The number of plots in the set is also stored:</p>
<div class="sourceCode" id="cb463"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">spUnique</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">sp</span> <span class="op">=</span> <span class="va">spUnique</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">ids_reg_bioclim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">regFiltBioclim</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">regFiltBioclim</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="va">sp</span><span class="op">]</span><span class="op">)</span>
  <span class="va">ids_tree_bioclim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">treeFiltBioclim</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">treeFiltBioclim</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="va">sp</span><span class="op">]</span><span class="op">)</span>
  <span class="va">ids_shrub_bioclim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">shrubFiltBioclim</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">shrubFiltBioclim</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="va">sp</span><span class="op">]</span><span class="op">)</span>
  <span class="va">ids_bioclim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ids_reg_bioclim</span>, <span class="va">ids_tree_bioclim</span>, <span class="va">ids_shrub_bioclim</span><span class="op">)</span><span class="op">)</span>
  <span class="va">q_ppet</span><span class="op">[</span><span class="va">i</span>,<span class="fl">6</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ids_bioclim</span><span class="op">)</span>
  <span class="va">q_tmin</span><span class="op">[</span><span class="va">i</span>,<span class="fl">6</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ids_bioclim</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ids_bioclim</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">q_ppet</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">bioclimIFN34</span><span class="op">[</span><span class="va">ids_bioclim</span>,<span class="st">"ppet_mean"</span><span class="op">]</span>,
                             probs<span class="op">=</span><span class="va">probs</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
    <span class="va">q_tmin</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">bioclimIFN34</span><span class="op">[</span><span class="va">ids_bioclim</span>,<span class="st">"tmin_mean"</span><span class="op">]</span>,
                             probs<span class="op">=</span><span class="va">probs</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>The resulting quantile tables are for the temperature of the coldest month:</p>
<pre><code>##     Species Species_medfate          q1          q5         q10     n
## 1         1             117  1.48591756  1.63471993  1.82072290     3
## 2         2              12 -1.71642998 -0.28714390  0.44305375  2846
## 3         3              96  1.07332234  3.20058030  4.08155546  1739
## 4         4             185  1.27570497  2.35719274  2.93376358  4339
## 5         5              91  0.42077515  1.68873915  2.04086221    54
## 6         6             142  5.25915801  6.49218657  7.29493332   691
## 7         7               2  2.91402298  5.24841259  6.14020096    34
## 8         8             151  1.23181920  2.51312642  3.13490404  1501
## 9         9              54  0.49593177  1.47627646  2.01602435  1175
## 10       11              10  4.77085571  4.98593974  5.25479479     6
## 11       12             137 -0.79577690  0.08991898  0.77429325   232
## 12       13              35  2.45773436  2.95510856  3.22367355    70
## 13       14             204 -0.37096083  0.06946467  0.45855413   100
## 14       15              58 -0.56091884  0.31352529  0.78259547   168
## 15       16             172  0.09580574  1.79790150  2.66161835  1050
## 16       17              32  1.21790928  1.52260504  1.75300973    24
## 17       18              37  3.33631000  3.47148837  4.01196627    29
## 18       19              NA  8.55470208  8.69383283  8.86774627     2
## 19       20              NA  3.85351613  3.85524135  3.85739787     2
## 20       21             162 -2.60769902 -1.18949297 -0.53702369  8581
## 21       22             163 -5.56341109 -4.92466764 -4.27341165   596
## 22       23             160  2.57328017  3.07561731  3.54053984  3563
## 23       24             157  2.03570296  2.79756717  3.25045103 12050
## 24       25             158 -0.47007303  0.31331736  0.76721996  7091
## 25       26             159  0.73555052  1.47654569  1.97925012 11536
## 26       27             156  2.45128251  3.24757299  4.49606312    14
## 27       28             161  2.63426216  3.82111840  4.46234363  1701
## 28       29              NA  2.68196188  2.68467699  2.68807088     8
## 29       31               0 -4.01406496 -3.40957773 -2.90194035   381
## 30       32               1  2.73767480  4.49187681  5.15765281    78
## 31       33             155 -0.84024350 -0.18333155  0.02050673    28
## 32       34             171  0.36469442  0.75871775  1.05633581   103
## 33       35             130  0.72955217  2.05784970  2.55644206    74
## 34       36              62  1.19838744  2.15709206  2.42184336    81
## 35       37             125 -3.58619043 -1.49796557 -0.59457085  6654
## 36       38             128 -0.03846743  0.47368674  0.74056012  2166
## 37       39             127  0.62298550  1.41143449  1.85075732  4422
## 38       40              NA  3.92116388  5.71225434  7.95111742     6
## 39       41             181  1.32224728  3.65021099  4.28857232  6019
## 40       42             178 -1.63371753 -0.64975716  0.07774705  1345
## 41       43             180 -0.37287813  0.50766127  0.94222726  6219
## 42       44             175  0.11909915  0.96958350  1.44425775  8049
## 43       45             176  0.40586805  1.44816222  2.02399432 26966
## 44       46             183  2.73876550  4.27273281  5.16272339  3744
## 45       47             173  2.63312824  8.52100801  9.43883105   314
## 46       48             182  3.35820215  4.23962262  4.49078479   105
## 47       49              NA  4.60754067  4.75226067  4.93316068    10
## 48       51             169  2.11042970  2.73415627  3.18182055   172
## 49       52             169 -1.90058911 -0.81272938 -0.26072940   201
## 50       53             203  3.88947795  4.79579087  5.23122051   180
## 51       54              11  0.08762200  2.01995111  2.92221428   645
## 52       55              97 -0.92438084  0.30649052  1.74672607   836
## 53       56             213 -0.22281214  1.10497564  1.77703799   259
## 54       57             194 -1.06980177  0.47988279  1.53160057   490
## 55       58             169  0.14983940  1.78410100  2.20122603   706
## 56       59              NA  5.30503983  5.55016988  5.85658244     3
## 57       60              90          NA          NA          NA     1
## 58       61              90  5.27652884  6.10442436  6.51961649  3469
## 59       62              90  5.20090687  6.10857029  6.41408220   891
## 60       63              90  5.59349894  6.06520193  6.39622068    17
## 61       64              90  4.17050819  5.36308483  5.80189503    28
## 62       65             121 -0.46947067  0.26813167  0.84193449  2099
## 63       66             145  3.49686846  4.94411395  5.95928046  3282
## 64       67              36  6.79198946  7.75419506  8.06964081   535
## 65       68              18  1.97724686  2.93616181  3.49955081  3353
## 66       69             153  6.20190461  6.29149110  6.70081880    16
## 67       71              93 -1.39287193 -0.36481564  0.26001780  3962
## 68       72              31  1.60612311  2.94078460  3.58742145  3412
## 69       73              25 -3.39260269 -2.16048292 -1.05784947   330
## 70       74              56 -1.76396121 -0.49683666  0.46501922  2083
## 71       75             123  1.30197451  1.79461132  2.25201561   190
## 72       76               3 -0.34454483  0.59823980  1.15791386   965
## 73       77             211 -0.90049560 -0.32444833 -0.09172955    62
## 74       78             200 -1.63960692 -1.47634508 -1.34575525    63
## 75       79             167  3.02981943  3.55301012  4.02586227    58
## 76       83              79 10.40511112 10.40847111 10.41267109     2
## 77       89              NA          NA          NA          NA     1
## 78       91              27 -2.24194026 -0.77682023 -0.01864687  4924
## 79       92             189  2.26816306  3.21079377  4.13642436   165
## 80       93             166  1.88120088  2.70129547  3.15080261   805
## 81       94             132  3.43458554  5.26840751  6.36004819   404
## 82       95             170 -0.34786731  0.85736851  1.58874424   932
## 83       96             187  4.58401205  5.01571032  5.55533316     8
## 84       97             196 -1.57255066  1.11566620  2.01977332   252
## 85       99              NA  0.68675579  1.14919307  1.91570166    57
## 86      101              41  0.30560387  1.35418891  1.69001961   779
## 87      102              79 -0.39413779  0.83414700  1.34985363  4393
## 88      103              NA -2.42432809 -0.14261699  1.09805303  1979
## 89      104              NA -1.02763375  0.46873243  1.18235854  2168
## 90      105             174  1.66953608  2.62962897  3.08460972  9566
## 91      106              29 -2.80216542 -0.07528820  0.94867602  5120
## 92      107              19 -2.98614094 -0.25525390  0.56039647  3315
## 93      108             186 -5.89875742 -5.32722197 -5.09791722   165
## 94      109             133 -0.59101745  0.76466654  1.38948816  5067
## 95      110              74  0.45099437  1.40834860  2.12566541  1652
## 96      111             165  2.94506402  3.90051230  4.61744183  7237
## 97      112             134  0.27518435  1.09907959  1.58695352  1273
## 98      113             150  2.14781244  3.39378835  4.10476217  4844
## 99      114             195  1.42016095  2.34348264  2.86523010 14389
## 100     115             216 -1.09843239  0.71979790  1.51599452  2645
## 101     116              24 -1.12262180 -0.59095567 -0.27530858  1585
## 102     117             116 -0.24976555  0.93091894  1.40121974  5652
## 103     118              57 -3.40241907 -2.38712856 -1.70906940   115
## 104     119             190 -1.75039266 -0.13728474  0.51053848 12139
## 105     120              73  0.95766650  2.35658655  3.23974501  4199
## 106     121             191 -0.17530325  1.39231540  2.15731317 12582
## 107     122             185  0.40871538  1.32565989  2.41132013   611
## 108     123             218  3.79863376  3.81299615  3.83094914     2
## 109     124              26  1.15459069  1.90015465  2.45645289  1505
## 110     125              14  1.69857204  4.28148680  5.50941798   870
## 111     126              20  0.21751809  1.46893156  2.13426335   319
## 112     127             197 -0.35385472  0.45144177  0.93149875  1145
## 113     128             119  0.69626711  1.57188258  2.24511179  4386
## 114     129             210 -0.21395060  0.84604469  1.42571279 22309
## 115     130             193  1.09230979  2.46519157  3.15576897  2239
## 116     131             188 -3.33394995 -2.19106338 -1.33417195    79
## 117     132              51 -0.35659019  1.60421315  2.33720899   390
## 118     133              23  4.53834293  4.73330044  5.06711127    99
## 119     134             202  1.29531826  1.89202285  2.22272885   347
## 120     135             147  2.29327721  3.20949038  3.79696434   394
## 121     136              40 -0.99515709 -0.09344463  0.59791474  2138
## 122     137             214 -5.24441283 -3.99139970 -2.98027406   832
## 123     138              21  2.58225674  3.36712830  3.91413842  4250
## 124     139              53  1.17943895  2.38449690  2.97436888   491
## 125     140             115  2.16069938  3.78155448  4.48173091  1528
## 126     141              NA -0.16243815  0.96766561  1.68688825  2621
## 127     142             118  0.31178033  1.51712277  2.28644229  3082
## 128     143             122  1.57610531  2.63473819  3.00990399   146
## 129     144             136 -1.30229460  0.70792362  1.42932109  2648
## 130     145             139  4.37563105  5.06704780  5.63993803    16
## 131     146             143  6.13937886  6.87378999  7.33092116   225
## 132     147             148  4.24652261  4.29752759  4.36128381     7
## 133     148             170 -0.61182136 -0.00908310  0.37581399    28
## 134     149              NA  1.81876846  3.11318056  3.90853158  2338
## 135     150              13  4.75861492  5.63948953  6.18818661    15
## 136     151             209  2.31698273  3.10403801  3.50017524   415
## 137     152              55 -0.55699980  0.15352802  0.87438292   354
## 138     153              63  0.15203990  0.94366518  1.27128685    60
## 139     154              75  0.66558168  1.65308849  2.16754124  3970
## 140     155             109 -0.44926344  0.86417321  1.42505007  7690
## 141     156             146  0.43027226  1.61271218  2.47281179   130
## 142     157             212 -0.19159562  1.75229454  2.70748162  1210
## 143     158             138          NA          NA          NA     1
## 144     159              20  0.28454984  0.38867569  0.51883300     2
## 145     160              38  5.12443108  5.35223052  5.63697983     3
## 146     161              77  1.56560512  1.58744513  1.78995678    14
## 147     162              92 -0.78234430 -0.09455249  0.43086210  1569
## 148     163             120  1.03203005  1.13655486  1.26721087     4
## 149     165             205  5.55925101  6.34844858  9.86153455   119
## 150     166             192  0.98971235  0.99027476  0.99097776     4
## 151     170              NA          NA          NA          NA     1
## 152     171             152  3.98705643  6.97990869  7.62856286   527
## 153     172              NA          NA          NA          NA     1
## 154     173              78  8.69282357  8.90162356  9.16262355     7
## 155     177             105          NA          NA          NA     1
## 156     179             207  4.52051656  5.14200926  5.91887513     6
## 157     181              95          NA          NA          NA     1
## 158     185              NA          NA          NA          NA     1
## 159     186              NA          NA          NA          NA     1
## 160     207               2  4.95884645  5.22601068  5.47262542    62
## 161     215              58 -0.26721656  0.63277550  1.16381078  7266
## 162     217              33  2.68882138  2.81650356  2.97610628     2
## 163     219             206          NA          NA          NA     1
## 164     235             130 -0.63911079  0.73921002  2.46211103    11
## 165     236              59  0.81958091  2.11167581  2.40226237    47
## 166     237             126  0.79401253  1.59723919  2.12110872 10922
## 167     239             127 -1.63205158 -0.94008886 -0.73258773   277
## 168     243             179 -1.44793865 -0.41363990  0.26370242  1999
## 169     255              97 -1.69196981 -0.47427992  0.52248874   862
## 170     256             213  0.33947435  0.55455273  1.91903938    97
## 171     257             194  1.25209983  1.93415006  2.42962784   174
## 172     258             169  1.63241127  2.18162918  2.46921260   760
## 173     264              90  5.61964729  5.75306153  5.91982932     8
## 174     269             153  7.06469371  7.74643253  8.24803264    59
## 175     273              25 -1.78132264  0.42440294  1.63413088  1667
## 176     275             123  1.14635738  1.48123315  1.89982787     4
## 177     276               4 -0.71862622  0.72045127  1.36192619   511
## 178     277             211 -1.35703297 -0.80002887  0.08471538    37
## 179     278             200 -2.19221730 -1.19270686 -0.27014902   935
## 180     279             167          NA          NA          NA     1
## 181     291              27  6.94530224  7.52028885  8.32462154    23
## 182     293             164  7.45175797  7.51982177  7.60490152     2
## 183     295             170 -0.70963172  0.44404609  0.99131065  2698
## 184     297             196 -3.09671562 -2.07665307 -1.02670977    28
## 185     299              94  2.94832443  3.79716856  4.36612272   114
## 186     307               2  4.36407210  5.08130673  5.43723460    62
## 187     315              58  1.38604670  1.64785142  1.95124947    32
## 188     317              34  2.14534207  2.35546418  2.61811680     6
## 189     319             208  4.44087038  4.70014731  5.02424348     3
## 190     335             130          NA          NA          NA     1
## 191     336              60  2.81535943  2.91283568  3.03468099     4
## 192     350              NA          NA          NA          NA     1
## 193     355              97  1.81703776  3.29956183  4.13680842    32
## 194     356             213  0.75873875  1.40247807  2.20715223     9
## 195     357             194 -0.77621842  1.93480754  2.84941156   785
## 196     364              90  4.81736027  5.50087668  5.76089154    34
## 197     369              39  6.38312350  7.30741668  7.76152720   767
## 198     373              25 -3.65005268 -3.25066886 -2.55791417   170
## 199     376               5 -0.73856407  0.27809716  1.59125393    15
## 200     377             211  0.16820805  0.72373735  1.21482722    96
## 201     378             200 -3.97653820 -2.43335383 -1.52955998   697
## 202     392             114  3.76287551  3.88612352  4.04018353     4
## 203     395             170 -1.23908751  0.26051896  0.94795327   296
## 204     399             140  2.99576940  3.77673265  4.75293672     8
## 205     405              NA          NA          NA          NA     1
## 206     415              58  0.74781046  1.62105921  1.88472338    42
## 207     436              61  3.18023926  3.36387867  3.59342794     5
## 208     457             194  5.10170383  5.28137030  5.50595340     3
## 209     476               6 -1.80546562 -0.49897732  0.15973742   656
## 210     478             200  0.24253293  0.56906176  1.57808651    51
## 211     499             140  4.73335506  4.76027023  4.79391419     2
## 212     502              NA          NA          NA          NA     1
## 213     557             194  2.06475159  2.35263335  2.71248554     5
## 214     576               8 -0.41879594  0.23007358  0.89768104   276
## 215     578             200  0.76152566  1.71063789  2.32302771   353
## 216     595             170 -2.80666975 -2.71722349 -2.60541566     6
## 217     657             194 -2.47415941 -0.65315674  0.90070095   447
## 218     676               7 -1.69326862 -1.59509630 -1.19746124    19
## 219     678             200  0.15869851  1.04871433  1.52852751    15
## 220     757             194 -2.09211189 -0.38356447  1.23537809    54
## 221     778             200          NA          NA          NA     1
## 222     857             194  1.21204193  1.63445221  2.34423821    25
## 223     957             194  0.49751846  1.73838157  1.88239895    42
## 224     977              NA          NA          NA          NA     1
## 225    1010              NA 12.24725381 12.25685349 12.26885310    11
## 226    1013              NA          NA          NA          NA     1
## 227    1015              NA  7.54081679  8.42325842  8.74527780    20
## 228    1100              NA          NA          NA          NA     1
## 229    1101              45  1.54782471  2.54441424  3.26755659  7968
## 230    1102              79 -1.09395423  0.13762439  0.94244573  7038
## 231    1103             212  0.84855153  2.38267711  3.16965774 12693
## 232    1104              89 -0.60146438  0.10323285  0.57216777   760
## 233    1105              NA  6.77238869  7.15926635  7.91917486    18
## 234    1108              NA  6.49187387  6.56867385  6.66467383     5
## 235    1109             133 -0.15810906  0.59779848  1.09813480  5441
## 236    1110              74  1.80580043  2.62557483  3.20866635  5208
## 237    1115             216 -1.59053824 -0.71680604  2.39475088    18
## 238    1117             116  1.06454584  4.15830785  5.60984896   234
## 239    1121             191 -0.32103924  0.67773731  1.66124605    96
## 240    1122             185  2.35500393  3.27950825  3.83686721  3598
## 241    1124              26  1.19539298  2.00698947  2.91327382   174
## 242    1127             197  5.04723870  5.14748940  5.27280277     3
## 243    1128              NA  3.87848071  4.05896069  4.28456067     5
## 244    1129             210  2.94333738  5.05291260  6.30976670   194
## 245    1131             188 -2.35655290 -1.97064769 -1.80854942    25
## 246    1132              51  0.23732073  1.79058595  3.54337282   237
## 247    1135             147          NA          NA          NA     1
## 248    1139             127 -0.70220509 -0.17342586  0.48155794    30
## 249    1144             136  0.88977073  2.08149784  2.60327636   322
## 250    1148              NA  3.54115862  3.56386644  3.59225121     4
## 251    1152              55  1.07244981  1.74970169  2.45626967   117
## 252    1154              75  0.37449898  1.29887529  2.33327077   102
## 253    1155             107  1.57789214  2.53465633  3.73061156    10
## 254    1163              NA  2.78073970  3.39290130  3.76600032    38
## 255    1165             172  4.28503075  6.40518203  7.16273646   139
## 256    1166              89  0.53321138  1.74930249  2.30245819    82
## 257    1167              70  0.65681361  1.04760399  1.26270270    56
## 258    1170             215  3.84740070  3.90356066  3.96296063    14
## 259    1171             152  3.14323718  4.13020507  5.41532860   159
## 260    1172              NA  8.43878749 12.08186212 12.09660979    23
## 261    1173              NA  9.19538355  9.25442362  9.32822371     7
## 262    1175              NA          NA          NA          NA     1
## 263    1177              NA          NA          NA          NA     1
## 264    1188              NA  9.94750857  9.95033795  9.95387468     2
## 265    1189              71  7.49847886  7.69796589  7.94732467     2
## 266    1190              72  6.86737441  6.88004646  6.89588653     3
## 267    1315              NA          NA          NA          NA     1
## 268    1536              NA          NA          NA          NA     1
## 269    2101              48  0.73032706  1.64932001  2.25343332  1120
## 270    2102              80 -1.44653753 -0.27315776  0.32627225  2594
## 271    2103               9 -0.63452698  0.68168678  1.23216594   648
## 272    2104              28  1.82824305  3.90804432  5.04856429   608
## 273    2109             133  0.68217588  1.69243721  2.31829391  6410
## 274    2110              74 -1.81574993 -0.68472926  0.06121063   796
## 275    2115             216  6.49875852  6.66896695  6.72620694    19
## 276    2121             191 -5.23104696 -4.08806221 -3.28019050   224
## 277    2122             185 -0.37986651  0.36349610  0.87660533   639
## 278    2124              26  1.10955055  2.32492929  2.75035399  1237
## 279    2129              NA  4.54169821  5.08473921  5.76354047     6
## 280    2131             188 -2.48872495 -0.32128843  1.69111923    33
## 281    2132              51  0.37941921  1.12704437  1.58796392   323
## 282    2135             147 10.52951877 10.54083677 10.55498427     2
## 283    2138              21          NA          NA          NA     1
## 284    2144             136  0.95827862  2.12517730  2.82048443   693
## 285    2149              NA          NA          NA          NA     1
## 286    2152              NA  8.12000745  8.19216081  8.28235250     2
## 287    2155             108 -3.22161829 -3.19761828 -3.16761826    11
## 288    2162              92          NA          NA          NA     1
## 289    2163              NA 10.72268337 10.77420495 10.83860693     2
## 290    2171             152  5.69972238  6.71158455  7.41540756   894
## 291    3101              41  2.13350544  3.12096749  3.81038352  5398
## 292    3102              88 -0.09849627  1.16482878  1.54643304  1505
## 293    3103             201  1.22035755  2.26532966  2.94092917   331
## 294    3104              NA  0.20155957  1.16755283  1.65281682  1283
## 295    3105              NA          NA          NA          NA     1
## 296    3106              NA          NA          NA          NA     1
## 297    3109             133  3.84838669  4.26198532  4.39610976    38
## 298    3110              74 -3.47922017 -2.83627828 -1.38331879    77
## 299    3117              NA          NA          NA          NA     1
## 300    3121             191 -0.64775479  0.57970166  1.22683520  3888
## 301    3122             185 -3.97518691 -3.07660138 -1.65814373    72
## 302    3124              NA  0.43893216  0.81838243  1.29269527    10
## 303    3144             136 -0.68181360  0.64403065  1.21288678   309
## 304    3152              55  6.34619976  6.70396507  7.15117171     6
## 305    3155             109 -0.14653118  0.72686644  1.23154947  4482
## 306    3162              92          NA          NA          NA     1
## 307    4101              42  1.09363517  2.25670110  2.93901560  3768
## 308    4102              84  1.28601307  3.08709846  3.96470254  2275
## 309    4103             184 -0.73327690  0.53404507  1.42203834  4027
## 310    4104              70 -1.23898539  0.29415675  0.96495592  5462
## 311    4109             133  5.30013065  5.30722572  5.31609456     2
## 312    4117             116  4.43941057  4.81883732  5.29312076     6
## 313    4122             185  2.48007597  3.77253711  4.38487181   363
## 314    4144             136 -5.53037911 -3.59847753 -2.66620064    49
## 315    4155             111 -0.39015909  0.07635468  1.30458392    60
## 316    5101              47  2.20435373  3.71614855  4.45064914  2701
## 317    5102              82  0.73687184  1.60952290  2.35500509  3014
## 318    5103              70  0.51556530  1.46379495  1.91397494   118
## 319    5104              55  0.42641821  1.72490676  2.32247676   740
## 320    5122             185 -1.86988023  1.19629460  2.04821121   171
## 321    5144             136 -2.16410597 -0.75362873  0.08123995   665
## 322    5155              69 -3.20415552 -2.80666975 -2.36241404    22
## 323    6101              50  1.69624806  2.95144765  3.64449338  4543
## 324    6102              85  0.31872735  1.09822534  1.57053095   503
## 325    6103             212 -0.70873283  0.40120577  1.84814516   501
## 326    6104              22  1.23205135  1.60518868  2.59406959   111
## 327    6161              NA          NA          NA          NA     1
## 328    7101              44  1.66035198  5.27958925  6.39082341  1246
## 329    7103              52 -1.16080035  1.18841318  1.89739583   150
## 330    7104              75  1.03520591  2.05907191  2.64236009  1036
## 331    7155             112  5.14491109  5.85967689  6.87022342    55
## 332    8101              46 -0.95918663  0.23668954  0.72692802  1894
## 333    8103              70 -0.44840939  2.20721811  3.74683310    67
## 334    8104             146 -0.27536654  1.02814789  1.69042824   889
## 335    8155              99  3.72169450  3.85242844  4.01584585     5
## 336    9101              NA          NA          NA          NA     1
## 337    9103             201  1.87299777  3.37500752  4.22942427    84
## 338    9104             113 -0.89464862  0.86560138  2.17103208    95</code></pre>
<p>and for the moisture index:</p>
<pre><code>##     Species Species_medfate        q1        q5       q10     n
## 1         1             117 0.6710153 0.6869529 0.7068749     3
## 2         2              12 0.3960533 0.4702111 0.5096829  2846
## 3         3              96 0.5798634 0.8478652 0.9555154  1739
## 4         4             185 0.2737405 0.3277678 0.3625350  4339
## 5         5              91 0.4252543 0.5574783 0.5911608    54
## 6         6             142 0.3132141 0.4302611 0.4747681   691
## 7         7               2 0.3722758 0.6918796 1.0861895    34
## 8         8             151 0.3464240 0.4335886 0.4961623  1501
## 9         9              54 0.3912534 0.5061640 0.5573162  1175
## 10       11              10 0.3107655 0.3500523 0.3991608     6
## 11       12             137 0.3978744 0.4523490 0.5118654   232
## 12       13              35 0.2617801 0.3200041 0.3656939    70
## 13       14             204 0.5689523 0.6151078 0.7079665   100
## 14       15              58 0.4122130 0.4840790 0.6021805   168
## 15       16             172 0.4013782 0.5284312 0.5963197  1050
## 16       17              32 0.3613912 0.3653043 0.3802485    24
## 17       18              37 1.0950980 1.1592706 1.2256156    29
## 18       19              NA 0.7881925 0.8275235 0.8766872     2
## 19       20              NA 0.3451184 0.3523121 0.3613041     2
## 20       21             162 0.4152110 0.5072969 0.5522147  8581
## 21       22             163 0.5659495 0.6504180 0.8233257   596
## 22       23             160 0.2846748 0.3292874 0.3478037  3563
## 23       24             157 0.2022525 0.2480482 0.2750708 12050
## 24       25             158 0.3603467 0.4187458 0.4509169  7091
## 25       26             159 0.3319142 0.3719118 0.3996887 11536
## 26       27             156 0.4263586 0.4394872 0.4507848    14
## 27       28             161 0.6244461 0.9016842 1.0176103  1701
## 28       29              NA 0.3724618 0.4267130 0.4945270     8
## 29       31               0 0.8492485 1.1058487 1.2329757   381
## 30       32               1 0.8099230 0.9068635 0.9521639    78
## 31       33             155 0.5242599 0.6369706 0.7563591    28
## 32       34             171 0.4094868 0.4582800 0.4995391   103
## 33       35             130 0.4705158 0.5431476 0.8475315    74
## 34       36              62 0.2262555 0.2803555 0.3075682    81
## 35       37             125 0.3934471 0.4583065 0.4968691  6654
## 36       38             128 0.3213943 0.3529279 0.3780752  2166
## 37       39             127 0.2445112 0.2822671 0.3122397  4422
## 38       40              NA 0.6992819 0.7670581 0.8517783     6
## 39       41             181 0.7946874 0.9146477 1.0069352  6019
## 40       42             178 0.5265965 0.5916867 0.6452523  1345
## 41       43             180 0.3937824 0.4463383 0.4948926  6219
## 42       44             175 0.3569758 0.3960443 0.4215969  8049
## 43       45             176 0.2860409 0.3421569 0.3769090 26966
## 44       46             183 0.3583581 0.4300601 0.4688066  3744
## 45       47             173 0.5883949 0.7723644 0.8698687   314
## 46       48             182 0.8563527 1.1365185 1.2758278   105
## 47       49              NA 0.5575658 0.7131957 0.9077332    10
## 48       51             169 0.2689703 0.2821961 0.2907385   172
## 49       52             169 0.3197692 0.5228156 0.6163392   201
## 50       53             203 0.2167105 0.2720484 0.2800506   180
## 51       54              11 0.3905035 0.4902244 0.5980937   645
## 52       55              97 0.2910919 0.3689565 0.4076336   836
## 53       56             213 0.2800598 0.3142731 0.3564297   259
## 54       57             194 0.3360334 0.3991676 0.4493705   490
## 55       58             169 0.2653531 0.3078388 0.3502679   706
## 56       59              NA 0.6220999 0.6284386 0.6363619     3
## 57       60              90        NA        NA        NA     1
## 58       61              90 0.5196069 0.5944973 0.6406607  3469
## 59       62              90 0.2846824 0.3248749 0.3436366   891
## 60       63              90 0.2044905 0.2115748 0.3081266    17
## 61       64              90 0.5806108 0.7458253 0.8886328    28
## 62       65             121 0.5024171 0.6006150 0.6727555  2099
## 63       66             145 0.2723403 0.3206448 0.3600225  3282
## 64       67              36 0.2392697 0.3347684 0.3623724   535
## 65       68              18 0.2978981 0.3705454 0.4265164  3353
## 66       69             153 0.3654453 0.3852778 0.4013274    16
## 67       71              93 0.4814581 0.5915929 0.7041854  3962
## 68       72              31 0.5859108 0.7157575 0.8484187  3412
## 69       73              25 0.7737896 0.9423097 1.0534521   330
## 70       74              56 0.4910667 0.6621164 0.7629528  2083
## 71       75             123 0.3327650 0.3666233 0.4000060   190
## 72       76               3 0.4338065 0.5138593 0.5829606   965
## 73       77             211 0.5935005 0.6495417 0.6929086    62
## 74       78             200 0.5034788 0.6040949 0.6205147    63
## 75       79             167 0.4686172 0.5316857 0.5418314    58
## 76       83              79 0.6126981 0.6128733 0.6130924     2
## 77       89              NA        NA        NA        NA     1
## 78       91              27 0.3795484 0.4790223 0.5405748  4924
## 79       92             189 0.3652023 0.5041850 0.5876331   165
## 80       93             166 0.2781224 0.3418912 0.3671725   805
## 81       94             132 0.5229284 0.6419463 0.8825599   404
## 82       95             170 0.2743819 0.3766506 0.4359041   932
## 83       96             187 0.5072682 0.5080745 0.5090824     8
## 84       97             196 0.3582387 0.4540558 0.5335342   252
## 85       99              NA 0.2748167 0.3187531 0.3612933    57
## 86      101              41 0.2572073 0.3533546 0.4198043   779
## 87      102              79 0.3154952 0.3783503 0.4278505  4393
## 88      103              NA 0.2849214 0.3550313 0.3868147  1979
## 89      104              NA 0.2258898 0.2805824 0.3277793  2168
## 90      105             174 0.2230189 0.2686394 0.2947075  9566
## 91      106              29 0.3894658 0.4447604 0.5067210  5120
## 92      107              19 0.3073694 0.3890336 0.4217034  3315
## 93      108             186 0.9777780 1.2242025 1.3197037   165
## 94      109             133 0.2964399 0.3454579 0.3739529  5067
## 95      110              74 0.2727301 0.3126823 0.3395740  1652
## 96      111             165 0.2183097 0.2726237 0.3041622  7237
## 97      112             134 0.3692623 0.4697334 0.5192223  1273
## 98      113             150 0.2663206 0.3188860 0.3572337  4844
## 99      114             195 0.2095946 0.2620846 0.2901570 14389
## 100     115             216 0.3523759 0.4512454 0.5067072  2645
## 101     116              24 0.3346312 0.4188224 0.4731970  1585
## 102     117             116 0.2108545 0.2686880 0.3064074  5652
## 103     118              57 0.3231419 0.3786846 0.4295222   115
## 104     119             190 0.3475696 0.4125729 0.4620712 12139
## 105     120              73 0.4862097 0.8239931 0.9476127  4199
## 106     121             191 0.3542507 0.4761974 0.5505092 12582
## 107     122             185 0.1907728 0.2246864 0.2720501   611
## 108     123             218 0.3703484 0.3797833 0.3915770     2
## 109     124              26 0.2204389 0.2811870 0.3133211  1505
## 110     125              14 0.1790384 0.2001213 0.2122860   870
## 111     126              20 0.1939885 0.2358390 0.2688366   319
## 112     127             197 0.2660733 0.3079223 0.3425255  1145
## 113     128             119 0.2149885 0.2752517 0.3191543  4386
## 114     129             210 0.2193122 0.2784444 0.3134680 22309
## 115     130             193 0.3794092 0.4562675 0.5151769  2239
## 116     131             188 0.5423067 0.5839403 0.6149500    79
## 117     132              51 0.2972359 0.3907986 0.4583333   390
## 118     133              23 0.2029235 0.2166820 0.2478048    99
## 119     134             202 0.3674389 0.5016488 0.5571193   347
## 120     135             147 0.2029037 0.2520284 0.2847208   394
## 121     136              40 0.3831754 0.4138644 0.4714935  2138
## 122     137             214 0.5447735 0.6302582 0.7016684   832
## 123     138              21 0.2425564 0.3041570 0.3411692  4250
## 124     139              53 0.3542791 0.4661736 0.4948767   491
## 125     140             115 0.2104996 0.2500591 0.2653311  1528
## 126     141              NA 0.3995635 0.4953560 0.5356589  2621
## 127     142             118 0.2362016 0.2662453 0.2857305  3082
## 128     143             122 0.3348233 0.3781012 0.3922538   146
## 129     144             136 0.2948839 0.3743765 0.4234838  2648
## 130     145             139 0.2571183 0.2847131 0.3206385    16
## 131     146             143 0.2527639 0.3346864 0.3698560   225
## 132     147             148 0.2830203 0.3105110 0.3448743     7
## 133     148             170 0.3358373 0.4850230 0.5485983    28
## 134     149              NA 0.3429552 0.4189831 0.4684484  2338
## 135     150              13 0.4333255 0.4772960 0.5046743    15
## 136     151             209 0.2099854 0.2580918 0.2853535   415
## 137     152              55 0.2623253 0.3089920 0.3495463   354
## 138     153              63 0.2826783 0.2999620 0.3212633    60
## 139     154              75 0.2336372 0.2790232 0.3158479  3970
## 140     155             109 0.2601849 0.3066177 0.3475900  7690
## 141     156             146 0.2325453 0.2873290 0.3097793   130
## 142     157             212 0.2702465 0.3117496 0.3499960  1210
## 143     158             138        NA        NA        NA     1
## 144     159              20 0.6688011 0.6759460 0.6848771     2
## 145     160              38 0.4221572 0.4312693 0.4426594     3
## 146     161              77 0.3480294 0.3802237 0.4038055    14
## 147     162              92 0.2745275 0.3138367 0.3627709  1569
## 148     163             120 0.7302344 0.7391205 0.7502281     4
## 149     165             205 0.4216290 0.5449711 0.7622957   119
## 150     166             192 0.4808460 0.4872900 0.4953450     4
## 151     170              NA        NA        NA        NA     1
## 152     171             152 0.3706993 0.4818452 0.5398365   527
## 153     172              NA        NA        NA        NA     1
## 154     173              78 0.6265650 0.6350996 0.6457679     7
## 155     177             105        NA        NA        NA     1
## 156     179             207 0.2959035 0.3419020 0.3994002     6
## 157     181              95        NA        NA        NA     1
## 158     185              NA        NA        NA        NA     1
## 159     186              NA        NA        NA        NA     1
## 160     207               2 0.8234330 0.8590890 0.9451265    62
## 161     215              58 0.3651215 0.4297232 0.4846318  7266
## 162     217              33 0.7016399 0.7203357 0.7437056     2
## 163     219             206        NA        NA        NA     1
## 164     235             130 1.3037483 1.3667123 1.4454173    11
## 165     236              59 0.2640830 0.3161622 0.3579727    47
## 166     237             126 0.2365385 0.2821844 0.3157894 10922
## 167     239             127 0.4437225 0.4960792 0.5293052   277
## 168     243             179 0.4244396 0.4907269 0.5285452  1999
## 169     255              97 0.4529167 0.6110307 0.7053249   862
## 170     256             213 0.2920088 0.4306170 0.5435277    97
## 171     257             194 0.2494558 0.2905959 0.3160576   174
## 172     258             169 0.2646884 0.2883015 0.3078538   760
## 173     264              90 1.0875935 1.1078652 1.1332049     8
## 174     269             153 0.2022953 0.2127319 0.2431048    59
## 175     273              25 0.8333708 0.9497542 1.0284667  1667
## 176     275             123 0.3167769 0.3416530 0.3727481     4
## 177     276               4 0.3861823 0.4399648 0.4613445   511
## 178     277             211 0.5708742 0.6640237 0.8148677    37
## 179     278             200 0.5022602 0.5843260 0.6715423   935
## 180     279             167        NA        NA        NA     1
## 181     291              27 0.3224758 0.3233476 0.3488250    23
## 182     293             164 0.5120391 0.5174054 0.5241132     2
## 183     295             170 0.3760094 0.4119405 0.4583183  2698
## 184     297             196 0.4422616 0.5916090 0.7832355    28
## 185     299              94 0.2872720 0.3308583 0.3701137   114
## 186     307               2 0.5465521 0.7662117 0.8087940    62
## 187     315              58 0.4776814 0.7301705 1.1755858    32
## 188     317              34 0.3919056 0.3941738 0.3970090     6
## 189     319             208 0.5285291 0.5333931 0.5394731     3
## 190     335             130        NA        NA        NA     1
## 191     336              60 0.4365234 0.4412405 0.4471368     4
## 192     350              NA        NA        NA        NA     1
## 193     355              97 0.2987195 0.3135289 0.3339161    32
## 194     356             213 0.3621312 0.4265567 0.5070885     9
## 195     357             194 0.3487913 0.5029888 0.7447723   785
## 196     364              90 0.4003618 0.8789891 1.0203376    34
## 197     369              39 0.2903519 0.3716659 0.3930322   767
## 198     373              25 0.7741108 0.8710905 0.9768012   170
## 199     376               5 0.3075788 0.3423292 0.3977804    15
## 200     377             211 0.6087158 0.6443871 0.7242943    96
## 201     378             200 0.4399441 0.5205285 0.5833590   697
## 202     392             114 0.6405047 0.6432819 0.6467535     4
## 203     395             170 0.3742010 0.4663307 0.5211606   296
## 204     399             140 0.3118459 0.3139677 0.3166200     8
## 205     405              NA        NA        NA        NA     1
## 206     415              58 0.4600867 0.4771006 0.4825325    42
## 207     436              61 0.2910327 0.3047383 0.3218702     5
## 208     457             194 0.3433892 0.3439014 0.3445416     3
## 209     476               6 0.4718418 0.5432808 0.5856104   656
## 210     478             200 0.3429159 0.4207078 0.4474601    51
## 211     499             140 0.5251524 0.5261631 0.5274264     2
## 212     502              NA        NA        NA        NA     1
## 213     557             194 0.7849364 0.8352104 0.8980530     5
## 214     576               8 0.5903950 0.7049071 0.8068813   276
## 215     578             200 0.4649688 0.5178773 0.5641445   353
## 216     595             170 0.8676360 0.8891378 0.9160150     6
## 217     657             194 0.4250278 0.6023458 0.7692302   447
## 218     676               7 0.8427350 1.0462665 1.1145697    19
## 219     678             200 0.5771805 0.5809876 0.6491829    15
## 220     757             194 0.2761885 0.4344425 0.4841919    54
## 221     778             200        NA        NA        NA     1
## 222     857             194 0.3298340 0.3394290 0.3650120    25
## 223     957             194 0.2664949 0.2932753 0.3222981    42
## 224     977              NA        NA        NA        NA     1
## 225    1010              NA 0.5041636 0.5042616 0.5043841    11
## 226    1013              NA        NA        NA        NA     1
## 227    1015              NA 0.5224860 0.5387548 0.5527671    20
## 228    1100              NA        NA        NA        NA     1
## 229    1101              45 0.3126552 0.3522253 0.3849573  7968
## 230    1102              79 0.3549309 0.4372860 0.4890666  7038
## 231    1103             212 0.2972282 0.3743680 0.4267761 12693
## 232    1104              89 0.3346136 0.3857989 0.4203174   760
## 233    1105              NA 0.5561471 0.5768005 0.6214780    18
## 234    1108              NA 1.0857630 1.0974826 1.1121322     5
## 235    1109             133 0.2893827 0.3581679 0.3926170  5441
## 236    1110              74 0.2829585 0.3379086 0.3800384  5208
## 237    1115             216 0.5496328 0.5553640 0.5579475    18
## 238    1117             116 0.3082169 0.4405973 0.4643039   234
## 239    1121             191 0.3431429 0.3592329 0.4418783    96
## 240    1122             185 0.1987047 0.2364561 0.2608178  3598
## 241    1124              26 0.2560941 0.2925146 0.3470821   174
## 242    1127             197 0.2571100 0.2626973 0.2696813     3
## 243    1128              NA 0.6471702 0.6531557 0.6606376     5
## 244    1129             210 0.4358253 0.4717233 0.5029522   194
## 245    1131             188 0.5254418 0.5308735 0.5517369    25
## 246    1132              51 0.3310258 0.3858064 0.4323243   237
## 247    1135             147        NA        NA        NA     1
## 248    1139             127 0.3783595 0.4071227 0.4530934    30
## 249    1144             136 0.3107369 0.4110439 0.4507323   322
## 250    1148              NA 0.7916073 0.7917512 0.7919310     4
## 251    1152              55 0.2663398 0.2820054 0.2934102   117
## 252    1154              75 0.3673851 0.3881690 0.4030081   102
## 253    1155             107 0.4787092 0.5000280 0.5266765    10
## 254    1163              NA 0.3178540 0.4103844 0.5167786    38
## 255    1165             172 0.3409233 0.4323890 0.5349656   139
## 256    1166              89 0.2738239 0.2975974 0.3188785    82
## 257    1167              70 0.3241869 0.3870960 0.4267639    56
## 258    1170             215 0.7545483 0.8176470 0.8616696    14
## 259    1171             152 0.3211223 0.3670740 0.4159216   159
## 260    1172              NA 0.4872544 0.4968399 0.4973368    23
## 261    1173              NA 0.4973468 0.5174263 0.5425257     7
## 262    1175              NA        NA        NA        NA     1
## 263    1177              NA        NA        NA        NA     1
## 264    1188              NA 0.5548636 0.5549349 0.5550240     2
## 265    1189              71 0.6275187 0.6291013 0.6310797     2
## 266    1190              72 0.6416880 0.6421176 0.6426547     3
## 267    1315              NA        NA        NA        NA     1
## 268    1536              NA        NA        NA        NA     1
## 269    2101              48 0.3482015 0.3966102 0.4295197  1120
## 270    2102              80 0.3620077 0.3977825 0.4326980  2594
## 271    2103               9 0.3302883 0.3848702 0.4312030   648
## 272    2104              28 0.3519167 0.4315137 0.4881510   608
## 273    2109             133 0.3121347 0.3495867 0.3826779  6410
## 274    2110              74 0.4481814 0.5505699 0.5822685   796
## 275    2115             216 0.5709844 0.5842121 0.5964902    19
## 276    2121             191 0.2898904 0.3823146 0.4421399   224
## 277    2122             185 0.2868427 0.3613902 0.3879482   639
## 278    2124              26 0.2512824 0.2768240 0.2952378  1237
## 279    2129              NA 0.4968972 0.4972765 0.4977505     6
## 280    2131             188 0.4502173 0.5161987 0.5498783    33
## 281    2132              51 0.3947958 0.4591809 0.4988792   323
## 282    2135             147 0.6071369 0.6087569 0.6107818     2
## 283    2138              21        NA        NA        NA     1
## 284    2144             136 0.3001173 0.3539973 0.3856858   693
## 285    2149              NA        NA        NA        NA     1
## 286    2152              NA 0.4315669 0.4525066 0.4786813     2
## 287    2155             108 0.4141034 0.4862668 0.5764710    11
## 288    2162              92        NA        NA        NA     1
## 289    2163              NA 0.9178425 0.9238749 0.9314155     2
## 290    2171             152 0.3940634 0.4362308 0.5187150   894
## 291    3101              41 0.2217162 0.2701584 0.3117550  5398
## 292    3102              88 0.4188336 0.4892985 0.5564298  1505
## 293    3103             201 0.1916283 0.2072890 0.2216704   331
## 294    3104              NA 0.2153591 0.3056548 0.3284783  1283
## 295    3105              NA        NA        NA        NA     1
## 296    3106              NA        NA        NA        NA     1
## 297    3109             133 0.2550453 0.2590243 0.2621706    38
## 298    3110              74 0.4265814 0.5087916 0.5526139    77
## 299    3117              NA        NA        NA        NA     1
## 300    3121             191 0.3202402 0.4129103 0.4762798  3888
## 301    3122             185 0.3861775 0.4698156 0.5537944    72
## 302    3124              NA 0.3711702 0.3841110 0.4002870    10
## 303    3144             136 0.3201222 0.4066143 0.4399336   309
## 304    3152              55 0.3629936 0.3763280 0.3929960     6
## 305    3155             109 0.2577376 0.2936401 0.3347509  4482
## 306    3162              92        NA        NA        NA     1
## 307    4101              42 0.1920962 0.2364381 0.2619012  3768
## 308    4102              84 0.2570862 0.2880250 0.3167140  2275
## 309    4103             184 0.2556867 0.3174529 0.3434365  4027
## 310    4104              70 0.2818467 0.3617625 0.4108366  5462
## 311    4109             133 0.2907223 0.2909783 0.2912984     2
## 312    4117             116 0.4342027 0.4437314 0.4556422     6
## 313    4122             185 0.2089974 0.2658128 0.3386846   363
## 314    4144             136 0.3891984 0.4242570 0.5086165    49
## 315    4155             111 0.3076557 0.3220158 0.3422853    60
## 316    5101              47 0.2913874 0.3378696 0.3800019  2701
## 317    5102              82 0.4623702 0.5982126 0.6917245  3014
## 318    5103              70 0.2365771 0.3046889 0.5024233   118
## 319    5104              55 0.2109737 0.2403347 0.2597973   740
## 320    5122             185 0.2700534 0.3402315 0.3675707   171
## 321    5144             136 0.3751660 0.4270900 0.4778931   665
## 322    5155              69 0.4537628 0.5175324 0.5975736    22
## 323    6101              50 0.2835983 0.3787192 0.4249167  4543
## 324    6102              85 0.3751879 0.4061882 0.4299078   503
## 325    6103             212 0.2802487 0.3219960 0.3523918   501
## 326    6104              22 0.3590402 0.3784352 0.4055206   111
## 327    6161              NA        NA        NA        NA     1
## 328    7101              44 0.3520719 0.3936976 0.4390604  1246
## 329    7103              52 0.3208108 0.3609213 0.3969391   150
## 330    7104              75 0.2274820 0.3088370 0.3672763  1036
## 331    7155             112 0.3044380 0.4130947 0.4282434    55
## 332    8101              46 0.3608338 0.3908704 0.4004101  1894
## 333    8103              70 0.3058484 0.3544209 0.4113000    67
## 334    8104             146 0.2407896 0.2965902 0.3204099   889
## 335    8155              99 0.3434740 0.3520075 0.3626743     5
## 336    9101              NA        NA        NA        NA     1
## 337    9103             201 0.2037950 0.2531624 0.2755450    84
## 338    9104             113 0.3136899 0.3542263 0.6379863    95</code></pre>
<p>We now fill quantile output for PAR limits in a similar way. Here we focus on regeneration and shrub data tables only, because the adults in the plot may have recruited long ago, when light conditions in the ground where quite different:</p>
<div class="sourceCode" id="cb466"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">spUnique</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">sp</span> <span class="op">=</span> <span class="va">spUnique</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">ids_reg_par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">regFiltPAR</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">regFiltPAR</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="va">sp</span><span class="op">]</span><span class="op">)</span>
  <span class="va">ids_shrub_par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">shrubFiltPAR</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">shrubFiltPAR</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="va">sp</span><span class="op">]</span><span class="op">)</span>
  <span class="va">ids_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ids_reg_par</span>, <span class="va">ids_shrub_par</span><span class="op">)</span><span class="op">)</span>
  <span class="va">q_par</span><span class="op">[</span><span class="va">i</span>,<span class="fl">6</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ids_par</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ids_par</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">q_par</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">par_groundIFN3</span><span class="op">[</span><span class="va">ids_par</span><span class="op">]</span>, probs<span class="op">=</span><span class="va">probs</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>The resulting quantile table is:</p>
<pre><code>##     Species Species_medfate           q1            q5           q10    n
## 1         1             117 2.276716e-01  2.958253e-01  3.810174e-01    5
## 2         2              12 3.678022e-01  2.295688e+00  4.341381e+00  137
## 3         3              96 5.139115e-01  1.702036e+00  2.612455e+00   39
## 4         4             185 1.624146e+00  4.560687e+00  6.616915e+00   68
## 5         5              91           NA            NA            NA    0
## 6         6             142 2.488127e+00  2.648454e+00  1.482188e+01   17
## 7         7               2 1.723102e-01  8.615509e-01  1.723102e+00    2
## 8         8             151 6.412960e-01  1.475916e+00  2.301186e+00   88
## 9         9              54 9.722356e-01  1.554568e+00  2.403676e+00   24
## 10       11              10           NA            NA            NA    1
## 11       12             137 1.083898e+00  1.624444e+00  2.300126e+00    5
## 12       13              35 4.935984e+00  5.085126e+00  5.271553e+00    2
## 13       14             204 3.067143e-50  1.533572e-49  3.768128e-44   15
## 14       15              58 1.454455e+00  1.955274e+00  2.581298e+00   11
## 15       16             172 1.222452e+00  2.483835e+00  2.805605e+00   32
## 16       17              32           NA            NA            NA    0
## 17       18              37 0.000000e+00  0.000000e+00  0.000000e+00    7
## 18       19              NA           NA            NA            NA    0
## 19       20              NA           NA            NA            NA    1
## 20       21             162 1.447898e+00  4.633277e+00  7.324343e+00  679
## 21       22             163 1.407687e+00  3.082488e+00  5.810666e+00  336
## 22       23             160 4.460658e+00  1.085613e+01  1.972543e+01  243
## 23       24             157 3.703426e+00  1.831192e+01  2.522598e+01  169
## 24       25             158 2.722731e+00  6.122334e+00  8.277176e+00  208
## 25       26             159 1.819579e+00  6.724679e+00  1.021796e+01  461
## 26       27             156 0.000000e+00  0.000000e+00 2.506377e-180  544
## 27       28             161 1.882512e+00  2.265732e+00  2.690841e+00   13
## 28       29              NA           NA            NA            NA    0
## 29       31               0 9.653528e-02  4.201867e-01  6.962425e-01  153
## 30       32               1 5.917621e-02  2.958810e-01  5.917621e-01    2
## 31       33             155           NA            NA            NA    1
## 32       34             171 1.448088e-76  7.240438e-76  1.448088e-75    5
## 33       35             130           NA            NA            NA    1
## 34       36              62 2.123739e-07  1.061869e-06  2.123739e-06    6
## 35       37             125 8.355910e-01  3.134721e+00  5.183715e+00  786
## 36       38             128 1.500611e+00  3.402187e+00  8.624140e+00   47
## 37       39             127 1.043840e+00  2.189933e+00  3.909138e+00   51
## 38       40              NA           NA            NA            NA    0
## 39       41             181 3.722114e-26  4.714772e-01  1.722267e+00  118
## 40       42             178 2.301845e-02  6.533680e-01  9.807718e-01  130
## 41       43             180 6.410878e-01  2.286347e+00  3.764036e+00  919
## 42       44             175 4.438148e-01  3.610088e+00  6.708222e+00  395
## 43       45             176 1.785987e+00  5.781511e+00  1.061614e+01 2734
## 44       46             183 2.287644e+00  4.365935e+00  6.483573e+00  232
## 45       47             173 1.733055e+00  3.743227e+00  6.255943e+00    8
## 46       48             182           NA            NA            NA    1
## 47       49              NA           NA            NA            NA    0
## 48       51             169 1.337500e+01  1.475618e+01  1.650614e+01   12
## 49       52             169 2.859397e+00  3.706509e+00  4.765399e+00    8
## 50       53             203 2.630822e+00  5.646506e+00  6.879093e+00   50
## 51       54              11 1.266905e+01  1.578298e+01  1.967539e+01    5
## 52       55              97 3.251846e-01  8.341904e-01  1.960276e+00   41
## 53       56             213 2.197006e+00  2.463163e+00  2.795860e+00   11
## 54       57             194 6.820850e+00  1.135314e+01  1.360442e+01   16
## 55       58             169 1.059328e+01  1.360873e+01  1.838038e+01   27
## 56       59              NA           NA            NA            NA    0
## 57       60              90           NA            NA            NA    0
## 58       61              90 7.229843e-02  3.627151e-01  8.975169e-01   67
## 59       62              90 2.947016e-01  1.497661e+00  8.784380e+00   43
## 60       63              90           NA            NA            NA    0
## 61       64              90           NA            NA            NA    1
## 62       65             121 3.004377e-37  4.128518e-01  9.471804e-01  260
## 63       66             145 1.999239e+00  1.718563e+01  2.442721e+01   68
## 64       67              36 3.298904e+01  3.641557e+01  4.069873e+01    9
## 65       68              18 5.629060e-01  2.129869e+00  3.280497e+00  312
## 66       69             153           NA            NA            NA    1
## 67       71              93 1.103594e-01  6.494146e-01  1.132104e+00 1137
## 68       72              31 1.903318e-02  1.009703e+00  2.784308e+00  108
## 69       73              25 1.858920e+00  2.580204e+00  4.457615e+00   18
## 70       74              56 2.681420e-11  5.404989e-02  3.161634e-01  167
## 71       75             123 1.715442e+01  1.963803e+01  2.274255e+01    6
## 72       76               3 5.800070e-01  9.140698e-01  2.930601e+00   42
## 73       77             211 5.435257e+00  5.532240e+00  5.653469e+00    2
## 74       78             200 2.443205e-01  3.021775e-01  3.744987e-01    7
## 75       79             167 1.100805e+00  2.167263e+00  3.500335e+00    2
## 76       83              79 0.000000e+00  0.000000e+00 4.177296e-180  336
## 77       89              NA           NA            NA            NA    0
## 78       91              27 3.388671e-02  7.880828e-01  1.939084e+00  522
## 79       92             189 6.314167e+00  6.699678e+00  7.181568e+00    5
## 80       93             166 3.434311e+00  5.175962e+00  8.155388e+00   45
## 81       94             132 2.634999e+00  2.661876e+00  2.695473e+00    5
## 82       95             170 3.003276e-01  1.231417e+00  2.287820e+00   41
## 83       96             187           NA            NA            NA    0
## 84       97             196 2.393928e-01  1.196964e+00  2.483075e+00   12
## 85       99              NA 9.834763e+01  9.843330e+01  9.854039e+01    3
## 86      101              41 0.000000e+00 6.606715e-211  5.269637e-74  276
## 87      102              79 6.978101e-01  1.741508e+00  2.946223e+00  333
## 88      103              NA 2.972772e-01  3.865765e+00  7.954546e+00  335
## 89      104              NA 1.775527e-03  4.683690e-01  3.498422e+00  307
## 90      105             174 2.152646e+00  8.525611e+00  1.333726e+01  259
## 91      106              29 7.131509e-01  1.582043e+00  2.665361e+00  683
## 92      107              19           NA            NA            NA    0
## 93      108             186 3.820213e-01  1.022717e+00  1.985151e+00  154
## 94      109             133           NA            NA            NA    0
## 95      110              74 2.759411e-01  1.402946e+00  2.631588e+00  235
## 96      111             165           NA            NA            NA    0
## 97      112             134 1.548877e+00  2.076244e+00  2.834736e+00   37
## 98      113             150 2.276999e+00  4.855405e+00  8.314170e+00  319
## 99      114             195           NA            NA            NA    0
## 100     115             216 2.432004e-33  5.503545e-01  1.335076e+00  215
## 101     116              24           NA            NA            NA    0
## 102     117             116           NA            NA            NA    0
## 103     118              57           NA            NA            NA    0
## 104     119             190           NA            NA            NA    0
## 105     120              73           NA            NA            NA    0
## 106     121             191 9.455681e+00  9.930239e+00  1.052344e+01    3
## 107     122             185 9.774080e+00  1.469404e+01  1.958480e+01   16
## 108     123             218           NA            NA            NA    0
## 109     124              26           NA            NA            NA    0
## 110     125              14           NA            NA            NA    0
## 111     126              20           NA            NA            NA    0
## 112     127             197           NA            NA            NA    0
## 113     128             119           NA            NA            NA    0
## 114     129             210 1.096480e+00  6.743110e+00  1.096588e+01 1151
## 115     130             193           NA            NA            NA    0
## 116     131             188           NA            NA            NA    0
## 117     132              51           NA            NA            NA    0
## 118     133              23           NA            NA            NA    0
## 119     134             202           NA            NA            NA    0
## 120     135             147           NA            NA            NA    0
## 121     136              40           NA            NA            NA    0
## 122     137             214 2.682349e-01  6.744797e-01  1.144518e+00  381
## 123     138              21           NA            NA            NA    0
## 124     139              53 1.028482e+01  1.073117e+01  1.128911e+01    9
## 125     140             115           NA            NA            NA    0
## 126     141              NA 0.000000e+00  1.025480e-01  6.883840e-01  146
## 127     142             118           NA            NA            NA    0
## 128     143             122           NA            NA            NA    0
## 129     144             136 4.722548e-02  6.966788e-01  2.046045e+00  135
## 130     145             139           NA            NA            NA    0
## 131     146             143           NA            NA            NA    0
## 132     147             148           NA            NA            NA    0
## 133     148             170           NA            NA            NA    0
## 134     149              NA 6.013058e-02  8.407854e-01  2.285274e+00   69
## 135     150              13           NA            NA            NA    0
## 136     151             209           NA            NA            NA    0
## 137     152              55           NA            NA            NA    0
## 138     153              63 9.341335e+00  9.648770e+00  1.003306e+01    3
## 139     154              75 2.848076e+00  5.465006e+00  8.317617e+00   51
## 140     155             109           NA            NA            NA    0
## 141     156             146           NA            NA            NA    0
## 142     157             212           NA            NA            NA    0
## 143     158             138           NA            NA            NA    0
## 144     159              20           NA            NA            NA    0
## 145     160              38           NA            NA            NA    0
## 146     161              77           NA            NA            NA    0
## 147     162              92           NA            NA            NA    0
## 148     163             120           NA            NA            NA    0
## 149     165             205           NA            NA            NA    0
## 150     166             192           NA            NA            NA    0
## 151     170              NA           NA            NA            NA    0
## 152     171             152           NA            NA            NA    0
## 153     172              NA           NA            NA            NA    0
## 154     173              78           NA            NA            NA    0
## 155     177             105           NA            NA            NA    0
## 156     179             207           NA            NA            NA    0
## 157     181              95           NA            NA            NA    0
## 158     185              NA           NA            NA            NA    0
## 159     186              NA           NA            NA            NA    0
## 160     207               2 1.232439e+01  1.236678e+01  1.241978e+01    4
## 161     215              58 5.911856e-02  1.120838e+00  2.260814e+00  431
## 162     217              33           NA            NA            NA    0
## 163     219             206           NA            NA            NA    0
## 164     235             130           NA            NA            NA    0
## 165     236              59 1.116555e+00  5.581824e+00  1.116341e+01    3
## 166     237             126 2.021164e+00  5.538549e+00  8.673495e+00  257
## 167     239             127 9.721858e+00  1.095301e+01  1.257426e+01   26
## 168     243             179 8.924584e-01  2.444282e+00  3.986518e+00  214
## 169     255              97 1.833148e-03  1.012907e-02  5.700051e-01   38
## 170     256             213 2.898002e-01  3.505549e-01  4.264983e-01    7
## 171     257             194 5.891764e+01  6.067636e+01  6.287475e+01    3
## 172     258             169 2.341311e+01  3.235078e+01  4.361661e+01   96
## 173     264              90           NA            NA            NA    0
## 174     269             153           NA            NA            NA    1
## 175     273              25 2.259562e-01  7.996435e-01  9.376052e-01   64
## 176     275             123           NA            NA            NA    1
## 177     276               4 1.315388e+00  2.492790e+00  3.584284e+00   35
## 178     277             211 2.874981e-02  3.860350e-02  5.092062e-02    5
## 179     278             200 9.987306e-02  3.761458e-01  8.929076e-01  107
## 180     279             167           NA            NA            NA    0
## 181     291              27           NA            NA            NA    0
## 182     293             164           NA            NA            NA    0
## 183     295             170 1.391999e+00  3.670650e+00  5.953263e+00   87
## 184     297             196 3.282595e+00  3.468829e+00  3.701622e+00    7
## 185     299              94 1.577677e+01  1.776891e+01  2.025910e+01    5
## 186     307               2 4.799892e+00  5.074469e+00  5.417691e+00    8
## 187     315              58 3.833910e+00  4.156084e+00  4.558803e+00    3
## 188     317              34           NA            NA            NA    0
## 189     319             208           NA            NA            NA    0
## 190     335             130           NA            NA            NA    0
## 191     336              60           NA            NA            NA    0
## 192     350              NA           NA            NA            NA    0
## 193     355              97           NA            NA            NA    0
## 194     356             213           NA            NA            NA    0
## 195     357             194 5.170855e-01  1.150785e+00  1.804612e+00   12
## 196     364              90           NA            NA            NA    0
## 197     369              39 1.547829e+01  2.365826e+01  3.611649e+01   13
## 198     373              25 7.600780e-01  1.869516e+00  2.264729e+00   50
## 199     376               5           NA            NA            NA    1
## 200     377             211 6.656301e-01  1.217126e+00  1.906495e+00    4
## 201     378             200 3.582878e-03  2.309888e-01  6.993730e-01  172
## 202     392             114           NA            NA            NA    0
## 203     395             170 1.620363e-01  3.865124e-01  6.090276e-01   15
## 204     399             140           NA            NA            NA    1
## 205     405              NA           NA            NA            NA    0
## 206     415              58           NA            NA            NA    1
## 207     436              61           NA            NA            NA    0
## 208     457             194           NA            NA            NA    1
## 209     476               6 6.189356e-01  1.315438e+00  2.208093e+00   49
## 210     478             200           NA            NA            NA    0
## 211     499             140           NA            NA            NA    1
## 212     502              NA           NA            NA            NA    0
## 213     557             194           NA            NA            NA    0
## 214     576               8 1.535452e+00  2.217315e+00  3.069644e+00    8
## 215     578             200 5.958731e-01  9.522959e-01  1.220240e+00   16
## 216     595             170           NA            NA            NA    1
## 217     657             194 2.452067e-01  7.852603e-01  1.390883e+00   14
## 218     676               7 4.173671e-02  1.888657e-01  3.727770e-01    4
## 219     678             200           NA            NA            NA    1
## 220     757             194 1.431192e+00  2.256484e+00  3.288099e+00    5
## 221     778             200           NA            NA            NA    1
## 222     857             194 2.031833e+01  2.146447e+01  2.289715e+01    2
## 223     957             194 3.979092e+01  4.219694e+01  4.520446e+01    4
## 224     977              NA           NA            NA            NA    1
## 225    1010              NA           NA            NA            NA    0
## 226    1013              NA           NA            NA            NA    0
## 227    1015              NA           NA            NA            NA    0
## 228    1100              NA           NA            NA            NA    0
## 229    1101              45 5.383274e+00  1.245107e+01  1.858869e+01 1197
## 230    1102              79 4.826467e-01  1.613561e+00  2.712356e+00 1010
## 231    1103             212           NA            NA            NA    1
## 232    1104              89           NA            NA            NA    0
## 233    1105              NA 2.622239e+01  2.642597e+01  2.668045e+01    2
## 234    1108              NA           NA            NA            NA    0
## 235    1109             133           NA            NA            NA    0
## 236    1110              74 0.000000e+00  1.329976e-02  7.399005e+00  357
## 237    1115             216 4.598221e-02  1.471958e-01  2.489812e-01   53
## 238    1117             116           NA            NA            NA    0
## 239    1121             191           NA            NA            NA    0
## 240    1122             185 2.668647e+00  9.225053e+00  1.620370e+01   58
## 241    1124              26           NA            NA            NA    0
## 242    1127             197           NA            NA            NA    0
## 243    1128              NA           NA            NA            NA    0
## 244    1129             210 1.869848e+01  2.080452e+01  2.343708e+01    4
## 245    1131             188           NA            NA            NA    0
## 246    1132              51           NA            NA            NA    0
## 247    1135             147           NA            NA            NA    0
## 248    1139             127           NA            NA            NA    0
## 249    1144             136 2.844850e+00  3.198600e+00  3.348922e+00   18
## 250    1148              NA           NA            NA            NA    0
## 251    1152              55           NA            NA            NA    0
## 252    1154              75 1.776001e+00  1.964272e+00  2.199610e+00    3
## 253    1155             107           NA            NA            NA    0
## 254    1163              NA           NA            NA            NA    1
## 255    1165             172           NA            NA            NA    0
## 256    1166              89           NA            NA            NA    0
## 257    1167              70 3.686852e+01  3.700322e+01  3.717159e+01    2
## 258    1170             215           NA            NA            NA    0
## 259    1171             152           NA            NA            NA    0
## 260    1172              NA           NA            NA            NA    1
## 261    1173              NA           NA            NA            NA    0
## 262    1175              NA           NA            NA            NA    1
## 263    1177              NA           NA            NA            NA    0
## 264    1188              NA           NA            NA            NA    0
## 265    1189              71           NA            NA            NA    0
## 266    1190              72           NA            NA            NA    0
## 267    1315              NA           NA            NA            NA    0
## 268    1536              NA           NA            NA            NA    1
## 269    2101              48 9.808605e-01  4.763016e+00  8.310389e+00  123
## 270    2102              80 9.378176e-01  1.751081e+00  2.847422e+00  317
## 271    2103               9           NA            NA            NA    0
## 272    2104              28           NA            NA            NA    0
## 273    2109             133           NA            NA            NA    1
## 274    2110              74 4.380248e-04  4.397208e-01  7.624180e-01   91
## 275    2115             216           NA            NA            NA    0
## 276    2121             191           NA            NA            NA    0
## 277    2122             185 1.346795e+01  1.562705e+01  1.758500e+01   17
## 278    2124              26           NA            NA            NA    0
## 279    2129              NA           NA            NA            NA    0
## 280    2131             188           NA            NA            NA    0
## 281    2132              51           NA            NA            NA    0
## 282    2135             147           NA            NA            NA    0
## 283    2138              21           NA            NA            NA    0
## 284    2144             136 2.378764e+00  2.844782e+00  3.792113e+00   19
## 285    2149              NA           NA            NA            NA    0
## 286    2152              NA           NA            NA            NA    0
## 287    2155             108           NA            NA            NA    0
## 288    2162              92           NA            NA            NA    0
## 289    2163              NA           NA            NA            NA    0
## 290    2171             152           NA            NA            NA    0
## 291    3101              41 2.060614e+00  1.237700e+01  1.666716e+01  134
## 292    3102              88 1.823690e-01  8.518162e-01  2.115754e+00  147
## 293    3103             201           NA            NA            NA    0
## 294    3104              NA 8.515928e-01  3.614263e+00  4.795144e+00   80
## 295    3105              NA           NA            NA            NA    0
## 296    3106              NA           NA            NA            NA    0
## 297    3109             133           NA            NA            NA    0
## 298    3110              74 1.883699e+00  1.942803e+00  2.568418e+00   18
## 299    3117              NA           NA            NA            NA    0
## 300    3121             191 7.974687e-01  1.099091e+00  1.476119e+00    2
## 301    3122             185 9.620663e-01  1.780804e+00  2.804226e+00   11
## 302    3124              NA           NA            NA            NA    0
## 303    3144             136 1.220107e+00  3.050865e+00  5.052428e+00   12
## 304    3152              55           NA            NA            NA    0
## 305    3155             109           NA            NA            NA    0
## 306    3162              92           NA            NA            NA    0
## 307    4101              42 2.779004e+00  6.106247e+00  9.943655e+00   88
## 308    4102              84 2.987233e+00  4.911070e+00  6.582798e+00   29
## 309    4103             184           NA            NA            NA    0
## 310    4104              70 8.234540e-01  1.919789e+00  3.088000e+00  648
## 311    4109             133           NA            NA            NA    0
## 312    4117             116           NA            NA            NA    0
## 313    4122             185 2.882932e+01  2.970138e+01  3.079147e+01    2
## 314    4144             136 1.450702e+00  2.721887e+00  4.346346e+00   13
## 315    4155             111           NA            NA            NA    0
## 316    5101              47 9.054409e-39  1.497231e-06  1.646611e-01  403
## 317    5102              82 2.241324e-01  1.023369e+00  2.083259e+00  159
## 318    5103              70 4.444600e+00  4.592958e+00  5.921909e+00   14
## 319    5104              55           NA            NA            NA    0
## 320    5122             185 3.940745e+01  4.105197e+01  4.310762e+01    9
## 321    5144             136 3.864785e-03  5.730398e-01  1.898188e+00   36
## 322    5155              69 5.542927e+00  8.903099e+00  1.310332e+01    5
## 323    6101              50 1.315801e+00  4.548674e+00  7.371449e+00  396
## 324    6102              85 2.783167e+00  3.645281e+00  5.330417e+00   39
## 325    6103             212           NA            NA            NA    0
## 326    6104              22           NA            NA            NA    0
## 327    6161              NA           NA            NA            NA    0
## 328    7101              44 7.211899e+00  1.099491e+01  1.914959e+01  165
## 329    7103              52           NA            NA            NA    0
## 330    7104              75 7.626440e-01  2.892380e+00  3.506755e+00   21
## 331    7155             112           NA            NA            NA    0
## 332    8101              46 1.048705e+00  3.839325e+00  6.055393e+00  330
## 333    8103              70 6.256384e+00  8.589841e+00  1.150666e+01   11
## 334    8104             146           NA            NA            NA    0
## 335    8155              99           NA            NA            NA    0
## 336    9101              NA 0.000000e+00  9.430671e-84  3.171714e-18  197
## 337    9103             201           NA            NA            NA    0
## 338    9104             113           NA            NA            NA    0</code></pre>
<p>Store quantile tables:</p>
</div>
</div>
<div id="fill-medfate-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#fill-medfate-parameters" class="anchor"></a>Fill medfate parameters</h3>
<p>For each species in medfate we find the corresponding IFN species in the quantile tables. If the relationship is univocal, 1% quantile value of the IFN species is stored. If there are more than one IFN species for the target medfate species, we keep the weighted average of 1% quantile values, using the number of plots as weights.</p>
<div class="sourceCode" id="cb468"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">SPtarget</span> <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">SpIndex</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="co">#MinFPARRecr</span>
  <span class="va">r_sel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">q_par</span><span class="op">$</span><span class="va">Species_medfate</span><span class="op">==</span><span class="va">SPtarget</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r_sel</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">SpParams</span><span class="op">$</span><span class="va">MinFPARRecr</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">q_par</span><span class="op">$</span><span class="va">q1</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r_sel</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">n</span> <span class="op">=</span> <span class="va">q_par</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
    <span class="va">q1</span> <span class="op">=</span> <span class="va">q_par</span><span class="op">$</span><span class="va">q1</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
    <span class="va">q1</span> <span class="op">=</span> <span class="va">q1</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">]</span>
    <span class="va">n</span> <span class="op">=</span> <span class="va">n</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">]</span>
    <span class="va">SpParams</span><span class="op">$</span><span class="va">MinFPARRecr</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">q1</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="co">#MinTempRecr</span>
  <span class="va">r_sel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">q_tmin</span><span class="op">$</span><span class="va">Species_medfate</span><span class="op">==</span><span class="va">SPtarget</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r_sel</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">SpParams</span><span class="op">$</span><span class="va">MinTempRecr</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">q_tmin</span><span class="op">$</span><span class="va">q1</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r_sel</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">n</span> <span class="op">=</span> <span class="va">q_tmin</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
    <span class="va">q1</span> <span class="op">=</span> <span class="va">q_tmin</span><span class="op">$</span><span class="va">q1</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
    <span class="va">SpParams</span><span class="op">$</span><span class="va">MinTempRecr</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">q1</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="co">#MinMoistureRecr</span>
  <span class="va">r_sel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">q_ppet</span><span class="op">$</span><span class="va">Species_medfate</span><span class="op">==</span><span class="va">SPtarget</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r_sel</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">SpParams</span><span class="op">$</span><span class="va">MinMoistureRecr</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">q_ppet</span><span class="op">$</span><span class="va">q1</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">r_sel</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">n</span> <span class="op">=</span> <span class="va">q_ppet</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
    <span class="va">q1</span> <span class="op">=</span> <span class="va">q_ppet</span><span class="op">$</span><span class="va">q1</span><span class="op">[</span><span class="va">r_sel</span><span class="op">]</span>
    <span class="va">q1</span> <span class="op">=</span> <span class="va">q1</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span><span class="op">]</span>
    <span class="va">n</span> <span class="op">=</span> <span class="va">n</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span><span class="op">]</span>
    <span class="va">SpParams</span><span class="op">$</span><span class="va">MinMoistureRecr</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">q1</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<pre><code>## Warning in n * q1: longer object length is not a multiple of shorter object
## length

## Warning in n * q1: longer object length is not a multiple of shorter object
## length

## Warning in n * q1: longer object length is not a multiple of shorter object
## length

## Warning in n * q1: longer object length is not a multiple of shorter object
## length</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Miquel De Cáceres, Shengli Huang, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
