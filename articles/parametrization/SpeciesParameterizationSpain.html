<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Species parameterization for Spain • medfate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Species parameterization for Spain">
<meta property="og:description" content="medfate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../articles/index.html">Articles</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/emf-creaf/medfate/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="SpeciesParameterizationSpain_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Species parameterization for Spain</h1>
                        <h4 class="author">Miquel De Cáceres</h4>
            
            <h4 class="date">2021-07-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/master/vignettes/parametrization/SpeciesParameterizationSpain.Rmd"><code>vignettes/parametrization/SpeciesParameterizationSpain.Rmd</code></a></small>
      <div class="hidden name"><code>SpeciesParameterizationSpain.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette describes the procedures used to obtain the species parameter data table <code>SpParamsMED</code> included in package <strong>medfate</strong>. The taxon entities chosen are intended to cover most of the taxa reported in Spanish National Forest Inventory surveys (<em>Inventario Forestal Nacional</em> or IFN).</p>
<div id="required-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#required-packages" class="anchor"></a>Required packages</h3>
<p>Installed version of <strong>medfate</strong> should be <strong>ver 2.3</strong> or higher.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"medfate"</span><span class="op">)</span></code></pre></div>
<p>If the version at CRAN is older, the package should be installed from GitHub. Package <strong>medfateutils</strong> is important for the parametrization process, as it includes several functions useful for parsing data sources and populating parameter tables. Package <strong>medfateutils</strong> is installed only <code>from GitHub via</code>remotes::install_github()`.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"emf-creaf/medfateutils"</span><span class="op">)</span></code></pre></div>
<p>Once we have <strong>medfate</strong> and <strong>medfateutils</strong>, we load them as well as other packages needed for this vignette:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emf-creaf/medfate">medfate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">medfateutils</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="target-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#target-parameters" class="anchor"></a>Target parameters</h3>
<p>The set of species parameters needed to run the models included in <strong>medfate</strong> are described in a dataframe called <code>SpParamsDefinition</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"SpParamsDefinition"</span><span class="op">)</span>
<span class="va">SpParamsDefinition</span><span class="op">$</span><span class="va">ParameterName</span></code></pre></div>
<pre><code>##   [1] "Name"                 "IFNcodes"             "SpIndex"             
##   [4] "Genus"                "Order"                "Family"              
##   [7] "Group"                "GrowthForm"           "LifeForm"            
##  [10] "LeafShape"            "LeafSize"             "PhenologyType"       
##  [13] "Hmed"                 "Hmax"                 "Z50"                 
##  [16] "Z95"                  "fHDmin"               "fHDmax"              
##  [19] "a_ash"                "b_ash"                "a_bsh"               
##  [22] "b_bsh"                "a_btsh"               "b_btsh"              
##  [25] "cr"                   "a_fbt"                "b_fbt"               
##  [28] "c_fbt"                "d_fbt"                "a_cr"                
##  [31] "b_1cr"                "b_2cr"                "b_3cr"               
##  [34] "c_1cr"                "c_2cr"                "a_cw"                
##  [37] "b_cw"                 "LeafDuration"         "Sgdd"                
##  [40] "Tbgdd"                "Ssen"                 "Phsen"               
##  [43] "Tbsen"                "SLA"                  "LeafDensity"         
##  [46] "WoodDensity"          "FineRootDensity"      "conduit2sapwood"     
##  [49] "r635"                 "pDead"                "Al2As"               
##  [52] "LeafWidth"            "SRL"                  "RLD"                 
##  [55] "maxFMC"               "minFMC"               "LeafPI0"             
##  [58] "LeafEPS"              "LeafAF"               "StemPI0"             
##  [61] "StemEPS"              "StemAF"               "SAV"                 
##  [64] "HeatContent"          "LigninPercent"        "ParticleDensity"     
##  [67] "gammaSWR"             "alphaSWR"             "kPAR"                
##  [70] "g"                    "Tmax_LAI"             "Tmax_LAIsq"          
##  [73] "Psi_Extract"          "Psi_Critic"           "WUE"                 
##  [76] "pRootDisc"            "Gswmin"               "Gswmax"              
##  [79] "VCleaf_kmax"          "VCleaf_c"             "VCleaf_d"            
##  [82] "Kmax_stemxylem"       "VCstem_c"             "VCstem_d"            
##  [85] "Kmax_rootxylem"       "VCroot_c"             "VCroot_d"            
##  [88] "Narea"                "Vmax298"              "Jmax298"             
##  [91] "WoodC"                "RERleaf"              "RERsapwood"          
##  [94] "RERfineroot"          "RGRleafmax"           "RGRsapwoodmax"       
##  [97] "RGRfinerootmax"       "SeedProductionHeight" "RecrTreeDBH"         
## [100] "RecrTreeHeight"       "RecrShrubHeight"      "RecrTreeDensity"     
## [103] "RecrShrubCover"       "RecrZ50"              "RecrZ95"             
## [106] "MinTempRecr"          "MinMoistureRecr"      "MinFPARRecr"</code></pre>
<p>It is obvious that such a sheer number of parameters cannot be searched for manually. Hence, it is important to draw them for data bases. Not all model parameters have their counterpart in publicly-available databases, so even using trait data bases it is unlikely that one finds appropriate parameter values for all species. Luckily, <strong>medfate</strong> has inbuilt imputation procedures to estimate missing values for many parameters before starting model simulations. However, imputed parameter estimates will often be worse than estimates coming from data bases. Hence, we should put a strong effort in finding source parameter data before relying on inbuilt imputation.</p>
</div>
<div id="source-data-paths" class="section level3">
<h3 class="hasAnchor">
<a href="#source-data-paths" class="anchor"></a>Source data paths</h3>
<p>We begin by defining file paths (in my computer) to access source data for parameter filling. Source data includes forest inventory (i.e. IFN) data as well as trait and allometry data bases:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/Datasets/IFN/"</span>
<span class="va">DB_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/Professional/Recerca/MedfateSpeciesParametrization/"</span></code></pre></div>
</div>
<div id="steps-to-build-a-species-parameter-table" class="section level3">
<h3 class="hasAnchor">
<a href="#steps-to-build-a-species-parameter-table" class="anchor"></a>Steps to build a species parameter table</h3>
<p>The following sections describe different phases required to build a species parameter table for simulations with <strong>medfate</strong>:</p>
<ol style="list-style-type: decimal">
<li>Initialize the parameter table with target taxonomic entities.</li>
<li>Draw species parameters from forest inventory (IFN in our case) data.</li>
<li>Populate tree and shrub allometric coefficients from suitable allometric databases.</li>
<li>Populate plant functional traits from available data bases</li>
<li>Populate recruitment limits using bioclimatic data, forest inventory data and previous parameter estimates.</li>
</ol>
</div>
</div>
<div id="initialize-species-parameter-table-for-ifn" class="section level2">
<h2 class="hasAnchor">
<a href="#initialize-species-parameter-table-for-ifn" class="anchor"></a>Initialize species parameter table for IFN</h2>
<p>The first step to obtain a species parameter table is to define the target entities that will be considered functionally distinct in <strong>medfate</strong> simulations. There is no <em>a priori</em> need to limit such entities to species taxonomy, nor to particular taxonomic ranks. However, in our case we will define either entities either at species or genus level.</p>
<div id="load-ifn-taxonomic-codification" class="section level3">
<h3 class="hasAnchor">
<a href="#load-ifn-taxonomic-codification" class="anchor"></a>Load IFN taxonomic codification</h3>
<p>Model simulations will normally entail a resolution of target entities than forest inventory data. Therefore, it will be usual to lump entities treated as separated in the forest inventory. In our case, we begin by loading shrub and tree species codes used in the second, third, and fourth editions of IFN, i.e. IFN2, IFN3 and IFN4:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN23_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/SpeciesCodesIFN23.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN23_species_data</span><span class="op">&lt;-</span><span class="va">IFN23_species_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>

<span class="va">IFN4_shrub_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/shrubcodesifn4.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/treecodesifn4.txt"</span><span class="op">)</span>, 
                                    sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span><span class="op">&lt;-</span><span class="va">IFN4_tree_species_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Merge the two code data sets by adding to the codes of IFN2-3 those species codes that were new in IFN4:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newShrubs</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="op">(</span><span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">newTrees</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="op">(</span><span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">IFN23_species_data</span>, 
                              <span class="va">IFN4_shrub_species_data</span><span class="op">[</span><span class="va">newShrubs</span>, <span class="op">]</span>, 
                              <span class="va">IFN4_tree_species_data</span><span class="op">[</span><span class="va">newTrees</span>,<span class="op">]</span><span class="op">)</span>
<span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="va">IFN_species_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<p>The final table of species names and codes is:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 411   2</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>##   IFNCODE               IFNNAME
## 1       1 Heberdenia bahamensis
## 2       2    Amelanchier ovalis
## 3       3        Frangula alnus
## 4       4     Rhamnus alaternus
## 5       5    Euonymus europaeus
## 6       6       Myrtus communis</code></pre>
</div>
<div id="define-ifn-codes-to-exclude" class="section level3">
<h3 class="hasAnchor">
<a href="#define-ifn-codes-to-exclude" class="anchor"></a>Define IFN codes to exclude</h3>
<p>We used the word ‘species’ for IFN entities, but in fact not all IFN entities are binomial species. In some cases, subspecies are recorded, while in others identification is at genus level or even uses non-scientific names. We thus need to manually define a set of entities (IFN codes) to be excluded because they have low taxonomic content or refer to unsuitable growth forms (vines):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">codesOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"19"</span>, <span class="co"># Otras coniferas </span>
              <span class="st">"10"</span>, <span class="co"># Sin asignar</span>
              <span class="st">"20"</span>, <span class="co"># Pinos</span>
              <span class="st">"29"</span>, <span class="co"># Otros pinos</span>
              <span class="st">"30"</span>,  <span class="co">#Mezcla de coniferas</span>
              <span class="st">"40"</span>, <span class="co">#Quercus</span>
              <span class="st">"49"</span>, <span class="co">#Otros quercus</span>
              <span class="st">"50"</span>, <span class="co">#Mezcla de &lt;e1&gt;rboles de ribera</span>
              <span class="st">"59"</span>, <span class="co">#Otros &lt;e1&gt;rboles rip&lt;ed&gt;colas</span>
              <span class="st">"70"</span>, <span class="co">#Mezcla de frondosas de gran porte</span>
              <span class="st">"80"</span>, <span class="co">#Laurisilva</span>
              <span class="st">"89"</span>, <span class="co">#Otras laurisilvas</span>
              <span class="st">"90"</span>, <span class="co">#Mezcla de peque&lt;f1&gt;as frondosas</span>
              <span class="st">"99"</span>, <span class="co">#Otras frondosas</span>
              <span class="st">"1500"</span>, <span class="co"># Cultivo en mosaico</span>
              <span class="st">"8000"</span>, <span class="co"># Matorral en mosaico</span>
              <span class="st">"9000"</span>, <span class="co">#Herbazal en mosaico</span>
              <span class="st">"3400"</span>, <span class="co">#Prado en mosaico</span>
              <span class="st">"3500"</span>, <span class="co">#Pastizal-Matorral en mosaico</span>
              <span class="st">"103"</span>, <span class="co">#Otras papilionoideas altas</span>
              <span class="st">"104"</span>, <span class="co">#Otras papilionoideas bajas</span>
              <span class="st">"3104"</span>, <span class="co">#Genista (H.t.&lt;1,5 m)</span>
              <span class="st">"141"</span>, <span class="co">#Hedera helix</span>
              <span class="st">"149"</span> <span class="co">#Smilax aspera</span>
              <span class="op">)</span></code></pre></div>
<p>Remove taxa from the IFN taxonomic definition data frame:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="va">IFN_species_data</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">codesOut</span><span class="op">)</span>, <span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 387   2</code></pre>
</div>
<div id="define-taxonomic-entities-to-merge-into-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#define-taxonomic-entities-to-merge-into-groups" class="anchor"></a>Define taxonomic entities to merge into groups</h3>
<p>Initialization will normally require defining groups of entities to be treated together in <strong>medfate</strong>. In our case, we need to define genus-level groups. These are necessary for taxa where the forest inventory records do not always have identifications at species-level resolution:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genus_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Acacia spp.:7/207/307"</span>,
                 <span class="st">"Adenocarpus spp.:2103/3163"</span>,
                 <span class="st">"Atriplex spp.:133"</span>,
                 <span class="st">"Artemisia spp.:126/159/1159"</span>,
                 <span class="st">"Asparagus spp.:138/1138/2138"</span>,
                 <span class="st">"Astragalus spp.:6104"</span>,
                 <span class="st">"Betula spp.:73/273/373"</span>,
                 <span class="st">"Bupleurum spp.:124/1124/2124"</span>,
                 <span class="st">"Calicotome spp.:2104/2105/9072"</span>,
                 <span class="st">"Chamaerops humilis:369/3690"</span>,
                 <span class="st">"Clematis spp.:132/1132/2132"</span>,
                 <span class="st">"Crataegus spp.:15/215/315/415/515"</span>,
                 <span class="st">"Coronilla spp.:152/1152/3152/5104"</span>,
                 <span class="st">"Cotoneaster spp.:118"</span>,
                 <span class="st">"Daphne spp.:110/1110/2110/3110"</span>,
                 <span class="st">"Dorycnium spp.:154/7104/1154"</span>,
                 <span class="st">"Echium sp.:161"</span>,
                 <span class="st">"Erinacea spp.:1104/1166"</span>,
                 <span class="st">"Eucalyptus spp.:60/61/62/63/64/264/364/464"</span>,
                 <span class="st">"Euphorbia spp.:162/1162/2162/3162"</span>,
                 <span class="st">"Fraxinus spp.:55/255/355/455"</span>,
                 <span class="st">"Genistella spp.:9104"</span>,
                 <span class="st">"Helianthemum spp.:142"</span>,
                 <span class="st">"Helichrysum spp.:128/2128"</span>,
                 <span class="st">"Larix spp.:35/235/335/435"</span>,
                 <span class="st">"Lavandula spp.:109/1109/2109/3109/4109"</span>,
                 <span class="st">"Lonicera spp.:144/1144/2144/3144/4144/5144/9012"</span>,
                 <span class="st">"Halimium spp.:117/1117/4117/5117/6117"</span>,
                 <span class="st">"Ilex spp.:65/82/282"</span>,
                 <span class="st">"Juglans spp.:75/275"</span>,
                 <span class="st">"Morus spp.:399/499/599"</span>,
                 <span class="st">"Ononis spp.:156/8104"</span>,
                 <span class="st">"Osyris spp.:135/1135/2135"</span>,
                 <span class="st">"Platanus spp.:79/279"</span>,
                 <span class="st">"Populus spp.:51/52/58/258"</span>,
                 <span class="st">"Phlomis spp.:171/1171/2171"</span>,
                 <span class="st">"Phoenix spp.:69/269/469"</span>,
                 <span class="st">"Prunus spp.:95/295/395/495/595/1095/1195/2950/148"</span>,
                 <span class="st">"Pyrus spp.:16/1165/2165"</span>,
                 <span class="st">"Retama spp.:4103"</span>,
                 <span class="st">"Rhamnus spp.:4/122/1122/2122/3122/4122/389/5122/6122"</span>,
                 <span class="st">"Rhododendron spp.:108"</span>,
                 <span class="st">"Ribes spp.:131/1131/2131"</span>,
                 <span class="st">"Rosa spp.:119"</span>,
                 <span class="st">"Rubus spp.:121/1121/2121/3121"</span>,
                 <span class="st">"Salix spp.:57/257/357/457/557/657/757/857/858/957"</span>,
                 <span class="st">"Sambucus spp.:97/197/297/2970"</span>,
                 <span class="st">"Santolina spp.:127/1127/2127"</span>,
                 <span class="st">"Sorbus spp.:78/278/378/478/578/678/778"</span>,
                 <span class="st">"Spartium spp.:3103/9103"</span>,
                 <span class="st">"Spiraea spp.:134/1134"</span>,
                 <span class="st">"Tamarix spp.:53/253"</span>,
                 <span class="st">"Teline spp.:165/9077/9078/9202"</span>,
                 <span class="st">"Teucrium spp.:179/1179"</span>,
                 <span class="st">"Tilia spp.:77/277/377"</span>,
                 <span class="st">"Thymelaea spp.:151"</span>,
                 <span class="st">"Thuja spp.:319"</span>,
                 <span class="st">"Thymus spp.:129/1129"</span>,
                 <span class="st">"Ulex spp.:157/1103/6103/3164"</span>,
                 <span class="st">"Ulmus spp.:56/256/356/456"</span>,
                 <span class="st">"Vaccinium spp.:137/1137"</span>,
                 <span class="st">"Viburnum spp.:115/1115/4115/3115/2115"</span>
                 <span class="op">)</span></code></pre></div>
<p>Groups were manually defined as strings where ‘:’ was used to separate the group name from the set of codes forming the group, which were separated using ‘/’. We also define groups of taxa at species level, where different synonyms are merged, different codes have been used for the same species or the species have subspecies entities which we want to merge:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assimilated_species</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Acer campestre:76/776"</span>,
                       <span class="st">"Amelanchier ovalis:2/200"</span>,
                       <span class="st">"Buxus sempervirens:91/291/2910/9071/9100"</span>,
                       <span class="st">"Cistus albidus:101/3101"</span>,
                       <span class="st">"Cornus sanguinea:9/900"</span>,
                       <span class="st">"Cytisus fontanesii:9074"</span>,
                       <span class="st">"Cytisus scoparius:4104/1167/5103/8103"</span>,
                       <span class="st">"Cytisus commutatus:9011/9201/9481"</span>,
                       <span class="st">"Cytisus oromediterraneus:5155/4167"</span>,
                       <span class="st">"Erica scoparia:283/6102"</span>,
                       <span class="st">"Erica arborea:83/102/1102"</span>,
                       <span class="st">"Euonymus europaeus:5/500"</span>,
                       <span class="st">"Frangula alnus:3/300"</span>,
                       <span class="st">"Genista horrida:177"</span>, <span class="co"># Echinospartum horridum -&gt; Genista horrida</span>
                       <span class="st">"Genista cinerea:8155/1355"</span>,
                       <span class="st">"Genista scorpius:155/3155"</span>,
                       <span class="st">"Juniperus communis:37/3700"</span>,
                       <span class="st">"Juniperus phoenicea:39/238/239/1139"</span>,
                       <span class="st">"Medicago arborea:145/9076"</span>,
                       <span class="st">"Myrtus communis:6/600"</span>,
                       <span class="st">"Myrica faya:81/281"</span>,
                       <span class="st">"Pistacia terebinthus:93/9300"</span>,
                       <span class="st">"Quercus ilex:45/245"</span>,
                       <span class="st">"Quercus faginea:44/344"</span>,
                       <span class="st">"Quercus suber:46/646/746/846/946"</span>,
                       <span class="st">"Salvia rosmarinus:114"</span><span class="op">)</span> <span class="co"># Rosmarinus officinalis -&gt; Salvia rosmarinus</span></code></pre></div>
<p>We now build a data frame with group names and codes, by merging the information of these two groups. We now separate group names and the set of codes defining the group:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">groups_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">genus_level</span>,
                                     <span class="va">assimilated_species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">separate</span><span class="op">(</span><span class="st">"Groups"</span>, into<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group_names"</span>, <span class="st">"group_codes"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">":"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">groups_df</span><span class="op">)</span></code></pre></div>
<pre><code>##        group_names   group_codes
## 1      Acacia spp.     7/207/307
## 2 Adenocarpus spp.     2103/3163
## 3    Atriplex spp.           133
## 4   Artemisia spp.  126/159/1159
## 5   Asparagus spp. 138/1138/2138
## 6  Astragalus spp.          6104</code></pre>
</div>
<div id="initialize-species-parameter-table" class="section level3">
<h3 class="hasAnchor">
<a href="#initialize-species-parameter-table" class="anchor"></a>Initialize species parameter table</h3>
<p>Once we have IFN species names and codes, as well the definition of IFN entities to merge, we can call function <code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams()</a></code> from package <strong>medfateutils</strong>. This function also takes the data frame <code>SpParamsDefinition</code> as argument, from which it takes the set of parameter names to be filled:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span>, <span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNNAME</span>,
                        <span class="va">SpParamsDefinition</span>,
                        <span class="va">groups_df</span><span class="op">$</span><span class="va">group_codes</span>, <span class="va">groups_df</span><span class="op">$</span><span class="va">group_names</span>,
                        fill_taxonomic <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Option <code>fill_taxonomic</code> tells function <code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams()</a></code> to use package <strong>taxize</strong> to find taxonomic classification of the species/genus entities.</p>
<p>The result of calling <code><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams()</a></code> is a data frame with as many rows as target entities and columns corresponding to the parameters defined in <code>SpParamsDefinition</code>. Most parameters are missing, obviously, but the function already filled taxonomic data:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##                  Name  IFNcodes SpIndex  Genus      Order      Family
## 1          Abies alba        31       0  Abies    Pinales    Pinaceae
## 2       Abies pinsapo        32       1  Abies    Pinales    Pinaceae
## 3         Acacia spp. 7/207/307       2 Acacia    Fabales    Fabaceae
## 4      Acer campestre    76/776       3   Acer Sapindales Sapindaceae
## 5 Acer monspessulanum       276       4   Acer Sapindales Sapindaceae
## 6        Acer negundo       376       5   Acer Sapindales Sapindaceae
##        Group
## 1 Gymnosperm
## 2 Gymnosperm
## 3 Angiosperm
## 4 Angiosperm
## 5 Angiosperm
## 6 Angiosperm</code></pre>
</div>
</div>
<div id="parameters-drawn-from-ifn-data" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-drawn-from-ifn-data" class="anchor"></a>Parameters drawn from IFN data</h2>
<p>Some plant size parameters, such as maximum height or minimum/maximum values of the height-to-diameter ratio, can be derived from forest inventory data. In addition, it is important that medfate’s growth form (either tree or shrub) matches the treatment given in forest inventory surveys. Diameters are normally measured in ‘tree’ entities, whereas shrubs are often measured using cover indices. Thus, the growth form parameter should also be derived from forest inventory.</p>
<div id="load-ifn-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-ifn-data" class="anchor"></a>Load IFN data</h3>
<p>We first load IFN tree and shrub data corresponding to the three surveys (tree data is in two different tables in the case of IFN2):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrubDataIFN2</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/shrubDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">shrubDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">shrubDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>
<span class="va">shrubDataIFN3</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/shrubDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">shrubDataIFN4</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN4/Rdata/shrubDataIFN4_Spain.rds"</span><span class="op">)</span><span class="op">)</span>

<span class="va">piesMayoresDataIFN2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/piesMayoresDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/piesMenoresDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">ID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">Species</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">treeDataIFN3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/treeDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">treeDataIFN4</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN4/Rdata/treeDataIFN4_Spain.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We merge the data sets into two tables, one for shrubs and the other for trees, taking only columns <code>ID</code> (plot identification), <code>Species</code> (code), <code>H</code> (height) and <code>DBH</code> (for trees).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrubDataIFN</span> <span class="op">&lt;-</span><span class="fu">bind_rows</span><span class="op">(</span><span class="va">shrubDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span>,
                         <span class="va">shrubDataIFN3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span>,
                         <span class="va">shrubDataIFN4</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="va">treeDataIFN</span> <span class="op">&lt;-</span><span class="fu">bind_rows</span><span class="op">(</span><span class="va">piesMayoresDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">piesMenoresDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">treeDataIFN3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">treeDataIFN4</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
<div id="growth-form" class="section level3">
<h3 class="hasAnchor">
<a href="#growth-form" class="anchor"></a>Growth form</h3>
<p>To tell medfate which target entities are shrubs, trees (or both, since some species occur in both tree and shrub tables), we can simply take the species code vectors:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">tree_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></code></pre></div>
<p>Before populating growth form, we can check how many species appear both as trees and shrubs:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">shrub_codes</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">tree_codes</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>We can populate column <code>GrowthForm</code> of the species parameter table by calling function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateGrowthForm()</a></code> of package <strong>medfateutils</strong>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateGrowthForm</a></span><span class="op">(</span><span class="va">SpParams</span>, 
                              <span class="va">tree_codes</span>, <span class="va">shrub_codes</span>,
                              fill_fromGenus <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##  Tree: 75 shrub: 107 tree/shrub: 27 not found: 10</code></pre>
<pre><code>##  Tree input codes not in SpParams: 99,90,29,59,89,19,49</code></pre>
<pre><code>##  Shrub input codes not in SpParams: 103,104,224,222,192,100,99,10,199,229,402,302,141,149,1163,186,185,3104,0,1108,1105,3124,2163,2152,1172,1128,6161,3106,1013,1100,502,1148,1177,2129,172,1175,3117,1015,1188,1315,1010,1173,9101,3105,2149,405,1536,170,9262,9264,4156,174,9284,9282,2164,400,180,8010,8005,8007,1709,1706,1704,1707,9914,1710,1708,2509,2507,2502,2506,2505,9006</code></pre>
<pre><code>## Species 'Cistus creticus' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Cytisus commutatus' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Cytisus fontanesii' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista anglica' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista dorycnifolia' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista hystrix' assigned growth form 'Shrub'</code></pre>
<p>Some codes (particularly, those excluded above) may not be recognized according to the target entity definition of <code>SpParams</code> and are ignored. The option <code>fill_fromGenus = TRUE</code> is used to tell function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateGrowthForm()</a></code> that all species of the same entity should have the same growth form, so that even if some codes are not mentioned, for whatever reason, growth forms are also defined. Some species may have been defined in the IFN species definition but then be missing from the tree/shrub tables. We identify them and manually set to tree the growth form of these:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">missingGrowthFormSpecies</span> <span class="op">=</span> <span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">missingGrowthFormSpecies</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Dracaena drago"         "Pleiomeris canariensis" "Quercus lusitanica"    
## [4] "Sideroxylon marmulano"</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="va">missingGrowthFormSpecies</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Tree"</span></code></pre></div>
</div>
<div id="maximummedian-height" class="section level3">
<h3 class="hasAnchor">
<a href="#maximummedian-height" class="anchor"></a>Maximum/median height</h3>
<p>Maximum and median heights for each target entity can be obtained from observed height distributions. Thus, we define species identity and height (in cm) vectors from tree/shrub data:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">species_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span>, <span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">height_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">H</span>, <span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">H</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span> <span class="co"># m to cm</span></code></pre></div>
<p>and then call function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateHeightParams()</a></code> to populate parameters <code>Hmax</code> and <code>Hmed</code>, corresponding to maximum and median heights.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateHeightParams</a></span><span class="op">(</span><span class="va">SpParams</span>,
                                 <span class="va">species_codes</span>, <span class="va">height_values</span><span class="op">)</span></code></pre></div>
<pre><code>## 162390 species/height missing values removed from input.</code></pre>
<pre><code>## 17511 zero height values removed from input.</code></pre>
<pre><code>## 10 missing Hmed/Hmax values (out of 219) after populating with input data.</code></pre>
<p>By default, maximum height is defined as the 99% quantile of the height distribution, whereas median height corresponds to the 50% quantile.</p>
<p>Parameters <code>Hmax</code> and <code>Hmed</code> are strict, meaning that medfate does not have inbuilt imputation procedures for them, so we must complete their columns in the parameter table. We can inspect the missing values for each growth form:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   107   75         27
##   TRUE      6    4          0</code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   107   75         27
##   TRUE      6    4          0</code></pre>
<p>and then use the species with known values for each growth from to impute species averages:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="diameterheight-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#diameterheight-ratio" class="anchor"></a>Diameter/height ratio</h3>
<p>Minimum and maximum diameter/height ratios are used in medfate to translate diameter growth into height growth. We first assemble three data vectors needed to populate these parameters (heights and diameters in cm):</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tree_species_codes</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span>
<span class="va">tree_height_values</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">H</span><span class="op">*</span><span class="fl">100</span> <span class="co"># m to cm</span>
<span class="va">tree_diameter_values</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">DBH</span></code></pre></div>
<p>and then call function <code><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateTreeDiameterHeightParams()</a></code> from package <strong>medfateutils</strong>:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateTreeDiameterHeightParams</a></span><span class="op">(</span><span class="va">SpParams</span>,
                                             <span class="va">tree_species_codes</span>, 
                                             <span class="va">tree_height_values</span>,
                                             <span class="va">tree_diameter_values</span><span class="op">)</span></code></pre></div>
<pre><code>## 162374 species/height/diameter missing values removed from input.</code></pre>
<pre><code>## 17481 zero height/diameter values removed from input.</code></pre>
<pre><code>## 4 missing fHDmin/fHDmax values (out of 106 tree species) after populating with input data.</code></pre>
<p>This function fills parameters <code>fHDmin</code> and <code>fHDmax</code>, corresponding to the minimum and maximum values of the height-to-diameter ratio. The 5% and 95% quantile values are used for these parameters, respectively, by default.</p>
<p>Missing values may occur after imputation:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE     0   75         27
##   TRUE    113    4          0</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE     0   75         27
##   TRUE    113    4          0</code></pre>
<p>Since <code>fHDmin</code> and <code>fHDmax</code> are strict parameters, we use shrub and tree averages to fill the remaining cases:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="allometric-coefficients" class="section level2">
<h2 class="hasAnchor">
<a href="#allometric-coefficients" class="anchor"></a>Allometric coefficients</h2>
<div id="shrub-allometric-equations" class="section level3">
<h3 class="hasAnchor">
<a href="#shrub-allometric-equations" class="anchor"></a>Shrub allometric equations</h3>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">medfuels</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_area"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_fine"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_total"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_area"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_fine"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_total"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"species_groups"</span><span class="op">)</span></code></pre></div>
<p>Correct synonymy mistakes</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"Genus"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Salvia"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"Species"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"rosmarinus"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"author"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Schleid."</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"name"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Salvia rosmarinus"</span>

<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"Genus"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Lithodora"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"Species"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"fruticosa"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"author"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"(L.) Griseb."</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"name"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Lithodora fruticosa"</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_sel</span> <span class="op">&lt;-</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">retrieveCoefficientsFromMedfuels</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">sp_params_allom</span>, <span class="va">group_params_allom</span>, <span class="va">species_groups</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">a_coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">b_coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">sp_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">)</span>
  <span class="va">gr_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">)</span>
  <span class="va">gen_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span>, <span class="va">species_groups</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
  <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">growth_form</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="va">nshrub</span> <span class="op">+</span><span class="fl">1</span>
      <span class="va">nm</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
      <span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">nm</span>,<span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
      <span class="kw">if</span><span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">sp_allom</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species-specific allometry available</span>
        <span class="va">sp_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sp_allom</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">gen_sp</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species is found in medfuels species table</span>
        <span class="va">form_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gen_sp</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
        <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="va">form_raunkiaer</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">gen</span> <span class="op">%in%</span> <span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If genus occurs in medfuels table</span>
        <span class="va">forms_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">==</span><span class="va">gen</span><span class="op">)</span><span class="op">]</span>
        <span class="co"># Find most-frequent  raunkiaer form</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">forms_raunkiaer</span><span class="op">)</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="va">tfr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">tfr</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>
        <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
        <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="va">nmis</span> <span class="op">+</span> <span class="fl">1</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span><span class="op">==</span><span class="st">"Tree/Shrub"</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If tree/shrub assing MPh data</span>
          <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved and will be assigned 'MP'."</span><span class="op">)</span><span class="op">)</span>
          <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"a"</span><span class="op">]</span>
          <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"b"</span><span class="op">]</span>
        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
          <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved and will be assigned 'NP'."</span><span class="op">)</span><span class="op">)</span>
          <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"NP"</span>,<span class="st">"a"</span><span class="op">]</span>
          <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"NP"</span>,<span class="st">"b"</span><span class="op">]</span>
        <span class="op">}</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">nmis</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">nmis</span>,
                            <span class="st">" missing values (out of "</span>,
                            <span class="va">nshrub</span>,
                            <span class="st">" shrub species) after populating with input data.\n"</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span>, 
                    GrothForm <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span>,
                    a <span class="op">=</span> <span class="va">a_coef</span>, b <span class="op">=</span> <span class="va">b_coef</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">area_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_area</span>, 
                                                 <span class="va">group_params_area</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_ash</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">area_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_ash</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">area_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>

<span class="va">fine_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_fine</span>, 
                                                 <span class="va">group_params_fine</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_bsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fine_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_bsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fine_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>

<span class="va">total_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_total</span>, 
                                                 <span class="va">group_params_total</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_btsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">total_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_btsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">total_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span></code></pre></div>
</div>
<div id="shrub-crown-ratio-and-pdead" class="section level3">
<h3 class="hasAnchor">
<a href="#shrub-crown-ratio-and-pdead" class="anchor"></a>Shrub crown ratio and Pdead</h3>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_pdead_cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/ShrubAllometries/Shrub_Pdead_CR.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span>, dec<span class="op">=</span><span class="st">","</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span><span class="va">Name</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Species"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">unite</span><span class="op">(</span><span class="st">"Name"</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Species"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 26 rows [1, 2, 3, 4,
## 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].</code></pre>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 7 rows [28, 29,
## 30, 31, 32, 33, 34].</code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_cr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">CR.mean</span>,
                     row.names <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span>
<span class="va">shrub_pdead</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Pdead.mean</span>,
                     row.names <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span>

<span class="va">sp_params_allom</span> <span class="op">=</span> <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
<span class="va">group_params_allom</span> <span class="op">=</span> <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">retrieveValuesFromMedfuels</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">sp_params_allom</span>, 
                                       <span class="va">group_params_allom</span>, <span class="va">species_groups</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">sp_params_allom</span> <span class="op">&lt;-</span><span class="va">sp_params_allom</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
  <span class="va">group_params_allom</span> <span class="op">&lt;-</span><span class="va">group_params_allom</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
  <span class="va">coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">sp_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">)</span>
  <span class="va">gr_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">)</span>
  <span class="va">gen_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span>, <span class="va">species_groups</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
  <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">growth_form</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="va">nshrub</span> <span class="op">+</span><span class="fl">1</span>
      <span class="va">nm</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
      <span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">nm</span>,<span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
      <span class="kw">if</span><span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">sp_allom</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species-specific allometry available</span>
        <span class="va">sp_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sp_allom</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span> 
        <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">gen_sp</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species is found in medfuels species table</span>
        <span class="va">form_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gen_sp</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">form_raunkiaer</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="va">form_raunkiaer</span><span class="op">)</span> 
          <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="op">}</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">gen</span> <span class="op">%in%</span> <span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If genus occurs in medfuels table</span>
        <span class="va">forms_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">==</span><span class="va">gen</span><span class="op">)</span><span class="op">]</span>
        <span class="co"># Find most-frequent  raunkiaer form</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">forms_raunkiaer</span><span class="op">)</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="va">tfr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">tfr</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>
        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
          <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="op">}</span> 
      <span class="op">}</span> 
      
      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>  <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="va">growth_form</span><span class="op">==</span><span class="st">"Tree/Shrub"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="st">"MP"</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span> <span class="co"># If tree/shrub assing MPh data</span>
        <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"value"</span><span class="op">]</span>
      <span class="op">}</span> 
      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved."</span><span class="op">)</span><span class="op">)</span>
        <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="va">nmis</span> <span class="op">+</span> <span class="fl">1</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">nmis</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">nmis</span>,
                            <span class="st">" missing values (out of "</span>,
                            <span class="va">nshrub</span>,
                            <span class="st">" shrub species) after populating with input data.\n"</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span>, 
                    GrothForm <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span>,
                    coef <span class="op">=</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">cr_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveValuesFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Artemisia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Asparagus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Astragalus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Berberis vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Betula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Bupleurum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Calluna vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaecytisus proliferus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaespartium tridentatum' could not be retrieved.</code></pre>
<pre><code>## Data for 'Cistus crispus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Dorycnium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica australis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica ciliaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica tetralix' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica vagans' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erinacea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Eucalyptus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euphorbia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista hispanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista horrida' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista triflora' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Halimium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helianthemum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helichrysum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Hypericum canariensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ilex spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus oxycedrus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus phoenicea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved.</code></pre>
<pre><code>## Data for 'Laurus nobilis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lavandula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lithodora spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Myrtus communis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Nerium oleander' could not be retrieved.</code></pre>
<pre><code>## Data for 'Olea europaea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ononis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Paliurus spina-christi' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phlomis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia terebinthus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Prunus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pyrus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus ilex' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus robur' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rhamnus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rumex lunaria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ruscus aculeatus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Salix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Sambucus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Santolina spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Spartium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Teucrium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymelaea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vaccinium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vella spinosa' could not be retrieved.</code></pre>
<pre><code>## Data for 'Viburnum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved.</code></pre>
<pre><code>## 70 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdead_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveValuesFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">shrub_pdead</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">shrub_pdead</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Artemisia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Asparagus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Astragalus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Berberis vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Betula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Bupleurum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Calluna vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaecytisus proliferus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaespartium tridentatum' could not be retrieved.</code></pre>
<pre><code>## Data for 'Cistus crispus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Dorycnium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica australis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica ciliaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica tetralix' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica vagans' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erinacea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Eucalyptus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euphorbia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista hispanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista horrida' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista triflora' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Halimium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helianthemum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helichrysum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Hypericum canariensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ilex spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus oxycedrus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus phoenicea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved.</code></pre>
<pre><code>## Data for 'Laurus nobilis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lavandula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lithodora spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Myrtus communis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Nerium oleander' could not be retrieved.</code></pre>
<pre><code>## Data for 'Olea europaea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ononis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Paliurus spina-christi' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phlomis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia lentiscus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia terebinthus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Prunus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pyrus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus ilex' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus robur' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rhamnus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rumex lunaria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ruscus aculeatus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Salix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Sambucus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Santolina spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Spartium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Teucrium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymelaea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vaccinium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vella spinosa' could not be retrieved.</code></pre>
<pre><code>## Data for 'Viburnum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved.</code></pre>
<pre><code>## 71 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">SpParams</span><span class="op">$</span><span class="va">cr</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">pDead</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span></code></pre></div>
</div>
<div id="tree-allometries" class="section level3">
<h3 class="hasAnchor">
<a href="#tree-allometries" class="anchor"></a>Tree allometries</h3>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fb_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_FB_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cr_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_CR_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cw_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_CW_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fb_models</span>, <span class="st">"foliarbiomass"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 24 genus: 17 family: 0 order:0 group: 0</code></pre>
<pre><code>## 65 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">cr_models</span>, <span class="st">"crownratio"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 4 genus: 11 family: 0 order:0 group: 0</code></pre>
<pre><code>## 91 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">cw_models</span>, <span class="st">"crownwidth"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 11 genus: 18 family: 0 order:0 group: 0</code></pre>
<pre><code>## 77 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
</div>
</div>
<div id="plant-functional-traits" class="section level2">
<h2 class="hasAnchor">
<a href="#plant-functional-traits" class="anchor"></a>Plant functional traits</h2>
<div id="trait-databases-except-try" class="section level3">
<h3 class="hasAnchor">
<a href="#trait-databases-except-try" class="anchor"></a>Trait databases (except TRY)</h3>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  Hydratry</span>
<span class="va">fn_hydratry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/HydraTRY/HydraTRY.xlsx"</span><span class="op">)</span>
<span class="va">hydratry</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_hydratry</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> 

<span class="co">#  Martin-StPaul et al. (2017)</span>
<span class="va">fn_martin_stpaul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/MartinStPaul_et_al_2017/DataBase.xlsx"</span><span class="op">)</span>
<span class="va">martin_stpaul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_martin_stpaul</span>, sheet<span class="op">=</span><span class="st">"ALL"</span><span class="op">)</span>
<span class="va">martin_stpaul</span><span class="op">&lt;-</span><span class="va">martin_stpaul</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span>, <span class="st">"P12"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Choat et al. (2012)</span>
<span class="va">fn_choat</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/Choat_et_al_2012/nature11688-s2.xls"</span><span class="op">)</span>
<span class="va">choat</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_choat</span><span class="op">)</span>
<span class="va">choat</span> <span class="op">&lt;-</span><span class="va">choat</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span>, <span class="st">"P88"</span><span class="op">)</span><span class="op">]</span> <span class="co"># Remove unit row</span>

<span class="co"># Bartlett et al. 2012</span>
<span class="va">fn_bartlett</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Bartlett_et_al_2012/Bartlett_2012_ELE_data.xlsx"</span><span class="op">)</span>
<span class="va">bartlett</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_bartlett</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> 

<span class="co"># Duursma et al. 2018</span>
<span class="va">fn_duursma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Duursma_et_al_2018/gmindatabase.csv"</span><span class="op">)</span>
<span class="va">duursma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="va">fn_duursma</span>, sep<span class="op">=</span><span class="st">","</span><span class="op">)</span>

<span class="co"># Hoshika et al. 2018 </span>
<span class="va">fn_hoshika</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Hoshika_et_al_2018/Hoshika_et_al_2018.xlsx"</span><span class="op">)</span>
<span class="va">hoshika</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_hoshika</span><span class="op">)</span> 
<span class="va">hoshika</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu">str_replace</span><span class="op">(</span>string <span class="op">=</span> <span class="va">hoshika</span><span class="op">$</span><span class="va">Species</span>,pattern <span class="op">=</span> <span class="st">"_"</span>, replacement <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>

<span class="co"># BROT</span>
<span class="va">fn_brot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/Brot/BROT2_dat.csv"</span><span class="op">)</span>
<span class="va">brot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="va">fn_brot2</span><span class="op">)</span>

<span class="co">#Global wood density database</span>
<span class="co"># Zanne, A.E., Lopez-Gonzalez, G.*, Coomes, D.A., Ilic, J., Jansen, S., Lewis, S.L., Miller, R.B., Swenson, N.G., Wiemann, M.C., and Chave, J. 2009. Global wood density database. </span>
<span class="co"># Dryad. Identifier: http://hdl.handle.net/10255/dryad.235.</span>
<span class="va">fn_gwdd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/GlobalWoodDensityDatabase/GlobalWoodDensityDatabase.xls"</span><span class="op">)</span>
<span class="va">gwdd</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_gwdd</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># Flammability</span>
<span class="va">fn_flam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FuelAttributes/FuelAttributes.xlsx"</span><span class="op">)</span>
<span class="va">flam</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_flam</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># Fine-fuel ratio</span>
<span class="va">fn_ffr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FineFuelRatio/FineFuelRatio.xlsx"</span><span class="op">)</span>
<span class="va">ffr</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_ffr</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># Fuel moisture content</span>
<span class="va">fn_fmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/FMC/FMC.xlsx"</span><span class="op">)</span>
<span class="va">fmc_field</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_fmc</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">fmc_bib</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="va">fn_fmc</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># Yebra et al. (2020)</span>
<span class="va">fn_yebra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/LFMC_Yebra_et_al_2020/Globe-LFMC-v2.xlsx"</span><span class="op">)</span>
<span class="va">fmc_yebra</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="va">fn_yebra</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
</div>
<div id="plantleaf-classification" class="section level3">
<h3 class="hasAnchor">
<a href="#plantleaf-classification" class="anchor"></a>Plant/leaf classification</h3>
<div id="life-form" class="section level4">
<h4 class="hasAnchor">
<a href="#life-form" class="anchor"></a>Life form</h4>
<p>Load TRY life form data</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_life_form</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_343.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Homogenize life form values into six categories:</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_life_form</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_343.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch"</span>, <span class="st">"CH"</span>, <span class="st">"Cha"</span>, <span class="st">"chamaephyte"</span>, <span class="st">"Chamaephytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Chamaephyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cryptophytes"</span>, <span class="st">"cryptophyte"</span>,
                               <span class="st">"G"</span>, <span class="st">"geophyte"</span>, <span class="st">"Geophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Cryptophyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ep"</span>, <span class="st">"epiphyte"</span>,<span class="st">"Epiphytes"</span>, <span class="st">"liana"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Epiphyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="st">"hemicryptophyte"</span>, <span class="st">"Hemicryptophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hemicryptophyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hydrophyte"</span>, <span class="st">"Hydrophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hydrophyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mega- meso- and micro- phanerophyte"</span>,
                               <span class="st">"Phanerophyte (mega-,meso-, nano-)"</span>,
                               <span class="st">"Mega-, meso- and microphanerophyte"</span>,
                               <span class="st">"megaphanerophyte"</span>, <span class="st">"Megaphanerophyte"</span>,
                               <span class="st">"Micro-phanerophytes"</span>, <span class="st">"Nanophanerophyt"</span>,
                               <span class="st">"nanophanerophyte"</span>, <span class="st">"Nanophanerophyte"</span>,
                               <span class="st">"phanerophyte"</span>, <span class="st">"Phanerophytes"</span>, <span class="st">"shrub"</span>, <span class="st">"tree"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Phanerophyte"</span>
<span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"therophyte"</span>, <span class="st">"Therophyte (annual land plant)"</span>, <span class="st">"Therophytes"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Therophyte"</span>
<span class="va">TRY_life_form</span><span class="op">&lt;-</span><span class="va">TRY_life_form</span><span class="op">[</span><span class="va">TRY_life_form</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chamaephyte"</span>, <span class="st">"Cryptophyte"</span>,
                                                               <span class="st">"Epiphyte"</span>, <span class="st">"Hemicryptophyte"</span>, <span class="st">"Hydrophyte"</span>,
                                                               <span class="st">"Phanerophyte"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits()</a></code> to parse TRY values:</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_life_form</span>,
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LifeForm"</span> <span class="op">=</span> <span class="st">"OrigValueStr"</span><span class="op">)</span>,
                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [OrigValueStr -&gt; LifeForm] species: 86 conspecific: 116 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 17 missing trait values (7.8 %) after populating with input data.</code></pre>
<p>Check which species have missing values:</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LifeForm"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                         Name LifeForm
## 14  Ampelodesmos mauritanica     &lt;NA&gt;
## 17    Apollonias canariensis     &lt;NA&gt;
## 20   Arctostaphylos uva-ursi     &lt;NA&gt;
## 114          Genistella spp.     &lt;NA&gt;
## 115    Gleditsia triacanthos     &lt;NA&gt;
## 117            Halimium spp.     &lt;NA&gt;
## 118    Heberdenia bahamensis     &lt;NA&gt;
## 136           Lithodora spp.     &lt;NA&gt;
## 149   Paliurus spina-christi     &lt;NA&gt;
## 153             Phlomis spp.     &lt;NA&gt;
## 155         Picconia excelsa     &lt;NA&gt;
## 169   Pleiomeris canariensis     &lt;NA&gt;
## 185              Retama spp.     &lt;NA&gt;
## 206              Teline spp.     &lt;NA&gt;
## 216            Vella spinosa     &lt;NA&gt;
## 218          Visnea mocanera     &lt;NA&gt;
## 219           Zizyphus lotus     &lt;NA&gt;</code></pre>
<p>Fill missing values manually:</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Arctostaphylos uva-ursi"</span>, <span class="st">"Genistella spp."</span>, 
                                       <span class="st">"Halimium spp."</span>, <span class="st">"Lithodora spp."</span>, <span class="st">"Phlomis spp."</span>,
                                       <span class="st">"Vella spinosa"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Chamaephyte"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ampelodesmos mauritanica"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Hemicryptophyte"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Apollonias canariensis"</span>, <span class="st">"Gleditsia triacanthos"</span>,
                                       <span class="st">"Heberdenia bahamensis"</span>, <span class="st">"Picconia excelsa"</span>, <span class="st">"Pleiomeris canariensis"</span>,
                                       <span class="st">"Paliurus spina-christi"</span>, <span class="st">"Retama spp."</span>, <span class="st">"Teline spp."</span>,
                                       <span class="st">"Visnea mocanera"</span>, <span class="st">"Zizyphus lotus"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Phanerophyte"</span></code></pre></div>
<p>Show the number of taxa for each life form:</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LifeForm</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##     Chamaephyte     Cryptophyte Hemicryptophyte    Phanerophyte 
##              52               1              13             153</code></pre>
</div>
<div id="leaf-shape" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-shape" class="anchor"></a>Leaf shape</h4>
<p>Load TRY leaf shape data</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_leaf_shape</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_43.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Homogenize TRY leaf shape values into five categories:</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"broadleaved"</span>, <span class="st">"broad-leaved"</span>, <span class="st">"B"</span>, <span class="st">"broadleaf"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Broad"</span>
<span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"needleleaved"</span>, <span class="st">"needle-leaved"</span>,<span class="st">"needle"</span>,<span class="st">"needle-leaf"</span>, <span class="st">"N"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Needle"</span>
<span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scale-shaped"</span>, <span class="st">"scale"</span>, <span class="st">"scale-like"</span>, <span class="st">"scale-leaf"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span>
<span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"narrowleaved"</span>, <span class="st">"linear"</span>, <span class="st">"Cylindrical"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Linear"</span>
<span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"photosynthetic stem"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Spines"</span>
<span class="va">TRY_leaf_shape</span><span class="op">&lt;-</span><span class="va">TRY_leaf_shape</span><span class="op">[</span><span class="va">TRY_leaf_shape</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Broad"</span>, <span class="st">"Needle"</span>, <span class="st">"Scale"</span>, <span class="st">"Linear"</span>, <span class="st">"Spines"</span><span class="op">)</span>,
                               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"OrigValueStr"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_leaf_shape</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafShape"</span><span class="op">)</span></code></pre></div>
<p>Homogenize BROT2 leaf shape values into the same five categories:</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafShape</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafShape"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, 
                              <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">2</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"Needle-like"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Needle"</span>
<span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafShape</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"Scale-like"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafShape"</span><span class="op">)</span></code></pre></div>
<p>Merge data sets and call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits()</a></code> to parse leaf shape values:</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafShape_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafShape</span>,
                       <span class="va">TRY_leaf_shape</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafShape_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafShape"</span> <span class="op">=</span> <span class="st">"LeafShape"</span><span class="op">)</span>,
                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafShape -&gt; LeafShape] species: 138 conspecific: 79 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 2 missing trait values (0.9 %) after populating with input data.</code></pre>
<p>Show which species have missing values:</p>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LeafShape"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                       Name LeafShape
## 114        Genistella spp.      &lt;NA&gt;
## 207 Tetraclinis articulata      &lt;NA&gt;</code></pre>
<p>Fill missing values manually:</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genistella spp."</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Broad"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tetraclinis articulata"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Scale"</span></code></pre></div>
<p>Show the number of taxa for each leaf shape:</p>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafShape</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Broad Linear Needle  Scale 
##    182      1     29      7</code></pre>
</div>
<div id="leaf-size" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-size" class="anchor"></a>Leaf size</h4>
<p>Load TRY leaf area data:</p>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_leaf_area</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_3110.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Classify TRY leaf area values into three leaf size categories:</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_leaf_area</span><span class="op">$</span><span class="va">LeafSize</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_leaf_area</span><span class="op">$</span><span class="va">StdValue</span><span class="op">)</span>, 
                             breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">225</span>, <span class="fl">2025</span>,<span class="fl">100000</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">TRY_LeafSize</span><span class="op">&lt;-</span><span class="va">TRY_leaf_area</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_LeafSize</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Species"</span></code></pre></div>
<p>Split BROT2 data into leaf area values and leaf size strings:</p>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafArea"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Trait"</span>, <span class="st">"Data"</span>, <span class="st">"Units"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_LeafSize</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Units</span><span class="op">==</span><span class="st">"[5]"</span>,<span class="op">]</span>
<span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Units</span><span class="op">==</span><span class="st">"mm2"</span>,<span class="op">]</span></code></pre></div>
<p>Reclassify BROT2 leaf size data into three categories</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"very small"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"small"</span>
<span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"very large"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"large"</span>
<span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, 
                              <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">$</span><span class="va">Data</span>, <span class="fl">2</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">brot2_LeafSize</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafSize</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafSize"</span><span class="op">)</span></code></pre></div>
<p>Classify BRO2 leaf area values into three categories:</p>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">LeafSize</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_LeafArea</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>, 
                              breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">225</span>, <span class="fl">2025</span>,<span class="fl">100000</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">brot2_LeafArea</span> <span class="op">&lt;-</span> <span class="va">brot2_LeafArea</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafArea</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Species"</span></code></pre></div>
<p>Merge data sets and call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits()</a></code> to parse leaf size values:</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafSize_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafSize</span>,
                      <span class="va">brot2_LeafArea</span>,
                      <span class="va">TRY_LeafSize</span><span class="op">)</span>

<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafSize_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafSize"</span> <span class="op">=</span> <span class="st">"LeafSize"</span><span class="op">)</span>,
                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafSize -&gt; LeafSize] species: 79 conspecific: 112 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 28 missing trait values (12.8 %) after populating with input data.</code></pre>
<p>Show species with missing values:</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LeafSize"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                            Name LeafSize
## 10             Adenocarpus spp.     &lt;NA&gt;
## 14     Ampelodesmos mauritanica     &lt;NA&gt;
## 17       Apollonias canariensis     &lt;NA&gt;
## 33             Cedrus atlantica     &lt;NA&gt;
## 34               Cedrus deodara     &lt;NA&gt;
## 35                Cedrus libani     &lt;NA&gt;
## 38     Chamaecyparis lawsoniana     &lt;NA&gt;
## 41   Chamaespartium tridentatum     &lt;NA&gt;
## 54          Coriaria myrtifolia     &lt;NA&gt;
## 64  Cytisophyllum sessilifolium     &lt;NA&gt;
## 74          Daboecia cantabrica     &lt;NA&gt;
## 77               Dracaena drago     &lt;NA&gt;
## 90                Erinacea spp.     &lt;NA&gt;
## 96           Flueggea tinctoria     &lt;NA&gt;
## 114             Genistella spp.     &lt;NA&gt;
## 118       Heberdenia bahamensis     &lt;NA&gt;
## 130          Kleinia neriifolia     &lt;NA&gt;
## 149      Paliurus spina-christi     &lt;NA&gt;
## 155            Picconia excelsa     &lt;NA&gt;
## 169      Pleiomeris canariensis     &lt;NA&gt;
## 172       Pseudotsuga menziesii     &lt;NA&gt;
## 187           Rhododendron spp.     &lt;NA&gt;
## 200            Sophora japonica     &lt;NA&gt;
## 202               Spartium spp.     &lt;NA&gt;
## 206                 Teline spp.     &lt;NA&gt;
## 216               Vella spinosa     &lt;NA&gt;
## 218             Visnea mocanera     &lt;NA&gt;
## 219              Zizyphus lotus     &lt;NA&gt;</code></pre>
<p>Fill missing values manually:</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Apollonias canariensis"</span>,
                                       <span class="st">"Ampelodesmos mauritanica"</span>,
                                       <span class="st">"Dracaena drago"</span>, <span class="st">"Heberdenia bahamensis"</span>,
                                       <span class="st">"Picconia excelsa"</span>, <span class="st">"Pleiomeris canariensis"</span>,
                                       <span class="st">"Visnea mocanera"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Large"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Coriaria myrtifolia"</span>, <span class="st">"Flueggea tinctoria"</span>,
                                       <span class="st">"Kleinia neriifolia"</span>, <span class="st">"Rhododendron spp."</span>,
                                       <span class="st">"Sophora japonica"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Medium"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adenocarpus spp."</span>, <span class="st">"Cedrus atlantica"</span>,
                                       <span class="st">"Cedrus deodara"</span>, <span class="st">"Cedrus libani"</span>,
                                       <span class="st">"Chamaecyparis lawsoniana"</span>,
                                       <span class="st">"Chamaespartium tridentatum"</span>,
                                       <span class="st">"Cytisophyllum sessilifolium"</span>,
                                       <span class="st">"Daboecia cantabrica"</span>,
                                       <span class="st">"Erinacea spp."</span>, <span class="st">"Genistella spp."</span>,
                                       <span class="st">"Paliurus spina-christi"</span>, <span class="st">"Pseudotsuga menziesii"</span>,
                                       <span class="st">"Spartium spp."</span>, <span class="st">"Teline spp."</span>, <span class="st">"Vella spinosa"</span>,
                                       <span class="st">"Zizyphus lotus"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Small"</span></code></pre></div>
<p>Show the number of taxa for each leaf size:</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">LeafSize</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Large Medium  Small 
##     50     68    101</code></pre>
</div>
<div id="phenology-type" class="section level4">
<h4 class="hasAnchor">
<a href="#phenology-type" class="anchor"></a>Phenology type</h4>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_phenology</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_37.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"evergreen"</span>, <span class="st">"E"</span>, <span class="st">"EV"</span>, <span class="st">"always summer green"</span>,
                               <span class="st">"Evergreen broad-leaved"</span>, <span class="st">"Evergreen scale-like"</span>,
                               <span class="st">"Evergreen needle-leaved"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span>
<span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deciduous"</span>, <span class="st">"D"</span>, <span class="st">"Deciduous broad-leaved"</span>, <span class="st">"Deciduous"</span>,
                               <span class="st">"Nonevergreen"</span>, <span class="st">"winter deciduous"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span>
<span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"semi-deciduous"</span>,
                               <span class="st">"semi-evergreen"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-semideciduous"</span>
<span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> 
                             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"drought semi-deciduous"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"drought-semideciduous"</span>
<span class="va">TRY_phenology</span><span class="op">&lt;-</span><span class="va">TRY_phenology</span><span class="op">[</span><span class="va">TRY_phenology</span><span class="op">$</span><span class="va">OrigValueStr</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"progressive-evergreen"</span>,
                                                               <span class="st">"oneflush-evergreen"</span>, 
                                                               <span class="st">"winter-semideciduous"</span>,
                                                               <span class="st">"winter-deciduous"</span>,
                                                               <span class="st">"drought-semideciduous"</span><span class="op">)</span><span class="op">]</span>
<span class="va">TRY_phenology</span><span class="op">&lt;-</span><span class="va">TRY_phenology</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"OrigValueStr"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_phenology</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafPhenology"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_LeafPhenology</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafPhenology"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"drought semi-deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"drought-semideciduous"</span>
<span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"evergreen"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span>
<span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"winter deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span>
<span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">[</span><span class="va">brot2_LeafPhenology</span><span class="op">$</span><span class="va">Data</span><span class="op">==</span><span class="st">"winter semi-deciduous"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-semideciduous"</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafPhenology</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafPhenology"</span><span class="op">)</span></code></pre></div>
<p>Merge data sets and call <code><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits()</a></code> to parse leaf phenology:</p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafPhenology_data</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">brot2_LeafPhenology</span>,
                          <span class="va">TRY_phenology</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafPhenology_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PhenologyType"</span> <span class="op">=</span> <span class="st">"LeafPhenology"</span><span class="op">)</span>,
                           character_traits <span class="op">=</span> <span class="cn">TRUE</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafPhenology -&gt; PhenologyType] species: 123 conspecific: 93 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 3 missing trait values (1.4 %) after populating with input data.</code></pre>
<p>Show which species have missing values:</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"PhenologyType"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                       Name PhenologyType
## 114        Genistella spp.          &lt;NA&gt;
## 169 Pleiomeris canariensis          &lt;NA&gt;
## 216          Vella spinosa          &lt;NA&gt;</code></pre>
<p>Fill missing values manually:</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vella spinosa"</span>, <span class="st">"Genistella spp."</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"winter-deciduous"</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pleiomeris canariensis"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">"oneflush-evergreen"</span></code></pre></div>
<p>Show the number of taxa for each phenology type:</p>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">PhenologyType</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## drought-semideciduous    oneflush-evergreen      winter-deciduous 
##                     3                   122                    94</code></pre>
</div>
</div>
<div id="plant-size" class="section level3">
<h3 class="hasAnchor">
<a href="#plant-size" class="anchor"></a>Plant size</h3>
<p>We already populated some plant size parameters from forest inventory data. Here we draw values for parameters that are not normally measured in forest inventory data (for obvious reasons), such as maximum rooting depth.</p>
<div id="maximum-rooting-depth" class="section level4">
<h4 class="hasAnchor">
<a href="#maximum-rooting-depth" class="anchor"></a>Maximum rooting depth</h4>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Z95</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_6.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Z95</span> <span class="op">&lt;-</span><span class="va">TRY_Z95</span><span class="op">[</span><span class="va">TRY_Z95</span><span class="op">$</span><span class="va">OriglName</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Max Rooting Depth (m)"</span>,
                                           <span class="st">"Rooting depth"</span>,
                                           <span class="st">"Rooting depth (m)"</span>,
                                           <span class="st">"Rooting depth_max"</span>,
                                           <span class="st">"RootDepth"</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">TRY_Z95</span> <span class="op">&lt;-</span> <span class="va">TRY_Z95</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_Z95</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Z95"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_Z95</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RootDepth"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_Z95</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_Z95</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_Z95</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Z95"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Z95_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">TRY_Z95</span>,
                 <span class="va">brot2_Z95</span><span class="op">)</span>
<span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span><span class="op">(</span><span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span>, <span class="fl">0.15</span><span class="op">)</span> <span class="co"># Minimum of 15 cm depth</span>
<span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span><span class="op">(</span><span class="va">Z95_data</span><span class="op">$</span><span class="va">Z95</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># Maximum of 10 m depth</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Z95_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Z95"</span> <span class="op">=</span> <span class="st">"Z95"</span><span class="op">)</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Z95"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Z95 -&gt; Z95] species: 49 conspecific: 119 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 51 missing trait values (23.3 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE    88   63         17
##   TRUE     25   16         10</code></pre>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Z95</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   113   79         27</code></pre>
</div>
</div>
<div id="leaf-phenology" class="section level3">
<h3 class="hasAnchor">
<a href="#leaf-phenology" class="anchor"></a>Leaf phenology</h3>
<div id="leaf-duration" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-duration" class="anchor"></a>Leaf duration</h4>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LeafDuration</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_12.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_LeafDuration</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafDuration</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_LeafDuration</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafDuration"</span><span class="op">)</span></code></pre></div>
<p>Adapt data sources:</p>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"LL"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafDuration"</span>
<span class="va">brot2_LeafDuration</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafLifespan"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_LeafDuration</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_LeafDuration</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_LeafDuration</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafDuration"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafDuration_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"LeafDuration"</span><span class="op">)</span><span class="op">]</span>,
                         <span class="va">TRY_LeafDuration</span>,
                         <span class="va">brot2_LeafDuration</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafDuration_data</span>, 
                                trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafDuration"</span> <span class="op">=</span> <span class="st">"LeafDuration"</span><span class="op">)</span>,
                                scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafDuration"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">12</span><span class="op">}</span><span class="op">)</span>,
                                taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafDuration -&gt; LeafDuration] species: 64 conspecific: 102 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 53 missing trait values (24.2 %) after populating with input data.</code></pre>
</div>
</div>
<div id="anatomy" class="section level3">
<h3 class="hasAnchor">
<a href="#anatomy" class="anchor"></a>Anatomy</h3>
<div id="specific-leaf-area" class="section level4">
<h4 class="hasAnchor">
<a href="#specific-leaf-area" class="anchor"></a>Specific leaf area</h4>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_SLA</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_3117.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_SLA</span> <span class="op">&lt;-</span> <span class="va">TRY_SLA</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_SLA</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"SLA"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_SLA</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SLA"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_SLA</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_SLA</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_SLA</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"SLA"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SLA_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"SLA"</span><span class="op">)</span><span class="op">]</span>,
                 <span class="va">TRY_SLA</span>,
                 <span class="va">brot2_SLA</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">SLA_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"SLA"</span> <span class="op">=</span> <span class="st">"SLA"</span><span class="op">)</span> ,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [SLA -&gt; SLA] species: 106 conspecific: 103 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 10 missing trait values (4.6 %) after populating with input data.</code></pre>
</div>
<div id="leaf-density" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-density" class="anchor"></a>Leaf density</h4>
<div class="sourceCode" id="cb339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LeafDensity</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_48.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_LeafDensity</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafDensity"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; LeafDensity] species: 62 conspecific: 95 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 62 missing trait values (28.3 %) after populating with input data.</code></pre>
</div>
<div id="wood-density" class="section level4">
<h4 class="hasAnchor">
<a href="#wood-density" class="anchor"></a>Wood density</h4>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_WoodDensity</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_4.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_WoodDensity</span> <span class="op">&lt;-</span> <span class="va">TRY_WoodDensity</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_WoodDensity</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span>
<span class="va">gwdd_WoodDensity</span><span class="op">&lt;-</span><span class="va">gwdd</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Binomial"</span>, <span class="st">"Wood density (g/cm^3), oven dry mass/fresh volume"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">gwdd_WoodDensity</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"WD"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"WoodDensity"</span></code></pre></div>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_WoodDensity</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"StemDensity"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Data"</span><span class="op">)</span><span class="op">)</span>
<span class="va">brot2_WoodDensity</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_WoodDensity</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">brot2_WoodDensity</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"WoodDensity"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">WoodDensity_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"WoodDensity"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">TRY_WoodDensity</span>,
                        <span class="va">brot2_WoodDensity</span>,
                        <span class="va">gwdd_WoodDensity</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">WoodDensity_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WoodDensity"</span> <span class="op">=</span> <span class="st">"WoodDensity"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [WoodDensity -&gt; WoodDensity] species: 88 conspecific: 105 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 26 missing trait values (11.9 %) after populating with input data.</code></pre>
</div>
<div id="fine-fuel-ratio" class="section level4">
<h4 class="hasAnchor">
<a href="#fine-fuel-ratio" class="anchor"></a>Fine fuel ratio</h4>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ffr</span><span class="op">)</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r635"</span> <span class="op">=</span> <span class="st">"r635"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [r635 -&gt; r635] species: 30 conspecific: 56 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 133 missing trait values (60.7 %) after populating with input data.</code></pre>
</div>
<div id="fraction-of-dead-material-p_dead" class="section level4">
<h4 class="hasAnchor">
<a href="#fraction-of-dead-material-p_dead" class="anchor"></a>Fraction of dead material (<span class="math inline">\(P_{dead}\)</span>)</h4>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">pDead</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   140    79</code></pre>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brot2_DF</span> <span class="op">&lt;-</span> <span class="va">brot2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Trait</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DeadFuel"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxon"</span>, <span class="st">"Trait"</span>, <span class="st">"Data"</span>, <span class="st">"Units"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Units</span><span class="op">==</span><span class="st">"%"</span><span class="op">)</span>
<span class="va">brot2_DF</span><span class="op">$</span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brot2_DF</span><span class="op">$</span><span class="va">Data</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">brot2_DF</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pDead"</span> <span class="op">=</span> <span class="st">"Data"</span><span class="op">)</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pDead"</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">100</span><span class="op">}</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Taxon"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Data -&gt; pDead] species: 1 conspecific: 21 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 57 missing trait values (26 %) after populating with input data.</code></pre>
</div>
<div id="leaf-area-to-sapwood-area-ratio" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-area-to-sapwood-area-ratio" class="anchor"></a>Leaf area to sapwood area ratio</h4>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Hv</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_171.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Huber value"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Huber value"</span><span class="op">]</span><span class="op">)</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"leaf.area.per.sapwood.area"</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"leaf.area.per.sapwood.area"</span><span class="op">]</span><span class="op">*</span><span class="fl">100</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Sapwood: leaf area ratio"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"Sapwood: leaf area ratio"</span><span class="op">]</span><span class="op">)</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"The ratio of leaf area attached per unit sapwood cross-section area (m2 cm-2)"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"The ratio of leaf area attached per unit sapwood cross-section area (m2 cm-2)"</span><span class="op">]</span><span class="op">)</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at base of living crown, m2/cm2"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at base of living crown, m2/cm2"</span><span class="op">]</span><span class="op">)</span>
<span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at breast height, m2/cm2"</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">10000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">[</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">OriglName</span><span class="op">==</span><span class="st">"values at breast height, m2/cm2"</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">$</span><span class="va">StdValue</span><span class="op">)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    81.3  1862.8  3911.5  5300.5  6867.5 84200.0</code></pre>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Hv</span> <span class="op">&lt;-</span> <span class="va">TRY_Hv</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_Hv</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Al2As"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hydratry_Hv</span> <span class="op">&lt;-</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="st">"Hv"</span><span class="op">)</span><span class="op">]</span>
<span class="va">hydratry_Hv</span><span class="op">$</span><span class="va">Hv</span><span class="op">&lt;-</span> <span class="fl">10000</span><span class="op">/</span><span class="va">hydratry_Hv</span><span class="op">$</span><span class="va">Hv</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry_Hv</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Al2As"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Hv_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">TRY_Hv</span>,
               <span class="va">hydratry_Hv</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Hv_data</span>,
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Al2As"</span> <span class="op">=</span> <span class="st">"Al2As"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Al2As -&gt; Al2As] species: 27 conspecific: 76 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 116 missing trait values (53 %) after populating with input data.</code></pre>
</div>
<div id="leaf-width" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-width" class="anchor"></a>Leaf width</h4>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LW</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_145.rds"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_LW</span>,
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafWidth"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; LeafWidth] species: 60 conspecific: 109 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 50 missing trait values (22.8 %) after populating with input data.</code></pre>
</div>
<div id="specific-root-length" class="section level4">
<h4 class="hasAnchor">
<a href="#specific-root-length" class="anchor"></a>Specific root length</h4>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_SRL</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_614.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_SRL</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SRL"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; SRL] species: 8 conspecific: 52 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 159 missing trait values (72.6 %) after populating with input data.</code></pre>
</div>
</div>
<div id="tissue-moisture" class="section level3">
<h3 class="hasAnchor">
<a href="#tissue-moisture" class="anchor"></a>Tissue moisture</h3>
<div id="minimummaximum-fuel-moisture-content" class="section level4">
<h4 class="hasAnchor">
<a href="#minimummaximum-fuel-moisture-content" class="anchor"></a>Minimum/maximum fuel moisture content</h4>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fmc_yebra</span><span class="op">$</span><span class="va">Species.collected</span><span class="op">[</span><span class="va">fmc_yebra</span><span class="op">$</span><span class="va">Species.collected</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Salvia officinalis"</span>

<span class="va">FMC_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">fmc_field</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species name"</span>, <span class="st">"MinFMC_DW"</span>, <span class="st">"MaxFMC_DW"</span><span class="op">)</span><span class="op">]</span>,
                  <span class="va">fmc_bib</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species name"</span>, <span class="st">"MinFMC_DW"</span>, <span class="st">"MaxFMC_DW"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">FMC_data</span><span class="op">$</span><span class="va">`Species name`</span><span class="op">[</span><span class="va">FMC_data</span><span class="op">$</span><span class="va">`Species name`</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Salvia officinalis"</span></code></pre></div>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fmc_yebra</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"minFMC"</span> <span class="op">=</span> <span class="st">"LFMC.value"</span><span class="op">)</span>,
                           summary_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>,probs<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,
                           summary_params <span class="op">=</span> <span class="cn">NULL</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species.collected"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LFMC.value -&gt; minFMC] species: 37 conspecific: 88 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 94 missing trait values (42.9 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fmc_yebra</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"maxFMC"</span> <span class="op">=</span> <span class="st">"LFMC.value"</span><span class="op">)</span>,
                           summary_function <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>,probs<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,
                           summary_params <span class="op">=</span> <span class="cn">NULL</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species.collected"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LFMC.value -&gt; maxFMC] species: 37 conspecific: 88 genus: 0 family: 0 order: 0 group: 0
## 94 missing trait values (42.9 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">FMC_data</span><span class="op">)</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"minFMC"</span> <span class="op">=</span> <span class="st">"MinFMC_DW"</span>,
                                             <span class="st">"maxFMC"</span> <span class="op">=</span> <span class="st">"MaxFMC_DW"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species name"</span>, erase_previous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [MinFMC_DW -&gt; minFMC] species: 9 conspecific: 8 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 77 missing trait values (35.2 %) after populating with input data.</code></pre>
<pre><code>## Mapping [MaxFMC_DW -&gt; maxFMC] species: 9 conspecific: 8 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 77 missing trait values (35.2 %) after populating with input data.</code></pre>
</div>
<div id="leaf-pressure-volume-curve" class="section level4">
<h4 class="hasAnchor">
<a href="#leaf-pressure-volume-curve" class="anchor"></a>Leaf pressure-volume curve</h4>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"πo.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafPI0"</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"ε.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"LeafEPS"</span></code></pre></div>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LeafPI0</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_188.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_LeafPI0</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafPI0</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_LeafPI0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span>
<span class="va">TRY_LeafPI0</span><span class="op">$</span><span class="va">LeafPI0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">TRY_LeafPI0</span><span class="op">$</span><span class="va">LeafPI0</span> </code></pre></div>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_LeafEPS</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_190.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_LeafEPS</span><span class="op">$</span><span class="va">StdValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">$</span><span class="va">OrigValueStr</span><span class="op">)</span> 
<span class="va">TRY_LeafEPS</span> <span class="op">&lt;-</span> <span class="va">TRY_LeafEPS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafPI0_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">TRY_LeafPI0</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span><span class="op">]</span>,
                     <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafPI0"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafPI0_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafPI0"</span> <span class="op">=</span> <span class="st">"LeafPI0"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafPI0 -&gt; LeafPI0] species: 16 conspecific: 54 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 149 missing trait values (68 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LeafEPS_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">TRY_LeafEPS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span><span class="op">]</span>,
                     <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"LeafEPS"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">LeafEPS_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafEPS"</span> <span class="op">=</span> <span class="st">"LeafEPS"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [LeafEPS -&gt; LeafEPS] species: 15 conspecific: 49 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 155 missing trait values (70.8 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">bartlett</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeafAF"</span> <span class="op">=</span> <span class="st">"af"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [af -&gt; LeafAF] species: 12 conspecific: 24 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 183 missing trait values (83.6 %) after populating with input data.</code></pre>
</div>
</div>
<div id="fuel-flammability" class="section level3">
<h3 class="hasAnchor">
<a href="#fuel-flammability" class="anchor"></a>Fuel flammability</h3>
<div id="heat-content-and-surface-area-to-volume-ratio" class="section level4">
<h4 class="hasAnchor">
<a href="#heat-content-and-surface-area-to-volume-ratio" class="anchor"></a>Heat content and surface area to volume ratio</h4>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">flam</span><span class="op">)</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HeatContent"</span> <span class="op">=</span> <span class="st">"High calorific value [J/kg]"</span>,
                                             <span class="st">"SAV"</span> <span class="op">=</span> <span class="st">"SurfaceAreaVolume[m2/m3]"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species name"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [High calorific value [J/kg] -&gt; HeatContent] species: 29 conspecific: 65 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 125 missing trait values (57.1 %) after populating with input data.</code></pre>
<pre><code>## Mapping [SurfaceAreaVolume[m2/m3] -&gt; SAV] species: 21 conspecific: 53 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 145 missing trait values (66.2 %) after populating with input data.</code></pre>
</div>
<div id="lignin-content" class="section level4">
<h4 class="hasAnchor">
<a href="#lignin-content" class="anchor"></a>Lignin content</h4>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Lignin</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"TraitDatabases/TRY/TRY_traits/TRY_87.rds"</span><span class="op">)</span><span class="op">)</span>

<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Lignin</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LigninPercent"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LigninPercent"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">10</span><span class="op">}</span><span class="op">)</span>, <span class="co">#mg/g to % </span>
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; LigninPercent] species: 2 conspecific: 47 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 170 missing trait values (77.6 %) after populating with input data.</code></pre>
</div>
</div>
<div id="transpirationphotosynthesis" class="section level3">
<h3 class="hasAnchor">
<a href="#transpirationphotosynthesis" class="anchor"></a>Transpiration/photosynthesis</h3>
<div id="water-potential-determining-stomatal-closure" class="section level4">
<h4 class="hasAnchor">
<a href="#water-potential-determining-stomatal-closure" class="anchor"></a>Water potential determining stomatal closure</h4>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">bartlett</span><span class="op">)</span><span class="op">==</span><span class="st">"πtlp.(MPa)"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Ptlp"</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">)</span><span class="op">==</span><span class="st">"PItlp"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Ptlp"</span></code></pre></div>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ptlp_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span>,
                  <span class="va">hydratry</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span>,
                  <span class="va">bartlett</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Ptlp"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Ptlp_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Psi_Extract"</span> <span class="op">=</span> <span class="st">"Ptlp"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Ptlp -&gt; Psi_Extract] species: 41 conspecific: 58 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 120 missing trait values (54.8 %) after populating with input data.</code></pre>
</div>
<div id="critical-water-potential" class="section level4">
<h4 class="hasAnchor">
<a href="#critical-water-potential" class="anchor"></a>Critical water potential</h4>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">P50_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span>,
                 <span class="va">choat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span>,
                 <span class="va">hydratry</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"P50"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">P50_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Psi_Critic"</span> <span class="op">=</span> <span class="st">"P50"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [P50 -&gt; Psi_Critic] species: 64 conspecific: 76 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 79 missing trait values (36.1 %) after populating with input data.</code></pre>
</div>
<div id="water-use-efficiency" class="section level4">
<h4 class="hasAnchor">
<a href="#water-use-efficiency" class="anchor"></a>Water use efficiency</h4>
<div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_WUE</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_134.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_WUE</span> <span class="op">&lt;-</span> <span class="va">TRY_WUE</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">StdValue</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_WUE</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WUE"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; WUE] species: 7 conspecific: 32 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 180 missing trait values (82.2 %) after populating with input data.</code></pre>
</div>
<div id="minimummaximum-stomatal-conductance" class="section level4">
<h4 class="hasAnchor">
<a href="#minimummaximum-stomatal-conductance" class="anchor"></a>Minimum/maximum stomatal conductance</h4>
<p>(<span class="math inline">\(G_{swmin}\)</span> and <span class="math inline">\(G_{swmax}\)</span>)</p>
<div class="sourceCode" id="cb415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">duursma</span><span class="op">$</span><span class="va">gmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">duursma</span><span class="op">$</span><span class="va">gmin</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">duursma</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Gswmin"</span> <span class="op">=</span> <span class="st">"gmin"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"species"</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Gswmin"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="co">#From mmol·s-1·m-2 to mol·s-1·m-2</span></code></pre></div>
<pre><code>## Mapping [gmin -&gt; Gswmin] species: 18 conspecific: 52 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 149 missing trait values (68 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb418"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">hoshika</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Gswmax"</span> <span class="op">=</span> <span class="st">"gmax.(mol.m-2.s-1)"</span><span class="op">)</span> ,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [gmax.(mol.m-2.s-1) -&gt; Gswmax] species: 17 conspecific: 33 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 169 missing trait values (77.2 %) after populating with input data.</code></pre>
</div>
<div id="stem-maximum-hydraulic-conductivity" class="section level4">
<h4 class="hasAnchor">
<a href="#stem-maximum-hydraulic-conductivity" class="anchor"></a>Stem maximum hydraulic conductivity</h4>
<p>(<span class="math inline">\(K_{stem, max, ref}\)</span>)</p>
<div class="sourceCode" id="cb421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">hydratry</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kmax_stemxylem"</span> <span class="op">=</span> <span class="st">"Ks"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Ks -&gt; Kmax_stemxylem] species: 36 conspecific: 74 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 109 missing trait values (49.8 %) after populating with input data.</code></pre>
</div>
<div id="stem-hydraulic-vulnerability" class="section level4">
<h4 class="hasAnchor">
<a href="#stem-hydraulic-vulnerability" class="anchor"></a>Stem hydraulic vulnerability</h4>
<div class="sourceCode" id="cb424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_c</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_d</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P12</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">weib</span> <span class="op">=</span> <span class="fu"><a href="../../reference/conductancefunctions.html">hydraulics_psi2Weibull</a></span><span class="op">(</span>psi50 <span class="op">=</span> <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
                                  psi12 <span class="op">=</span> <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">P12</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"c"</span><span class="op">]</span><span class="op">]</span>
    <span class="va">martin_stpaul</span><span class="op">$</span><span class="va">VCstem_d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"d"</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">choat</span><span class="op">$</span><span class="va">P50</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">)</span>
<span class="va">choat</span><span class="op">$</span><span class="va">P88</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">)</span>
<span class="va">choat</span><span class="op">$</span><span class="va">VCstem_c</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">choat</span><span class="op">$</span><span class="va">VCstem_d</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">choat</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">weib</span> <span class="op">=</span> <span class="fu"><a href="../../reference/conductancefunctions.html">hydraulics_psi2Weibull</a></span><span class="op">(</span>psi50 <span class="op">=</span> <span class="va">choat</span><span class="op">$</span><span class="va">P50</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
                                  psi88 <span class="op">=</span> <span class="va">choat</span><span class="op">$</span><span class="va">P88</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="va">choat</span><span class="op">$</span><span class="va">VCstem_c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"c"</span><span class="op">]</span><span class="op">]</span>
    <span class="va">choat</span><span class="op">$</span><span class="va">VCstem_d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">weib</span><span class="op">[[</span><span class="st">"d"</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">VC_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">martin_stpaul</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"VCstem_c"</span>, <span class="st">"VCstem_d"</span><span class="op">)</span><span class="op">]</span>,
                <span class="va">choat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"VCstem_c"</span>, <span class="st">"VCstem_d"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">VC_data</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"VCstem_c"</span> <span class="op">=</span> <span class="st">"VCstem_c"</span>,
                                                <span class="st">"VCstem_d"</span> <span class="op">=</span> <span class="st">"VCstem_d"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [VCstem_c -&gt; VCstem_c] species: 57 conspecific: 69 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 93 missing trait values (42.5 %) after populating with input data.</code></pre>
<pre><code>## Mapping [VCstem_d -&gt; VCstem_d] species: 57 conspecific: 69 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 93 missing trait values (42.5 %) after populating with input data.</code></pre>
</div>
<div id="photosynthetic-capacity" class="section level4">
<h4 class="hasAnchor">
<a href="#photosynthetic-capacity" class="anchor"></a>Photosynthetic capacity</h4>
<div class="sourceCode" id="cb430"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Narea</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_50.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">TRY_Narea</span> <span class="op">&lt;-</span> <span class="va">TRY_Narea</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AccSpeciesName"</span>, <span class="st">"StdValue"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">TRY_Narea</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Narea"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Narea_data</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hydratry</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="st">"Narea"</span><span class="op">)</span><span class="op">]</span>,
                   <span class="va">TRY_Narea</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">Narea_data</span>, 
                                trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Narea"</span> <span class="op">=</span> <span class="st">"Narea"</span><span class="op">)</span>,
                                taxon_column <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [Narea -&gt; Narea] species: 86 conspecific: 108 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 25 missing trait values (11.4 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb434"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Vmax298</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_186.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Vmax298</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vmax298"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; Vmax298] species: 22 conspecific: 82 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 115 missing trait values (52.5 %) after populating with input data.</code></pre>
<div class="sourceCode" id="cb437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_Jmax298</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_269.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_Jmax298</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Jmax298"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; Jmax298] species: 19 conspecific: 65 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 135 missing trait values (61.6 %) after populating with input data.</code></pre>
</div>
</div>
<div id="carbon-balance-and-growth" class="section level3">
<h3 class="hasAnchor">
<a href="#carbon-balance-and-growth" class="anchor"></a>Carbon balance and growth</h3>
<div id="wood-carbon-content" class="section level4">
<h4 class="hasAnchor">
<a href="#wood-carbon-content" class="anchor"></a>Wood carbon content</h4>
<div class="sourceCode" id="cb440"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRY_WoodC</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">DB_path</span>,<span class="st">"TraitDatabases/TRY/TRY_traits/TRY_407.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTraits.html">populateTraits</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">TRY_WoodC</span>, 
                           trait_mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WoodC"</span> <span class="op">=</span> <span class="st">"StdValue"</span><span class="op">)</span>,
                           scalar_functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WoodC"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">/</span><span class="fl">1000</span><span class="op">}</span><span class="op">)</span>, <span class="co">#mg/g to g/g </span>
                           taxon_column <span class="op">=</span> <span class="st">"AccSpeciesName"</span><span class="op">)</span></code></pre></div>
<pre><code>## Mapping [StdValue -&gt; WoodC] species: 31 conspecific: 75 genus: 0 family: 0 order: 0 group: 0</code></pre>
<pre><code>## 113 missing trait values (51.6 %) after populating with input data.</code></pre>
</div>
</div>
</div>
<div id="recruitment-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#recruitment-parameters" class="anchor"></a>Recruitment parameters</h2>
<p>This document describes the parametrization of bioclimatic recruitment thresholds for the forest dynamics model <code><a href="../../reference/fordyn.html">fordyn()</a></code> included in <code>medfate</code>. Specifically, we aim to find suitable values for parameters:</p>
<ul>
<li>
<code>MinTempRecr</code>: Minimum average temperature of the coldest month necessary for recruiting.</li>
<li>
<code>MinMoistureRecr</code>: Minimum moisture index (annual precipitation over annual ETP) necessary for recruiting.</li>
<li>
<code>MinFPARRecr</code>: Minimum fraction of PAR (in %) reaching the ground necessary for recruiting.</li>
</ul>
<p>Load <code>SpParamsMED</code> and subset the table to be filled:</p>
<div class="sourceCode" id="cb443"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParamsRecr</span> <span class="op">=</span> <span class="va">SpParams</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"IFNcodes"</span>, <span class="st">"SpIndex"</span>, 
                           <span class="st">"MinTempRecr"</span>, <span class="st">"MinMoistureRecr"</span>,<span class="st">"MinFPARRecr"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>To find suitable values for these parameters that set the recruitment requirements we will first determine bioclimatic and light conditions in IFN3 plots and then we will calculate the 1% quantile from the observed distribution of each target species.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Miquel De Cáceres, Shengli Huang, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
