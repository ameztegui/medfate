<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Species parameterization for Spain • medfate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Species parameterization for Spain">
<meta property="og:description" content="medfate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../articles/index.html">Articles</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/emf-creaf/medfate/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="SpeciesParameterizationSpain_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Species parameterization for Spain</h1>
                        <h4 class="author">Miquel De Cáceres</h4>
            
            <h4 class="date">2021-07-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/medfate/blob/master/vignettes/parametrization/SpeciesParameterizationSpain.Rmd"><code>vignettes/parametrization/SpeciesParameterizationSpain.Rmd</code></a></small>
      <div class="hidden name"><code>SpeciesParameterizationSpain.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emf-creaf/medfate">medfate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">medfateutils</span><span class="op">)</span></code></pre></div>
<p>Set the path to forest inventory data (in my computer)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/Datasets/IFN/"</span></code></pre></div>
<p>Set path to trait and allometry databases:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Database_path</span> <span class="op">=</span> <span class="st">"/home/miquel/OneDrive/Professional/Recerca/MedfateSpeciesParametrization/"</span></code></pre></div>
</div>
<div id="initialize-species-parameter-table-for-ifn" class="section level2">
<h2 class="hasAnchor">
<a href="#initialize-species-parameter-table-for-ifn" class="anchor"></a>Initialize species parameter table for IFN</h2>
<div id="load-ifn-taxonomic-codification" class="section level3">
<h3 class="hasAnchor">
<a href="#load-ifn-taxonomic-codification" class="anchor"></a>Load IFN taxonomic codification</h3>
<p>Load species codes from IFN2-3 and IFN4</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN23_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/SpeciesCodesIFN23.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN23_species_data</span><span class="op">&lt;-</span><span class="va">IFN23_species_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>

<span class="va">IFN4_shrub_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/shrubcodesifn4.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Sources/treecodesifn4.txt"</span><span class="op">)</span>, 
                                    sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN4_tree_species_data</span><span class="op">&lt;-</span><span class="va">IFN4_tree_species_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>Merge the two code data sets:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newShrubs</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="op">(</span><span class="va">IFN4_shrub_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">newTrees</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="op">(</span><span class="va">IFN4_tree_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">IFN23_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span>
<span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">IFN23_species_data</span>, 
                              <span class="va">IFN4_shrub_species_data</span><span class="op">[</span><span class="va">newShrubs</span>, <span class="op">]</span>, 
                              <span class="va">IFN4_tree_species_data</span><span class="op">[</span><span class="va">newTrees</span>,<span class="op">]</span><span class="op">)</span>
<span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="va">IFN_species_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 411   2</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>##   IFNCODE               IFNNAME
## 1       1 Heberdenia bahamensis
## 2       2    Amelanchier ovalis
## 3       3        Frangula alnus
## 4       4     Rhamnus alaternus
## 5       5    Euonymus europaeus
## 6       6       Myrtus communis</code></pre>
</div>
<div id="define-ifn-codes-to-exclude" class="section level3">
<h3 class="hasAnchor">
<a href="#define-ifn-codes-to-exclude" class="anchor"></a>Define IFN codes to exclude</h3>
<p>Define codes to be excluded because they have low taxonomic content or refer to unsuitable growth forms (vines):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">codesOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"19"</span>, <span class="co"># Otras coniferas </span>
              <span class="st">"10"</span>, <span class="co"># Sin asignar</span>
              <span class="st">"20"</span>, <span class="co"># Pinos</span>
              <span class="st">"29"</span>, <span class="co"># Otros pinos</span>
              <span class="st">"30"</span>,  <span class="co">#Mezcla de coniferas</span>
              <span class="st">"40"</span>, <span class="co">#Quercus</span>
              <span class="st">"49"</span>, <span class="co">#Otros quercus</span>
              <span class="st">"50"</span>, <span class="co">#Mezcla de &lt;e1&gt;rboles de ribera</span>
              <span class="st">"59"</span>, <span class="co">#Otros &lt;e1&gt;rboles rip&lt;ed&gt;colas</span>
              <span class="st">"70"</span>, <span class="co">#Mezcla de frondosas de gran porte</span>
              <span class="st">"80"</span>, <span class="co">#Laurisilva</span>
              <span class="st">"89"</span>, <span class="co">#Otras laurisilvas</span>
              <span class="st">"90"</span>, <span class="co">#Mezcla de peque&lt;f1&gt;as frondosas</span>
              <span class="st">"99"</span>, <span class="co">#Otras frondosas</span>
              <span class="st">"1500"</span>, <span class="co"># Cultivo en mosaico</span>
              <span class="st">"8000"</span>, <span class="co"># Matorral en mosaico</span>
              <span class="st">"9000"</span>, <span class="co">#Herbazal en mosaico</span>
              <span class="st">"3400"</span>, <span class="co">#Prado en mosaico</span>
              <span class="st">"3500"</span>, <span class="co">#Pastizal-Matorral en mosaico</span>
              <span class="st">"103"</span>, <span class="co">#Otras papilionoideas altas</span>
              <span class="st">"104"</span>, <span class="co">#Otras papilionoideas bajas</span>
              <span class="st">"3104"</span>, <span class="co">#Genista (H.t.&lt;1,5 m)</span>
              <span class="st">"141"</span>, <span class="co">#Hedera helix</span>
              <span class="st">"149"</span> <span class="co">#Smilax aspera</span>
              <span class="op">)</span></code></pre></div>
<p>Remove taxa from the IFN taxonomic definition data frame:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">IFN_species_data</span> <span class="op">&lt;-</span> <span class="va">IFN_species_data</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span> <span class="op">%in%</span> <span class="va">codesOut</span><span class="op">)</span>, <span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 387   2</code></pre>
</div>
<div id="define-taxonomic-entities-to-merge-into-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#define-taxonomic-entities-to-merge-into-groups" class="anchor"></a>Define taxonomic entities to merge into groups</h3>
<p>Define genus-level taxa. These are necessary for taxa where the forest inventory records do not always have identifications at species-level resolution:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genus_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Acacia spp.:7/207/307"</span>,
                 <span class="st">"Adenocarpus spp.:2103/3163"</span>,
                 <span class="st">"Atriplex spp.:133"</span>,
                 <span class="st">"Artemisia spp.:126/159/1159"</span>,
                 <span class="st">"Asparagus spp.:138/1138/2138"</span>,
                 <span class="st">"Astragalus spp.:6104"</span>,
                 <span class="st">"Betula spp.:73/273/373"</span>,
                 <span class="st">"Bupleurum spp.:124/1124/2124"</span>,
                 <span class="st">"Calicotome spp.:2104/2105/9072"</span>,
                 <span class="st">"Chamaerops humilis:369/3690"</span>,
                 <span class="st">"Clematis spp.:132/1132/2132"</span>,
                 <span class="st">"Crataegus spp.:15/215/315/415/515"</span>,
                 <span class="st">"Coronilla spp.:152/1152/3152/5104"</span>,
                 <span class="st">"Cotoneaster spp.:118"</span>,
                 <span class="st">"Daphne spp.:110/1110/2110/3110"</span>,
                 <span class="st">"Dorycnium spp.:154/7104/1154"</span>,
                 <span class="st">"Echium sp.:161"</span>,
                 <span class="st">"Erinacea spp.:1104/1166"</span>,
                 <span class="st">"Eucalyptus spp.:60/61/62/63/64/264/364/464"</span>,
                 <span class="st">"Euphorbia spp.:162/1162/2162/3162"</span>,
                 <span class="st">"Fraxinus spp.:55/255/355/455"</span>,
                 <span class="st">"Genistella spp.:9104"</span>,
                 <span class="st">"Helianthemum spp.:142"</span>,
                 <span class="st">"Helichrysum spp.:128/2128"</span>,
                 <span class="st">"Larix spp.:35/235/335/435"</span>,
                 <span class="st">"Lavandula spp.:109/1109/2109/3109/4109"</span>,
                 <span class="st">"Lonicera spp.:144/1144/2144/3144/4144/5144/9012"</span>,
                 <span class="st">"Halimium spp.:117/1117/4117/5117/6117"</span>,
                 <span class="st">"Ilex spp.:65/82/282"</span>,
                 <span class="st">"Juglans spp.:75/275"</span>,
                 <span class="st">"Morus spp.:399/499/599"</span>,
                 <span class="st">"Ononis spp.:156/8104"</span>,
                 <span class="st">"Osyris spp.:135/1135/2135"</span>,
                 <span class="st">"Platanus spp.:79/279"</span>,
                 <span class="st">"Populus spp.:51/52/58/258"</span>,
                 <span class="st">"Phlomis spp.:171/1171/2171"</span>,
                 <span class="st">"Phoenix spp.:69/269/469"</span>,
                 <span class="st">"Prunus spp.:95/295/395/495/595/1095/1195/2950/148"</span>,
                 <span class="st">"Pyrus spp.:16/1165/2165"</span>,
                 <span class="st">"Retama spp.:4103"</span>,
                 <span class="st">"Rhamnus spp.:4/122/1122/2122/3122/4122/389/5122/6122"</span>,
                 <span class="st">"Rhododendron spp.:108"</span>,
                 <span class="st">"Ribes spp.:131/1131/2131"</span>,
                 <span class="st">"Rosa spp.:119"</span>,
                 <span class="st">"Rubus spp.:121/1121/2121/3121"</span>,
                 <span class="st">"Salix spp.:57/257/357/457/557/657/757/857/858/957"</span>,
                 <span class="st">"Sambucus spp.:97/197/297/2970"</span>,
                 <span class="st">"Santolina spp.:127/1127/2127"</span>,
                 <span class="st">"Sorbus spp.:78/278/378/478/578/678/778"</span>,
                 <span class="st">"Spartium spp.:3103/9103"</span>,
                 <span class="st">"Spiraea spp.:134/1134"</span>,
                 <span class="st">"Tamarix spp.:53/253"</span>,
                 <span class="st">"Teline spp.:165/9077/9078/9202"</span>,
                 <span class="st">"Teucrium spp.:179/1179"</span>,
                 <span class="st">"Tilia spp.:77/277/377"</span>,
                 <span class="st">"Thymelaea spp.:151"</span>,
                 <span class="st">"Thuja spp.:319"</span>,
                 <span class="st">"Thymus spp.:129/1129"</span>,
                 <span class="st">"Ulex spp.:157/1103/6103/3164"</span>,
                 <span class="st">"Ulmus spp.:56/256/356/456"</span>,
                 <span class="st">"Vaccinium spp.:137/1137"</span>,
                 <span class="st">"Viburnum spp.:115/1115/4115/3115/2115"</span>
                 <span class="op">)</span></code></pre></div>
<p>Define groups of taxa at species level, where different synonyms are merged, different codes have been used for the same species or the species have subspecies entities which we want to merge:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assimilated_species</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Acer campestre:76/776"</span>,
                       <span class="st">"Amelanchier ovalis:2/200"</span>,
                       <span class="st">"Buxus sempervirens:91/291/2910/9071/9100"</span>,
                       <span class="st">"Cistus albidus:101/3101"</span>,
                       <span class="st">"Cornus sanguinea:9/900"</span>,
                       <span class="st">"Cytisus fontanesii:9074"</span>,
                       <span class="st">"Cytisus scoparius:4104/1167/5103/8103"</span>,
                       <span class="st">"Cytisus commutatus:9011/9201/9481"</span>,
                       <span class="st">"Cytisus oromediterraneus:5155/4167"</span>,
                       <span class="st">"Erica scoparia:283/6102"</span>,
                       <span class="st">"Erica arborea:83/102/1102"</span>,
                       <span class="st">"Euonymus europaeus:5/500"</span>,
                       <span class="st">"Frangula alnus:3/300"</span>,
                       <span class="st">"Genista horrida:177"</span>, <span class="co"># Echinospartum horridum -&gt; Genista horrida</span>
                       <span class="st">"Genista cinerea:8155/1355"</span>,
                       <span class="st">"Genista scorpius:155/3155"</span>,
                       <span class="st">"Juniperus communis:37/3700"</span>,
                       <span class="st">"Juniperus phoenicea:39/238/239/1139"</span>,
                       <span class="st">"Medicago arborea:145/9076"</span>,
                       <span class="st">"Myrtus communis:6/600"</span>,
                       <span class="st">"Myrica faya:81/281"</span>,
                       <span class="st">"Pistacia terebinthus:93/9300"</span>,
                       <span class="st">"Quercus ilex:45/245"</span>,
                       <span class="st">"Quercus faginea:44/344"</span>,
                       <span class="st">"Quercus suber:46/646/746/846/946"</span>,
                       <span class="st">"Salvia rosmarinus:114"</span><span class="op">)</span> <span class="co"># Rosmarinus officinalis -&gt; Salvia rosmarinus</span></code></pre></div>
<p>Build a data frame with group names and codes.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">groups_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Groups"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">genus_level</span>,
                                     <span class="va">assimilated_species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">separate</span><span class="op">(</span><span class="st">"Groups"</span>, into<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group_names"</span>, <span class="st">"group_codes"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">":"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">groups_df</span><span class="op">)</span></code></pre></div>
<pre><code>##        group_names   group_codes
## 1      Acacia spp.     7/207/307
## 2 Adenocarpus spp.     2103/3163
## 3    Atriplex spp.           133
## 4   Artemisia spp.  126/159/1159
## 5   Asparagus spp. 138/1138/2138
## 6  Astragalus spp.          6104</code></pre>
</div>
<div id="initialize-species-parameter-table" class="section level3">
<h3 class="hasAnchor">
<a href="#initialize-species-parameter-table" class="anchor"></a>Initialize species parameter table</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"SpParamsDefinition"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/initSpParams.html">initSpParams</a></span><span class="op">(</span><span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNCODE</span>, <span class="va">IFN_species_data</span><span class="op">$</span><span class="va">IFNNAME</span>,
                             <span class="va">SpParamsDefinition</span>,
                             <span class="va">groups_df</span><span class="op">$</span><span class="va">group_codes</span>, <span class="va">groups_df</span><span class="op">$</span><span class="va">group_names</span>,
                             fill_taxonomic <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##                  Name  IFNcodes SpIndex  Genus      Order      Family
## 1          Abies alba        31       0  Abies    Pinales    Pinaceae
## 2       Abies pinsapo        32       1  Abies    Pinales    Pinaceae
## 3         Acacia spp. 7/207/307       2 Acacia    Fabales    Fabaceae
## 4      Acer campestre    76/776       3   Acer Sapindales Sapindaceae
## 5 Acer monspessulanum       276       4   Acer Sapindales Sapindaceae
## 6        Acer negundo       376       5   Acer Sapindales Sapindaceae
##        Group
## 1 Gymnosperm
## 2 Gymnosperm
## 3 Angiosperm
## 4 Angiosperm
## 5 Angiosperm
## 6 Angiosperm</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##   [1] "GrowthForm"           "LifeForm"             "LeafShape"           
##   [4] "LeafSize"             "PhenologyType"        "Hmed"                
##   [7] "Hmax"                 "Z50"                  "Z95"                 
##  [10] "fHDmin"               "fHDmax"               "a_ash"               
##  [13] "b_ash"                "a_bsh"                "b_bsh"               
##  [16] "a_btsh"               "b_btsh"               "cr"                  
##  [19] "a_fbt"                "b_fbt"                "c_fbt"               
##  [22] "d_fbt"                "a_cr"                 "b_1cr"               
##  [25] "b_2cr"                "b_3cr"                "c_1cr"               
##  [28] "c_2cr"                "a_cw"                 "b_cw"                
##  [31] "LeafDuration"         "Sgdd"                 "Tbgdd"               
##  [34] "Ssen"                 "Phsen"                "Tbsen"               
##  [37] "SLA"                  "LeafDensity"          "WoodDensity"         
##  [40] "FineRootDensity"      "conduit2sapwood"      "r635"                
##  [43] "pDead"                "Al2As"                "LeafWidth"           
##  [46] "SRL"                  "RLD"                  "maxFMC"              
##  [49] "minFMC"               "LeafPI0"              "LeafEPS"             
##  [52] "LeafAF"               "StemPI0"              "StemEPS"             
##  [55] "StemAF"               "SAV"                  "HeatContent"         
##  [58] "LigninPercent"        "ParticleDensity"      "gammaSWR"            
##  [61] "alphaSWR"             "kPAR"                 "g"                   
##  [64] "Tmax_LAI"             "Tmax_LAIsq"           "Psi_Extract"         
##  [67] "Psi_Critic"           "WUE"                  "pRootDisc"           
##  [70] "Gswmin"               "Gswmax"               "VCleaf_kmax"         
##  [73] "VCleaf_c"             "VCleaf_d"             "Kmax_stemxylem"      
##  [76] "VCstem_c"             "VCstem_d"             "Kmax_rootxylem"      
##  [79] "VCroot_c"             "VCroot_d"             "Narea"               
##  [82] "Vmax298"              "Jmax298"              "WoodC"               
##  [85] "RERleaf"              "RERsapwood"           "RERfineroot"         
##  [88] "RGRleafmax"           "RGRsapwoodmax"        "RGRfinerootmax"      
##  [91] "SeedProductionHeight" "RecrTreeDBH"          "RecrTreeHeight"      
##  [94] "RecrShrubHeight"      "RecrTreeDensity"      "RecrShrubCover"      
##  [97] "RecrZ50"              "RecrZ95"              "MinTempRecr"         
## [100] "MinMoistureRecr"      "MinFPARRecr"</code></pre>
</div>
</div>
<div id="populate-parameters-from-forest-inventory-data" class="section level2">
<h2 class="hasAnchor">
<a href="#populate-parameters-from-forest-inventory-data" class="anchor"></a>Populate parameters from forest inventory data</h2>
<div id="load-ifn-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-ifn-data" class="anchor"></a>Load IFN data</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrubDataIFN2</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/shrubDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">shrubDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">shrubDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>
<span class="va">shrubDataIFN3</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/shrubDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">shrubDataIFN4</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN4/Rdata/shrubDataIFN4_Spain.rds"</span><span class="op">)</span><span class="op">)</span>

<span class="va">piesMayoresDataIFN2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/piesMayoresDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN2/Rdata/piesMenoresDataIFN2_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">ID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>
<span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">Species</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">piesMenoresDataIFN2</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">treeDataIFN3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN3/Rdata/treeDataIFN3_Spain.rds"</span><span class="op">)</span><span class="op">)</span>
<span class="va">treeDataIFN4</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">IFN_path</span>,<span class="st">"Products/IFN4/Rdata/treeDataIFN4_Spain.rds"</span><span class="op">)</span><span class="op">)</span>

<span class="va">shrubDataIFN</span> <span class="op">&lt;-</span><span class="fu">bind_rows</span><span class="op">(</span><span class="va">shrubDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span>,
                         <span class="va">shrubDataIFN3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span>,
                         <span class="va">shrubDataIFN4</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="va">treeDataIFN</span> <span class="op">&lt;-</span><span class="fu">bind_rows</span><span class="op">(</span><span class="va">piesMayoresDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">piesMenoresDataIFN2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">treeDataIFN3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span>,
                        <span class="va">treeDataIFN4</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"Species"</span>, <span class="st">"H"</span>, <span class="st">"DBH"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
<div id="populate-growth-form" class="section level3">
<h3 class="hasAnchor">
<a href="#populate-growth-form" class="anchor"></a>Populate growth form</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">tree_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>

<span class="co"># Check species that appear both as trees and shrubs</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">shrub_codes</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">tree_codes</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateGrowthForm</a></span><span class="op">(</span><span class="va">SpParams</span>, 
                              <span class="va">tree_codes</span>, <span class="va">shrub_codes</span>,
                              erase_previous <span class="op">=</span> <span class="cn">TRUE</span>,
                              fill_fromGenus <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##  Tree: 75 shrub: 107 tree/shrub: 27 not found: 10</code></pre>
<pre><code>##  Tree input codes not in SpParams: 99,90,29,59,89,19,49</code></pre>
<pre><code>##  Shrub input codes not in SpParams: 103,104,224,222,192,100,99,10,199,229,402,302,141,149,1163,186,185,3104,0,1108,1105,3124,2163,2152,1172,1128,6161,3106,1013,1100,502,1148,1177,2129,172,1175,3117,1015,1188,1315,1010,1173,9101,3105,2149,405,1536,170,9262,9264,4156,174,9284,9282,2164,400,180,8010,8005,8007,1709,1706,1704,1707,9914,1710,1708,2509,2507,2502,2506,2505,9006</code></pre>
<pre><code>## Species 'Cistus creticus' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Cytisus commutatus' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Cytisus fontanesii' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista anglica' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista dorycnifolia' assigned growth form 'Shrub'</code></pre>
<pre><code>## Species 'Genista hystrix' assigned growth form 'Shrub'</code></pre>
<p>Manually set to tree the growth form of remaining species</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">missingGrowthFormSpecies</span> <span class="op">=</span> <span class="va">SpParams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Name"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">missingGrowthFormSpecies</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Dracaena drago"         "Pleiomeris canariensis" "Quercus lusitanica"    
## [4] "Sideroxylon marmulano"</code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span> <span class="op">%in%</span> <span class="va">missingGrowthFormSpecies</span><span class="op">]</span> <span class="op">=</span> <span class="st">"Tree"</span></code></pre></div>
</div>
<div id="populate-height" class="section level3">
<h3 class="hasAnchor">
<a href="#populate-height" class="anchor"></a>Populate height</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">species_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span>, <span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="va">height_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">treeDataIFN</span><span class="op">$</span><span class="va">H</span>, <span class="va">shrubDataIFN</span><span class="op">$</span><span class="va">H</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span> <span class="co"># m to cm</span>

<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateHeightParams</a></span><span class="op">(</span><span class="va">SpParams</span>,
                                 <span class="va">species_codes</span>, <span class="va">height_values</span>,
                                 erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## 162390 species/height missing values removed from input.</code></pre>
<pre><code>## 17511 zero height values removed from input.</code></pre>
<pre><code>## 10 missing Hmed/Hmax values (out of 219) after populating with input data.</code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   107   75         27
##   TRUE      6    4          0</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmax</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   113   79         27</code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   107   75         27
##   TRUE      6    4          0</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">[</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">==</span> <span class="st">"Shrub"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">Hmed</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE   113   79         27</code></pre>
</div>
<div id="populate-diameterheight-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#populate-diameterheight-ratio" class="anchor"></a>Populate diameter/height ratio</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tree_species_codes</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">Species</span>
<span class="va">tree_height_values</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">H</span><span class="op">*</span><span class="fl">100</span> <span class="co"># m to cm</span>
<span class="va">tree_diameter_values</span> <span class="op">&lt;-</span> <span class="va">treeDataIFN</span><span class="op">$</span><span class="va">DBH</span>

<span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateSpParamsFromInventory.html">populateTreeDiameterHeightParams</a></span><span class="op">(</span><span class="va">SpParams</span>,
                                             <span class="va">tree_species_codes</span>, 
                                             <span class="va">tree_height_values</span>,
                                             <span class="va">tree_diameter_values</span>,
                                             erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## 162374 species/height/diameter missing values removed from input.</code></pre>
<pre><code>## 17481 zero height/diameter values removed from input.</code></pre>
<pre><code>## 4 missing fHDmin/fHDmax values (out of 106 tree species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE     0   75         27
##   TRUE    113    4          0</code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE     0   75         27
##   TRUE    113    4          0</code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">!=</span> <span class="st">"Shrub"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmin</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE     0   79         27
##   TRUE    113    0          0</code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">$</span><span class="va">fHDmax</span><span class="op">)</span>, <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">)</span></code></pre></div>
<pre><code>##        
##         Shrub Tree Tree/Shrub
##   FALSE     0   79         27
##   TRUE    113    0          0</code></pre>
</div>
</div>
<div id="populate-allometric-coefficients" class="section level2">
<h2 class="hasAnchor">
<a href="#populate-allometric-coefficients" class="anchor"></a>Populate allometric coefficients</h2>
<div id="shrub-allometric-equations" class="section level3">
<h3 class="hasAnchor">
<a href="#shrub-allometric-equations" class="anchor"></a>Shrub allometric equations</h3>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">medfuels</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_area"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_fine"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sp_params_total"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_area"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_fine"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"group_params_total"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"species_groups"</span><span class="op">)</span></code></pre></div>
<p>Correct synonymy mistakes</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"Genus"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Salvia"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"Species"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"rosmarinus"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"author"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Schleid."</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Rosmarinus officinalis"</span>,<span class="st">"name"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Salvia rosmarinus"</span>

<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"Genus"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Lithodora"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"Species"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"fruticosa"</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"author"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"(L.) Griseb."</span>
<span class="va">species_groups</span><span class="op">[</span><span class="va">species_groups</span><span class="op">$</span><span class="va">name</span><span class="op">==</span><span class="st">"Lithospermum fruticosum"</span>,<span class="st">"name"</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"Lithodora fruticosa"</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_sel</span> <span class="op">&lt;-</span><span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">retrieveCoefficientsFromMedfuels</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">sp_params_allom</span>, <span class="va">group_params_allom</span>, <span class="va">species_groups</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">a_coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">b_coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">sp_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">)</span>
  <span class="va">gr_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">)</span>
  <span class="va">gen_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span>, <span class="va">species_groups</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
  <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">growth_form</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="va">nshrub</span> <span class="op">+</span><span class="fl">1</span>
      <span class="va">nm</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
      <span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">nm</span>,<span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
      <span class="kw">if</span><span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">sp_allom</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species-specific allometry available</span>
        <span class="va">sp_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sp_allom</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">gen_sp</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species is found in medfuels species table</span>
        <span class="va">form_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gen_sp</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
        <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="va">form_raunkiaer</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">gen</span> <span class="op">%in%</span> <span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If genus occurs in medfuels table</span>
        <span class="va">forms_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">==</span><span class="va">gen</span><span class="op">)</span><span class="op">]</span>
        <span class="co"># Find most-frequent  raunkiaer form</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">forms_raunkiaer</span><span class="op">)</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="va">tfr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">tfr</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>
        <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> 
        <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
        <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="va">nmis</span> <span class="op">+</span> <span class="fl">1</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span><span class="op">==</span><span class="st">"Tree/Shrub"</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If tree/shrub assing MPh data</span>
          <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved and will be assigned 'MP'."</span><span class="op">)</span><span class="op">)</span>
          <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"a"</span><span class="op">]</span>
          <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"b"</span><span class="op">]</span>
        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
          <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved and will be assigned 'NP'."</span><span class="op">)</span><span class="op">)</span>
          <span class="va">a_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"NP"</span>,<span class="st">"a"</span><span class="op">]</span>
          <span class="va">b_coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"NP"</span>,<span class="st">"b"</span><span class="op">]</span>
        <span class="op">}</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">nmis</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">nmis</span>,
                            <span class="st">" missing values (out of "</span>,
                            <span class="va">nshrub</span>,
                            <span class="st">" shrub species) after populating with input data.\n"</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span>, 
                    GrothForm <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span>,
                    a <span class="op">=</span> <span class="va">a_coef</span>, b <span class="op">=</span> <span class="va">b_coef</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">area_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_area</span>, 
                                                 <span class="va">group_params_area</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_ash</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">area_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_ash</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">area_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>

<span class="va">fine_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_fine</span>, 
                                                 <span class="va">group_params_fine</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_bsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fine_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_bsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fine_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>

<span class="va">total_coef_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveCoefficientsFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, 
                                                 <span class="va">sp_params_total</span>, 
                                                 <span class="va">group_params_total</span>, 
                                                 <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved and will be assigned 'MP'.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved and will be assigned 'NP'.</code></pre>
<pre><code>## 13 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span><span class="op">$</span><span class="va">a_btsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">total_coef_df</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">b_btsh</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">total_coef_df</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span></code></pre></div>
</div>
<div id="shrub-crown-ratio-and-pdead" class="section level3">
<h3 class="hasAnchor">
<a href="#shrub-crown-ratio-and-pdead" class="anchor"></a>Shrub crown ratio and Pdead</h3>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_pdead_cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">Database_path</span>,<span class="st">"AllometryDatabases/ShrubAllometries/Shrub_Pdead_CR.txt"</span><span class="op">)</span>, 
                             sep<span class="op">=</span><span class="st">"\t"</span>, dec<span class="op">=</span><span class="st">","</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">separate</span><span class="op">(</span><span class="va">Name</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Species"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">unite</span><span class="op">(</span><span class="st">"Name"</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Genus"</span>, <span class="st">"Species"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 26 rows [1, 2, 3, 4,
## 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].</code></pre>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 7 rows [28, 29,
## 30, 31, 32, 33, 34].</code></pre>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shrub_cr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">CR.mean</span>,
                     row.names <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span>
<span class="va">shrub_pdead</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Pdead.mean</span>,
                     row.names <span class="op">=</span> <span class="va">shrub_pdead_cr</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span>

<span class="va">sp_params_allom</span> <span class="op">=</span> <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
<span class="va">group_params_allom</span> <span class="op">=</span> <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">retrieveValuesFromMedfuels</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">sp_params_allom</span>, 
                                       <span class="va">group_params_allom</span>, <span class="va">species_groups</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">sp_params_allom</span> <span class="op">&lt;-</span><span class="va">sp_params_allom</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
  <span class="va">group_params_allom</span> <span class="op">&lt;-</span><span class="va">group_params_allom</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
  <span class="va">coef</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span>
  <span class="va">sp_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">sp_params_allom</span><span class="op">)</span>
  <span class="va">gr_allom</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">group_params_allom</span><span class="op">)</span>
  <span class="va">gen_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span>, <span class="va">species_groups</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
  <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">SpParams</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">growth_form</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">growth_form</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Shrub"</span>, <span class="st">"Tree/Shrub"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">nshrub</span> <span class="op">&lt;-</span> <span class="va">nshrub</span> <span class="op">+</span><span class="fl">1</span>
      <span class="va">nm</span> <span class="op">&lt;-</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
      <span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">nm</span>,<span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
      <span class="kw">if</span><span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">sp_allom</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species-specific allometry available</span>
        <span class="va">sp_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sp_allom</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span> 
        <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">sp_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">sp_row</span><span class="op">]</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">nm</span> <span class="op">%in%</span> <span class="va">gen_sp</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If species is found in medfuels species table</span>
        <span class="va">form_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gen_sp</span><span class="op">==</span><span class="va">nm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">form_raunkiaer</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="va">form_raunkiaer</span><span class="op">)</span> 
          <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="op">}</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">gen</span> <span class="op">%in%</span> <span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If genus occurs in medfuels table</span>
        <span class="va">forms_raunkiaer</span> <span class="op">&lt;-</span>  <span class="va">species_groups</span><span class="op">$</span><span class="va">`shrub type`</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species_groups</span><span class="op">$</span><span class="va">Genus</span><span class="op">==</span><span class="va">gen</span><span class="op">)</span><span class="op">]</span>
        <span class="co"># Find most-frequent  raunkiaer form</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">forms_raunkiaer</span><span class="op">)</span>
        <span class="va">tfr</span><span class="op">&lt;-</span><span class="va">tfr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">tfr</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span>
        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">gr_row</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gr_allom</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">tfr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
          <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">gr_row</span><span class="op">]</span>
        <span class="op">}</span> 
      <span class="op">}</span> 
      
      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>  <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="va">growth_form</span><span class="op">==</span><span class="st">"Tree/Shrub"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span><span class="st">"MP"</span> <span class="op">%in%</span> <span class="va">gr_allom</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span> <span class="co"># If tree/shrub assing MPh data</span>
        <span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">group_params_allom</span><span class="op">[</span><span class="st">"MP"</span>,<span class="st">"value"</span><span class="op">]</span>
      <span class="op">}</span> 
      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">coef</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data for '"</span>, <span class="va">nm</span>,<span class="st">"' could not be retrieved."</span><span class="op">)</span><span class="op">)</span>
        <span class="va">nmis</span> <span class="op">&lt;-</span> <span class="va">nmis</span> <span class="op">+</span> <span class="fl">1</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">nmis</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">nmis</span>,
                            <span class="st">" missing values (out of "</span>,
                            <span class="va">nshrub</span>,
                            <span class="st">" shrub species) after populating with input data.\n"</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">Name</span>, 
                    GrothForm <span class="op">=</span> <span class="va">SpParams</span><span class="op">$</span><span class="va">GrowthForm</span>,
                    coef <span class="op">=</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">cr_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveValuesFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">shrub_cr</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Artemisia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Asparagus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Astragalus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Berberis vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Betula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Bupleurum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Calluna vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaecytisus proliferus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaespartium tridentatum' could not be retrieved.</code></pre>
<pre><code>## Data for 'Cistus crispus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Dorycnium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica australis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica ciliaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica tetralix' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica vagans' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erinacea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Eucalyptus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euphorbia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista hispanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista horrida' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista triflora' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Halimium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helianthemum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helichrysum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Hypericum canariensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ilex spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus oxycedrus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus phoenicea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved.</code></pre>
<pre><code>## Data for 'Laurus nobilis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lavandula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lithodora spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Myrtus communis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Nerium oleander' could not be retrieved.</code></pre>
<pre><code>## Data for 'Olea europaea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ononis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Paliurus spina-christi' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phlomis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia terebinthus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Prunus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pyrus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus ilex' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus robur' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rhamnus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rumex lunaria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ruscus aculeatus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Salix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Sambucus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Santolina spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Spartium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Teucrium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymelaea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vaccinium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vella spinosa' could not be retrieved.</code></pre>
<pre><code>## Data for 'Viburnum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved.</code></pre>
<pre><code>## 70 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pdead_df</span> <span class="op">&lt;-</span> <span class="fu">retrieveValuesFromMedfuels</span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">shrub_pdead</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">27</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">shrub_pdead</span><span class="op">[</span><span class="fl">28</span><span class="op">:</span><span class="fl">34</span>,, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, <span class="va">species_groups</span><span class="op">)</span></code></pre></div>
<pre><code>## Data for 'Ampelodesmos mauritanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Aphyllanthes monspeliensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Artemisia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Asparagus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Astragalus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Berberis vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Betula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Bupleurum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Calluna vulgaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaecytisus proliferus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Chamaespartium tridentatum' could not be retrieved.</code></pre>
<pre><code>## Data for 'Cistus crispus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Clematis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Daboecia cantabrica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Dorycnium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Echium sp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica australis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica ciliaris' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica tetralix' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erica vagans' could not be retrieved.</code></pre>
<pre><code>## Data for 'Erinacea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Eucalyptus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euonymus europaeus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Euphorbia spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Flueggea tinctoria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Frangula alnus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista hispanica' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista horrida' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista triflora' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genista umbellata' could not be retrieved.</code></pre>
<pre><code>## Data for 'Genistella spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Halimium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Heberdenia bahamensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helianthemum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Helichrysum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Hypericum canariensis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ilex spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus oxycedrus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Juniperus phoenicea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Kleinia neriifolia' could not be retrieved.</code></pre>
<pre><code>## Data for 'Laurus nobilis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lavandula spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Lithodora spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Myrtus communis' could not be retrieved.</code></pre>
<pre><code>## Data for 'Nerium oleander' could not be retrieved.</code></pre>
<pre><code>## Data for 'Olea europaea' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ononis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Paliurus spina-christi' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phlomis spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Phoenix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia lentiscus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pistacia terebinthus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Prunus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Pyrus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus ilex' could not be retrieved.</code></pre>
<pre><code>## Data for 'Quercus robur' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rhamnus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Rumex lunaria' could not be retrieved.</code></pre>
<pre><code>## Data for 'Ruscus aculeatus' could not be retrieved.</code></pre>
<pre><code>## Data for 'Salix spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Sambucus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Santolina spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Spartium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Teucrium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymelaea spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Thymus spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vaccinium spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Vella spinosa' could not be retrieved.</code></pre>
<pre><code>## Data for 'Viburnum spp.' could not be retrieved.</code></pre>
<pre><code>## Data for 'Zizyphus lotus' could not be retrieved.</code></pre>
<pre><code>## 71 missing values (out of 140 shrub species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">SpParams</span><span class="op">$</span><span class="va">cr</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">cr_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span>
<span class="va">SpParams</span><span class="op">$</span><span class="va">pDead</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span> <span class="op">&lt;-</span><span class="va">pdead_df</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">shrub_sel</span><span class="op">]</span></code></pre></div>
</div>
<div id="tree-allometries" class="section level3">
<h3 class="hasAnchor">
<a href="#tree-allometries" class="anchor"></a>Tree allometries</h3>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fb_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">Database_path</span>, <span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_FB_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cr_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">Database_path</span>,<span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_CR_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cw_models</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">Database_path</span>,<span class="st">"AllometryDatabases/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>, sheet<span class="op">=</span> <span class="st">"Tree_CW_models"</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">fb_models</span>, <span class="st">"foliarbiomass"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 24 genus: 17 family: 0 order:0 group: 0</code></pre>
<pre><code>## 65 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">cr_models</span>, <span class="st">"crownratio"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 4 genus: 11 family: 0 order:0 group: 0</code></pre>
<pre><code>## 91 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SpParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/medfateutils/man/populateTreeAllometries.html">populateTreeAllometries</a></span><span class="op">(</span><span class="va">SpParams</span>, <span class="va">cw_models</span>, <span class="st">"crownwidth"</span>, erase_previous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Assignments species: 11 genus: 18 family: 0 order:0 group: 0</code></pre>
<pre><code>## 77 missing allometry coefficients (out of 106 tree species) after populating with input data.</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Miquel De Cáceres, Shengli Huang, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
