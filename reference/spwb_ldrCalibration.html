<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calibration of root distribution — spwb_ldrCalibration • medfate</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calibration of root distribution — spwb_ldrCalibration" />
<meta property="og:description" content="The function spwb_ldrCalibration calibrates the species root
distribution within spwb, given the arguments x, meteo,
psi_crit, obs and calibVar. This calibration
is based on reference measured values. These reference measured values can be
Soil water content, Total tranpiration or Transpiration by
cohort. Return the calibrated root distribution for each tree species (no
shrub calibration is done), expressed as parameters of the function
root_ldrDistribution." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/emf-creaf/medfate/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calibration of root distribution</h1>
    
    <div class="hidden name"><code>spwb_ldrCalibration.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>spwb_ldrCalibration</code> calibrates the species root
distribution within <code><a href='spwb.html'>spwb</a></code>, given the arguments <code>x</code>, <code>meteo</code>,
<code>psi_crit</code>, <code>obs</code> and <code>calibVar</code>. This calibration
is based on reference measured values. These reference measured values can be
<code>Soil water content</code>, <code>Total tranpiration</code> or <code>Transpiration by
cohort</code>. Return the calibrated root distribution for each tree species (no
shrub calibration is done), expressed as parameters of the function
<code><a href='root.html'>root_ldrDistribution</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>spwb_ldrCalibration</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>meteo</span>, <span class='va'>calibVar</span>, <span class='va'>obs</span>,
                   RZmin <span class='op'>=</span> <span class='fl'>301</span>, RZmax <span class='op'>=</span> <span class='fl'>4000</span>,
                   V1min <span class='op'>=</span> <span class='fl'>0.01</span>, V1max <span class='op'>=</span> <span class='fl'>0.94</span>, resolution <span class='op'>=</span> <span class='fl'>20</span>, heat_stop <span class='op'>=</span> <span class='fl'>0</span>, 
                   transformation <span class='op'>=</span> <span class='st'>"identity"</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class <code><a href='modelInput.html'>spwbInput</a></code>.</p></td>
    </tr>
    <tr>
      <th>meteo</th>
      <td><p>A data frame with daily meteorological data series. When using the 'Granier' transpiration mode the following columns are required:</p><ul>
<li><p><code>DOY</code>: Day of the year (Julian day).</p></li>
<li><p><code>Precipitation</code>: Precipitation (in mm).</p></li>
<li><p><code>MeanTemperature</code>: Mean temperature (in degrees Celsius).</p></li>
<li><p><code>PET</code>: Potential evapotranspiration (in mm).</p></li>
</ul><p></p></td>
    </tr>
    <tr>
      <th>calibVar</th>
      <td><p>A character string indicating the calibration variable to be used.
                  It can be one of the following: <code>SWC</code>, <code>Eplanttot</code>
                  or <code>Cohorts</code>.</p></td>
    </tr>
    <tr>
      <th>obs</th>
      <td><p>Measured calibration variable. Depending on the value of <code>calibVar</code>
             it can be a numeric vector with the measured SWC values (if
             <code>calibVar = "SWC"</code>), or a data frame with the first column
             containing the measured total transpiration (named <code>Eplanttot</code>) and
             the following columns containing the cohorts transpiration.</p></td>
    </tr>
    <tr>
      <th>RZmin</th>
      <td><p>The minimum value of RZ (the rooting depth) to be explored (in mm)</p></td>
    </tr>
    <tr>
      <th>RZmax</th>
      <td><p>The maximum value of RZ (the rooting depth) to be explored (in mm)</p></td>
    </tr>
    <tr>
      <th>V1min</th>
      <td><p>The minimum value of V1 (the root proportion in the first soil layer) to be explored</p></td>
    </tr>
    <tr>
      <th>V1max</th>
      <td><p>The maximum value of V1 (the root proportion in the first soil layer) to be explored</p></td>
    </tr>
    <tr>
      <th>resolution</th>
      <td><p>An integer defining the number of values to obtain by discretization of the root parameters RZ and V1. The number of parameter combinations and therefore the computation cost increases increase with the square of resolution</p></td>
    </tr>
    <tr>
      <th>transformation</th>
      <td><p>Function to modify the size of Z intervals to be explored (by default, bins are equal).</p></td>
    </tr>
    <tr>
      <th>heat_stop</th>
      <td><p>An integer defining the number of days during to discard from the calculation of the optimal root distribution. Usefull if the soil water content initialization is not certain</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical value. Print the internal messages of the function?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function performs three different kinds of calibration, selecting those
root distribution parameters that minimize the MAE between the predicted values
and the measured values provided in <code>obs</code> argument. If <code>calibVar = "SWC"</code> different
V1 values are tested running <code><a href='spwb.html'>spwb</a></code> maintaining the total soil depth
provided in <code>x</code> and assuming that value is also the depth containing 95 percent of the
roots. If <code>calibVar = "Eplanttot"</code> or <code>calibVar = 'Cohorts'</code> different 
combinations of RZ and V1 values are tested for each tree cohort and the root
paramters are selected based on the MAE between the total transpiration or the
cohort transpiration.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>THe function returns a data frame containing the species index used in medfate,
calibrated values for Z50, Z95 and V1 and the MAE value for that combination.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Víctor Granda, CREAF</p>
<p>Antoine Cabon, CTFC-CREAF</p>
<p>Miquel De Cáceres Ainsa, CREAF</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='spwb_ldrOptimization.html'>spwb_ldrOptimization</a></code> for when no measured data is available,
 <code><a href='spwb.html'>spwb</a></code>, <code><a href='soil.html'>soil</a></code>, <code><a href='root.html'>root_ldrDistribution</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Miquel De Cáceres, Shengli Huang, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


