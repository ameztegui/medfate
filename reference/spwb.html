<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Soil-plant water balance — spwb • medfate</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Soil-plant water balance — spwb" />
<meta property="og:description" content="Function spwb() is a water balance model that determines changes in soil moisture, soil water potentials, plant transpiration and drought stress at daily steps for a given forest stand during a period specified in the input climatic data. Function pwb() performs plant water balance only (i.e. soil moisture dynamics is an input) at daily steps for a given forest stand during a period specified in the input climatic data. On both simulation functions plant transpiration and photosynthesis processes are conducted with different level of detail depending on the transpiration mode." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/emf-creaf/medfate/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Soil-plant water balance</h1>
    
    <div class="hidden name"><code>spwb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>spwb()</code> is a water balance model that determines changes in soil moisture, soil water potentials, plant transpiration and drought stress at daily steps for a given forest stand during a period specified in the input climatic data. Function <code>pwb()</code> performs plant water balance only (i.e. soil moisture dynamics is an input) at daily steps for a given forest stand during a period specified in the input climatic data. On both simulation functions plant transpiration and photosynthesis processes are conducted with different level of detail depending on the transpiration mode.</p>
    </div>

    <pre class="usage"><span class='fu'>spwb</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>meteo</span>,  <span class='va'>latitude</span> , elevation <span class='op'>=</span> <span class='cn'>NA</span>, slope <span class='op'>=</span> <span class='cn'>NA</span>, aspect <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>
<span class='fu'>pwb</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>meteo</span>, <span class='va'>W</span>, <span class='va'>latitude</span>, elevation <span class='op'>=</span> <span class='cn'>NA</span>, slope <span class='op'>=</span> <span class='cn'>NA</span>, aspect <span class='op'>=</span> <span class='cn'>NA</span>,
    canopyEvaporation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, 
    snowMelt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, 
    soilEvaporation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class <code><a href='modelInput.html'>spwbInput</a></code>.</p></td>
    </tr>
    <tr>
      <th>meteo</th>
      <td><p>A data frame with daily meteorological data series. Row names of the data frame should correspond to date strings with format "yyyy-mm-dd" (see <code><a href='https://rdrr.io/r/base/Dates.html'>Date</a></code>). When using the 'Granier' transpiration mode the following columns are required:</p><ul>
<li><p><code>MeanTemperature</code>: Mean temperature (in degrees Celsius).</p></li>
<li><p><code>Precipitation</code>: Precipitation (in mm).</p></li>
<li><p><code>Radiation</code>: Solar radiation (in MJ/m2/day), required only if <code>snowpack = TRUE</code>.</p></li>
<li><p><code>PET</code>: Potential evapotranspiration (in mm).</p></li>
</ul><p>When using the 'Sperry' transpiration mode the following columns are required:</p><ul>
<li><p><code>MeanTemperature</code>: Mean temperature (in degrees Celsius).</p></li>
<li><p><code>MinTemperature</code>: Minimum temperature (in degrees Celsius).</p></li>
<li><p><code>MaxTemperature</code>: Maximum temperature (in degrees Celsius).</p></li>
<li><p><code>MinRelativeHumidity</code>: Minimum relative humidity (in percent).</p></li>
<li><p><code>MaxRelativeHumidity</code>: Maximum relative humidity (in percent).</p></li>
<li><p><code>Precipitation</code>: Precipitation (in mm).</p></li>
<li><p><code>Radiation</code>: Solar radiation (in MJ/m2/day).</p></li>
<li><p><code>WindSpeed</code>: Wind speed (in m/s). If not available, this column can be left with <code>NA</code> values.</p></li>
</ul><p></p></td>
    </tr>
    <tr>
      <th>W</th>
      <td><p>A matrix with the same number of rows as <code>meteo</code> and as many columns as soil layers, containing the soil moisture of each layer as proportion of field capacity.</p></td>
    </tr>
    <tr>
      <th>latitude</th>
      <td><p>Latitude (in degrees).</p></td>
    </tr>
    <tr>
      <th>elevation, slope, aspect</th>
      <td><p>Elevation above sea level (in m), slope (in degrees) and aspect (in degrees from North). Required when using the 'Sperry' transpiration mode. Elevation is also required for 'Granier' if snowpack dynamics are simulated.</p></td>
    </tr>
    <tr>
      <th>canopyEvaporation</th>
      <td><p>A vector of daily canopy evaporation (from interception) values (mm). The length should match the number of rows in <code>meteo</code>.</p></td>
    </tr>
    <tr>
      <th>soilEvaporation</th>
      <td><p>A vector of daily bare soil evaporation values (mm). The length should match the number of rows in <code>meteo</code>.</p></td>
    </tr>
    <tr>
      <th>snowMelt</th>
      <td><p>A vector of daily snow melt values (mm). The length should match the number of rows in <code>meteo</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The model using 'Granier' transpiration mode is illustrated by function <code><a href='transp_modes.html'>transp_transpirationGranier</a></code> and described in De Caceres et al. (2015). Simulations using the 'Sperry' transpiration mode are computationally much more expensive, are described in De Cáceres et al. (2021) and are illustrated by function <code><a href='transp_modes.html'>transp_transpirationSperry</a></code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function <code>spwb</code> returns a list of class 'spwb' whereas Function <code>pwb</code> returns a list of class 'pwb'. There are many elements in common in these lists, so they are listed here together:</p><ul>
<li><p><code>"latitude"</code>: Latitude (in degrees) given as input.</p></li>
<li><p><code>"topography"</code>: Vector with elevation, slope and aspect given as input.</p></li>
<li><p><code>"spwbInput"</code>: An (unmodified) copy of the object <code>x</code> of class <code><a href='modelInput.html'>spwbInput</a></code> given as input  (note that <code>x</code> is modified by the simulation function).</p></li>
<li><p><code>"WaterBalance"</code>: A data frame where different variables (in columns) are given for each simulated day (in rows):</p><ul>
<li><p><code>"PET"</code>: Potential evapotranspiration (in mm).</p></li>
<li><p><code>"Precipitation"</code>: Input precipitation (in mm).</p></li>
<li><p><code>"Rain"</code>: Precipitation as rain (in mm).</p></li>
<li><p><code>"Snow"</code>: Precipitation as snow (in mm).</p></li>
<li><p><code>"NetRain"</code>: Net rain, after accounting for interception (in mm).</p></li>
<li><p><code>"Infiltration"</code>: The amount of water infiltrating into the soil (in mm).</p></li>
<li><p><code>"Runoff"</code>: The amount of water exported via surface runoff (in mm).</p></li>
<li><p><code>"DeepDrainage"</code>: The amount of water exported via deep drainage (in mm).</p></li>
<li><p><code>"Evapotranspiration"</code>: Evapotranspiration (in mm).</p></li>
<li><p><code>"SoilEvaporation"</code>: Bare soil evaporation (in mm).</p></li>
<li><p><code>"PlantExtraction"</code>: Amount of water extracted from soil by plants (in mm) (can only be different from transpiration for <code>transpirationMode = "Sperry"</code> when capacitance is considered).</p></li>
<li><p><code>"Transpiration"</code>: Plant transpiration (considering all soil layers) (in mm).</p></li>
<li><p><code>"HydraulicRedistribution"</code>: Water redistributed among soil layers, transported through the plant hydraulic network (only for <code>transpirationMode = "Sperry"</code>).</p></li>
</ul></li>
<li><p><code>"EnergyBalance"</code>: A data frame with the daily values of energy balance components for the soil and the canopy (only for <code>transpirationMode = "Sperry"</code>).</p></li>
<li><p><code>"Temperature"</code>: A data frame with the daily values of minimum/mean/maximum temperatures for the atmosphere (input), canopy and soil (only for <code>transpirationMode = "Sperry"</code>).</p></li>
<li><p><code>"Soil"</code>: A data frame where different variables (in columns) are given for each simulated day (in rows):</p><ul>
<li><p><code>"W.1"</code>, <code>...</code>, <code>"W.k"</code>: Relative soil moisture content (relative to field capacity) in each soil layer.</p></li>
<li><p><code>"ML.1"</code>, <code>...</code>, <code>"ML.k"</code>: Soil water volume in each soil layer (in L/m2).</p></li>
<li><p><code>"MLTot"</code>: Total soil water volume (in L/m2).</p></li>
<li><p><code>"SWE"</code>: Snow water equivalent (mm) of the snow pack.</p></li>
<li><p><code>"PlantExt.1"</code>, <code>...</code>, <code>"PlantExt.k"</code>: Plant extraction from each soil layer (in mm).</p></li>
<li><p><code>"HydraulicInput.1"</code>, <code>...</code>, <code>"HydraulicInput.k"</code>: Water that entered the layer coming from other layers and transported via the plant hydraulic network (in mm) (only for <code>transpirationMode = "Sperry"</code>).</p></li>
<li><p><code>"psi.1"</code>, <code>...</code>, <code>"psi.k"</code>: Soil water potential in each soil layer (in MPa).</p></li>
</ul></li>
<li><p><code>"Stand"</code>: A data frame where different variables (in columns) are given for each simulated day (in rows):</p>      
<p></p><ul>
<li><p><code>"LAI"</code>: LAI of the stand (including live and dead leaves) (in m2/m2).</p></li>
<li><p><code>"LAIlive"</code>: LAI of the stand assuming all leaves are unfolded (in m2/m2).</p></li>
<li><p><code>"LAIexpanded"</code>: LAI of the stand of leaves actually unfolded (in m2/m2).</p></li>
<li><p><code>"LAIdead"</code>: LAI of the stand corresponding to dead leaves (in m2/m2).</p></li>
<li><p><code>"Cm"</code>: Water retention capacity of the canopy (in mm) (accounting for leaf phenology).</p></li>
<li><p><code>"LgroundPAR"</code>: The proportion of PAR that reaches the ground (accounting for leaf phenology).</p></li>
<li><p><code>"LgroundSWR"</code>: The proportion of SWR that reaches the ground (accounting for leaf phenology).</p></li>
</ul></li>
<li><p><code>"Plants"</code>: A list of daily results for plant cohorts (see below).</p></li>
<li><p><code>"subdaily"</code>: A list of objects of class <code><a href='spwb_day.html'>spwb_day</a></code>, one per day simulated (only if required in <code>control</code> parameters, see <code><a href='defaultControl.html'>defaultControl</a></code>).</p></li>
</ul>
 
<p>When <code>transpirationMode = "Granier"</code>, element <code>"Plants"</code> is a list with the following subelements:</p><ul>
<li><p><code>"LAI"</code>: A data frame with the daily leaf area index for each plant cohort.</p></li>
<li><p><code>"AbsorbedSWRFraction"</code>: A data frame with the fraction of SWR absorbed by each plant cohort.</p></li>
<li><p><code>"Transpiration"</code>: A data frame with the amount of daily transpiration (in mm) for each plant cohort.</p></li>
<li><p><code>"GrossPhotosynthesis"</code>: A data frame with the amount of daily gross photosynthesis (in g C·m-2) for each plant cohort.</p></li>
<li><p><code>"PlantPsi"</code>: A data frame with the average daily water potential of each plant (in MPa).</p></li>
<li><p><code>"PlantStress"</code>: A data frame with the amount of daily stress [0-1] suffered by each plant cohort (relative whole-plant conductance).</p></li>
</ul><p>If <code>transpirationMode="Sperry"</code>, element <code>"Plants"</code> is a list with the following subelements:</p><ul>
<li><p><code>"LAI"</code>: A data frame with the daily leaf area index for each plant cohort.</p></li>
<li><p><code>"AbsorbedSWR"</code>: A data frame with the daily SWR absorbed by each plant cohort.</p></li>
<li><p><code>"NetLWR"</code>: A data frame with the daily net LWR by each plant cohort.</p></li>
<li><p><code>"Transpiration"</code>: A data frame with the amount of daily transpiration (in mm) for each plant cohorts.</p></li>
<li><p><code>"GrossPhotosynthesis"</code>: A data frame with the amount of daily gross photosynthesis (in g C·m-2) for each plant cohort.</p></li>
<li><p><code>"NetPhotosynthesis"</code>: A data frame with the amount of daily net photosynthesis (in g C·m-2) for each plant cohort.</p></li>
<li><p><code>"dEdP"</code>: A data frame with mean daily values of soil-plant conductance (derivative of the supply function) for each plant cohort.</p></li>
<li><p><code>"PlantWaterBalance"</code>: A data frame with the daily balance between transpiration and soil water extraction for each plant cohort.</p></li>
<li><p><code>"SunlitLeaves"</code> and <code>"ShadeLeaves"</code>: A list with daily results for sunlit and shade leaves:
     <ul>
<li><p><code>"PsiMin"</code>: A data frame with the minimum (midday) daily sunlit or shade leaf water potential (in MPa).</p></li>
<li><p><code>"PsiMax"</code>: A data frame with the maximum (predawn) daily sunlit or shade leaf water potential (in MPa).</p></li>
</ul></p></li>
<li><p><code>"LeafPsiMin"</code>: A data frame with the minimum (midday) daily (average) leaf water potential of each plant (in MPa).</p></li>
<li><p><code>"LeafPsiMax"</code>: A data frame with the maximum (predawn) daily (average) leaf water potential of each plant (in MPa).</p></li>
<li><p><code>"LeafRWC"</code>: A data frame with the average daily leaf relative water content of each plant (in percent).</p></li>
<li><p><code>"StemRWC"</code>: A data frame with the average daily stem relative water content of each plant (in percent).</p></li>
<li><p><code>"LeafSympRWC"</code>: A data frame with the average daily leaf symplasm relative water content of each plant (in percent).</p></li>
<li><p><code>"StemSympRWC"</code>: A data frame with the average daily stem symplasm relative water content of each plant (in percent).</p></li>
<li><p><code>"StemPsi"</code>: A data frame with the minimum daily stem water potential of each plant (in MPa).</p></li>
<li><p><code>"StemPLC"</code>: A data frame with the average daily proportion of stem conductance loss of each plant ([0-1]).</p></li>
<li><p><code>"RootPsi"</code>: A data frame with the minimum daily root water potential of each plant (in MPa).</p></li>
<li><p><code>"RhizoPsi"</code>: A list of data frames (one per plant cohort) with the minimum daily root water potential of each plant (in MPa).</p></li>
<li><p><code>"PlantStress"</code>: A data frame with the amount of daily stress [0-1] suffered by each plant cohort (relative whole-plant conductance).</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>De Cáceres M, Martínez-Vilalta J, Coll L, Llorens P, Casals P, Poyatos R, Pausas JG, Brotons L. (2015) Coupling a water balance model with forest inventory data to predict drought stress: the role of forest structural changes vs. climate changes. Agricultural and Forest Meteorology 213: 77-90 (doi:10.1016/j.agrformet.2015.06.012).</p>
<p>De Cáceres M, Mencuccini M, Martin-StPaul N, Limousin JM, Coll L, Poyatos R, Cabon A, Granda V, Forner A, Valladares F, Martínez-Vilalta J (2021) Unravelling the effect of species mixing on water use and drought stress in holm oak forests: a modelling approach. Agricultural and Forest Meteorology 296 (doi:10.1016/j.agrformet.2020.108233).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Miquel De Cáceres Ainsa, CREAF</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>State variables stored in objects <code>x</code> are modified during the simulation, unless control parameter <code>modifyInput = FALSE</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='modelInput.html'>spwbInput</a></code>, <code><a href='spwb_day.html'>spwb_day</a></code>, <code><a href='plot.spwb.html'>plot.spwb</a></code>,  
<code><a href='spwb_ldrOptimization.html'>spwb_ldrOptimization</a></code>, <code><a href='forest.html'>forest</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Load example daily meteorological data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>examplemeteo</span><span class='op'>)</span>

<span class='co'>#Load example plot plant data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>exampleforestMED</span><span class='op'>)</span>

<span class='co'>#Default species parameterization</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>SpParamsMED</span><span class='op'>)</span>

<span class='co'>#Initialize soil with default soil params (4 layers)</span>
<span class='va'>examplesoil1</span> <span class='op'>=</span> <span class='fu'><a href='soil.html'>soil</a></span><span class='op'>(</span><span class='fu'><a href='defaultSoilParams.html'>defaultSoilParams</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#Initialize control parameters</span>
<span class='va'>control</span> <span class='op'>=</span> <span class='fu'><a href='defaultControl.html'>defaultControl</a></span><span class='op'>(</span><span class='st'>"Granier"</span><span class='op'>)</span>

<span class='co'>#Initialize input</span>
<span class='va'>x1</span> <span class='op'>=</span> <span class='fu'><a href='modelInput.html'>forest2spwbInput</a></span><span class='op'>(</span><span class='va'>exampleforestMED</span>,<span class='va'>examplesoil1</span>, <span class='va'>SpParamsMED</span>, <span class='va'>control</span><span class='op'>)</span>

<span class='co'>#Call simulation function</span>
<span class='va'>S1</span><span class='op'>&lt;-</span><span class='fu'>spwb</span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>examplemeteo</span>, latitude <span class='op'>=</span> <span class='fl'>41.82592</span>, elevation <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Initial soil water content (mm): 291.257
#&gt; Initial snowpack content (mm): 0
#&gt; Performing daily simulations 
#&gt;  Year 2001:....................................done.
#&gt; Final soil water content (mm): 256.371
#&gt; Final snowpack content (mm): 0
#&gt; Change in soil water content (mm): -34.8853
#&gt; Soil water balance result (mm): -34.8853
#&gt; Change in snowpack water content (mm): 0
#&gt; Snowpack water balance result (mm): 7.10543e-15
#&gt; Water balance components:
#&gt;   Precipitation (mm) 513
#&gt;   Rain (mm) 462 Snow (mm) 51
#&gt;   Interception (mm) 100 Net rainfall (mm) 362
#&gt;   Infiltration (mm) 404 Runoff (mm) 9 Deep drainage (mm) 63
#&gt;   Soil evaporation (mm) 42 Transpiration (mm) 333</div><div class='input'>        
<span class='co'>#Plot results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>S1</span><span class='op'>)</span>
</div><div class='img'><img src='spwb-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#Monthly summary (averages) of soil water balance</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>S1</span>, freq<span class='op'>=</span><span class='st'>"months"</span>,FUN<span class='op'>=</span><span class='va'>mean</span>, output<span class='op'>=</span><span class='st'>"Soil"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  W.1       W.2       W.3       W.4     ML.1      ML.2     ML.3
#&gt; 2001-01-01 0.9921367 0.9955031 0.9962911 1.0096580 67.72651 116.28081 75.56679
#&gt; 2001-02-01 0.9741092 0.9621231 0.9573771 0.9671237 66.49590 112.38182 72.61523
#&gt; 2001-03-01 0.9766621 0.9714358 0.9774960 0.9898773 66.67017 113.46961 74.14121
#&gt; 2001-04-01 0.9612476 0.8864243 0.9031994 0.9229925 65.61793 103.53975 68.50596
#&gt; 2001-05-01 0.9555958 0.9219791 0.8143037 0.8424257 65.23211 107.69276 61.76339
#&gt; 2001-06-01 0.8657820 0.7308001 0.6759393 0.7229637 59.10112  85.36189 51.26871
#&gt; 2001-07-01 0.9691310 0.8433758 0.5419920 0.5955562 66.15607  98.51141 41.10906
#&gt; 2001-08-01 0.9690641 0.9404298 0.4814199 0.4789003 66.15150 109.84791 36.51478
#&gt; 2001-09-01 0.9685489 0.9406782 0.5111040 0.4073284 66.11634 109.87693 38.76626
#&gt; 2001-10-01 0.9782168 0.9536550 0.5042118 0.3890373 66.77630 111.39270 38.24351
#&gt; 2001-11-01 0.9739621 0.9658558 0.7412113 0.4475465 66.48586 112.81782 56.21947
#&gt; 2001-12-01 0.9455452 0.9392216 0.9571266 0.5744668 64.54602 109.70679 72.59623
#&gt;                ML.4    MLTot      WTD        SWE PlantExt.1 PlantExt.2
#&gt; 2001-01-01 30.63226 290.2064 3965.538 1.68841612 0.04660822  0.1854550
#&gt; 2001-02-01 29.34180 280.8348 4000.000 0.28345551 0.09722321  0.3868527
#&gt; 2001-03-01 30.03213 284.3131 3981.317 0.01762496 0.10102189  0.4019679
#&gt; 2001-04-01 28.00289 265.6665 4000.000 0.59085692 0.12891520  0.5129532
#&gt; 2001-05-01 25.55856 260.2468 4000.000 0.00000000 0.15216345  0.6054591
#&gt; 2001-06-01 21.93417 217.6659 4000.000 0.00000000 0.21693420  0.8629081
#&gt; 2001-07-01 18.06872 223.8453 4000.000 0.00000000 0.18310882  0.7283455
#&gt; 2001-08-01 14.52947 227.0437 4000.000 0.00000000 0.18499488  0.7360970
#&gt; 2001-09-01 12.35803 227.1176 4000.000 0.00000000 0.14518930  0.5777103
#&gt; 2001-10-01 11.80309 228.2156 4000.000 0.00000000 0.10414468  0.4143932
#&gt; 2001-11-01 13.57822 249.1014 4000.000 2.68908129 0.07522510  0.2993220
#&gt; 2001-12-01 17.42888 264.2779 4000.000 0.00000000 0.07035782  0.2799549
#&gt;            PlantExt.3  PlantExt.4       psi.1       psi.2       psi.3
#&gt; 2001-01-01 0.08489576 0.029270793 -0.03446442 -0.03386567 -0.03370995
#&gt; 2001-02-01 0.17708961 0.061057868 -0.03796562 -0.04106949 -0.04194234
#&gt; 2001-03-01 0.18400894 0.063443541 -0.03716405 -0.03847551 -0.03709361
#&gt; 2001-04-01 0.23481502 0.080960844 -0.04051250 -0.06227047 -0.05698878
#&gt; 2001-05-01 0.27715233 0.095559600 -0.04246876 -0.05231190 -0.09824980
#&gt; 2001-06-01 0.39481875 0.136206421 -0.06996205 -0.19033007 -0.26823108
#&gt; 2001-07-01 0.32767319 0.114450706 -0.03887843 -0.12899645 -0.78934493
#&gt; 2001-08-01 0.29720891 0.102537889 -0.03874136 -0.04615430 -1.50170950
#&gt; 2001-09-01 0.25516526 0.035609522 -0.03903827 -0.04542449 -1.05653901
#&gt; 2001-10-01 0.16593264 0.009463676 -0.03709369 -0.04252188 -1.35302901
#&gt; 2001-11-01 0.13654069 0.018798526 -0.03789180 -0.03963687 -0.33322225
#&gt; 2001-12-01 0.12815512 0.043939186 -0.04428318 -0.04627132 -0.04172962
#&gt;                  psi.4
#&gt; 2001-01-01 -0.03161895
#&gt; 2001-02-01 -0.03970960
#&gt; 2001-03-01 -0.03503128
#&gt; 2001-04-01 -0.05077726
#&gt; 2001-05-01 -0.08176111
#&gt; 2001-06-01 -0.18472529
#&gt; 2001-07-01 -0.49509304
#&gt; 2001-08-01 -1.51599527
#&gt; 2001-09-01 -3.21431635
#&gt; 2001-10-01 -3.98141314
#&gt; 2001-11-01 -3.00952007
#&gt; 2001-12-01 -0.55997133</div><div class='input'>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>examplesoil2</span> <span class='op'>=</span> <span class='fu'><a href='soil.html'>soil</a></span><span class='op'>(</span><span class='fu'><a href='defaultSoilParams.html'>defaultSoilParams</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#Switch to 'Sperry' transpiration mode</span>
<span class='va'>control</span> <span class='op'>=</span> <span class='fu'><a href='defaultControl.html'>defaultControl</a></span><span class='op'>(</span><span class='st'>"Sperry"</span><span class='op'>)</span>

<span class='co'>#Initialize input</span>
<span class='va'>x2</span> <span class='op'>=</span> <span class='fu'><a href='modelInput.html'>forest2spwbInput</a></span><span class='op'>(</span><span class='va'>exampleforestMED</span>,<span class='va'>examplesoil2</span>, <span class='va'>SpParamsMED</span>, <span class='va'>control</span><span class='op'>)</span>

<span class='co'>#Call simulation function (11 days)</span>
<span class='va'>d</span> <span class='op'>=</span> <span class='fl'>100</span><span class='op'>:</span><span class='fl'>110</span>
<span class='va'>S2</span><span class='op'>&lt;-</span><span class='fu'>spwb</span><span class='op'>(</span><span class='va'>x2</span>, <span class='va'>examplemeteo</span><span class='op'>[</span><span class='va'>d</span>,<span class='op'>]</span>, latitude <span class='op'>=</span> <span class='fl'>41.82592</span>, elevation <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='co'># Run the model with 'Sperry' transpiration mode using the water balance of </span>
<span class='co'># simulated with the 'Granier' model</span>
<span class='va'>WS</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>S1</span><span class='op'>$</span><span class='va'>Soil</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"W.1"</span>, <span class='st'>"W.2"</span>, <span class='st'>"W.3"</span>, <span class='st'>"W.4"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>P2</span><span class='op'>&lt;-</span><span class='fu'>pwb</span><span class='op'>(</span><span class='va'>x2</span>, <span class='va'>examplemeteo</span><span class='op'>[</span><span class='va'>d</span>,<span class='op'>]</span>, latitude <span class='op'>=</span> <span class='fl'>41.82592</span>, elevation <span class='op'>=</span> <span class='fl'>100</span>, 
        W <span class='op'>=</span> <span class='va'>WS</span><span class='op'>[</span><span class='va'>d</span>,<span class='op'>]</span>,
        canopyEvaporation <span class='op'>=</span> <span class='va'>S1</span><span class='op'>$</span><span class='va'>WaterBalance</span><span class='op'>$</span><span class='va'>Interception</span><span class='op'>[</span><span class='va'>d</span><span class='op'>]</span>,
        snowMelt <span class='op'>=</span> <span class='va'>S1</span><span class='op'>$</span><span class='va'>WaterBalance</span><span class='op'>$</span><span class='va'>Snowmelt</span><span class='op'>[</span><span class='va'>d</span><span class='op'>]</span>,
        soilEvaporation <span class='op'>=</span> <span class='va'>S1</span><span class='op'>$</span><span class='va'>WaterBalance</span><span class='op'>$</span><span class='va'>SoilEvaporation</span><span class='op'>[</span><span class='va'>d</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Miquel De Cáceres, Shengli Huang, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


